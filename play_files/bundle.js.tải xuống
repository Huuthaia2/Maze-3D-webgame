!function(){"use strict";var e={money:500,outlineTime:0,onlineTime:0,outlineRewardLevel:1,level:0,curBallType:0,lvStars:[],unlocked:[1,0,0,0,0,0,0,0,0],totalScore:0,rankInfo:[]},a={G_STATE_MENU:0,G_STATE_SHOP:1,G_STATE_PAUSE:2,G_STATE_ITEM_PUSH:3,G_STATE_RUNNING:4,G_STATE_WIN:5,G_STATE_LOSE:6,G_STATE_RANK:8,G_STATE_LOADING:9,G_STATE_SHARE:10,G_STATE_READY:11,G_STATE_SETTING:12,gstate:-1,ballDefScore:1,ballCountMax:300,unlockNeedMoney:500,itemCfg:{},multiCfg:["d627cc","6927d6","ce9e29","a5ca24","6fbc1d","2db868","22a96e","227ba9","1A30BF","1A72BF"],lvCfg:[{ballNum:10,score:60,shape:"cccs",name:"1",stars:[60,80,110,100],rewardMoney:50},{ballNum:10,score:40,shape:"cccs",name:"2",stars:[40,50,60,50],rewardMoney:50},{ballNum:5,score:120,shape:"cccs",name:"3",stars:[120,180,240,230],rewardMoney:50},{ballNum:5,score:180,shape:"cccs",name:"4",stars:[180,240,315,305],rewardMoney:50},{ballNum:5,score:660,shape:"cccs",name:"5",stars:[660,700,900,890],rewardMoney:50},{ballNum:5,score:420,shape:"cccs",name:"6",stars:[420,880,1240,1230],rewardMoney:50},{ballNum:5,score:330,shape:"cccs",name:"7",stars:[330,550,720,710],rewardMoney:50},{ballNum:5,score:600,shape:"cccs",name:"8",stars:[600,800,960,950],rewardMoney:50},{ballNum:5,score:500,shape:"cccs",name:"9",stars:[500,900,1e3,990],rewardMoney:50},{ballNum:5,score:600,shape:"cccs",name:"10",stars:[600,900,2400,2390],rewardMoney:50},{ballNum:5,score:600,shape:"drops",name:"11",stars:[600,700,800,790],rewardMoney:50},{ballNum:5,score:800,shape:"squares",name:"12",stars:[800,900,1e3,990],rewardMoney:50},{ballNum:5,score:360,shape:"squares",name:"13",stars:[360,600,800,790],rewardMoney:50},{ballNum:5,score:540,shape:"squares",name:"14",stars:[540,700,800,790],rewardMoney:50},{ballNum:5,score:900,shape:"squares",name:"15",stars:[900,1080,3e3,2990],rewardMoney:50},{ballNum:5,score:600,shape:"squares",name:"16",stars:[600,840,1200,1190],rewardMoney:50},{ballNum:5,score:500,shape:"trangles",name:"17",stars:[500,700,900,890],rewardMoney:50},{ballNum:5,score:360,shape:"trangles",name:"18",stars:[360,800,1200,1190],rewardMoney:50},{ballNum:5,score:380,shape:"trangles",name:"19",stars:[380,550,700,690],rewardMoney:50},{ballNum:5,score:1400,shape:"trangles",name:"20",stars:[1400,2e3,1e4,9990],rewardMoney:50},{ballNum:5,score:500,shape:"trangles",name:"21",stars:[500,800,1200,1190],rewardMoney:50},{ballNum:5,score:800,shape:"drops",name:"22",stars:[800,1e3,1200,1190],rewardMoney:50},{ballNum:5,score:1600,shape:"cccs",name:"23",stars:[1600,2300,1e4,9990],rewardMoney:50},{ballNum:5,score:500,shape:"cccs",name:"24",stars:[500,800,1100,1090],rewardMoney:50},{ballNum:5,score:300,shape:"cccs",name:"25",stars:[300,500,900,890],rewardMoney:50},{ballNum:5,score:750,shape:"cccs",name:"26",stars:[750,1400,5e3,4990],rewardMoney:50},{ballNum:5,score:1500,shape:"cccs",name:"27",stars:[1500,1750,2e3,1990],rewardMoney:50},{ballNum:5,score:950,shape:"squares",name:"28",stars:[950,2e3,3e3,2990],rewardMoney:50},{ballNum:5,score:800,shape:"squares",name:"29",stars:[800,2e3,5e3,4990],rewardMoney:50},{ballNum:5,score:660,shape:"squares",name:"30",stars:[660,3e3,6600,6590],rewardMoney:50},{ballNum:5,score:1400,shape:"squares",name:"31",stars:[1400,1800,2e3,1990],rewardMoney:50},{ballNum:5,score:450,shape:"squares",name:"32",stars:[450,600,750,740],rewardMoney:50},{ballNum:5,score:800,shape:"drops",name:"33",stars:[800,1300,1800,1790],rewardMoney:50}],botNames:[],init:function(){this.loadData(),e.onlineTime=Date.now(),e.outlineTime||(e.outlineTime=e.onlineTime),this.saveData()},getOutlineRewardLvupMoney:function(t){void 0===t&&(t=e.outlineRewardLevel);let a=100+30*Math.pow(2,t);return Number(a.toFixed(0))},getTotalOutlineHour:function(){return(e.onlineTime-e.outlineTime)/1e3/60/60},getOutlineRewardMoney:function(){let t=(e.onlineTime-e.outlineTime)/1e3/60/60*this.getOutlineRewardPerHour();return Number(t.toFixed(0))},getOutlineRewardPerHour:function(){let t=10*e.outlineRewardLevel;return Number(t.toFixed(0))},playMusic:function(e,t=0,a=null,i=0){return Laya.SoundManager.playMusic(e,t,a,i)},playSound:function(e,t=1,a=null,i=0){return Laya.SoundManager.playSound(e,t,a,null,i)},stopSound:function(e){return Laya.SoundManager.stopSound(e)},localStorageName:"ShotFactorLocalData",loadData:function(){let t=Laya.LocalStorage.getJSON(this.localStorageName);for(let a in t)e[a]=t[a];let a=this;for(let t in a.bjProperties)0==a.bjProperties[t].unlockType&&e.unlocked.indexOf(t)<0&&e.unlocked.push(t)},saveData:function(){Laya.LocalStorage.setJSON(this.localStorageName,e)}};class i extends Laya.Script3D{constructor(){super()}onDestroy(){super.onDestroy(),Laya.stage.off(Laya.Event.MOUSE_DOWN,this,this.onMouseDown),Laya.stage.off(Laya.Event.MOUSE_UP,this,this.onMouseUp)}onAwake(){Laya.stage.on(Laya.Event.MOUSE_DOWN,this,this.onMouseDown),Laya.stage.on(Laya.Event.MOUSE_UP,this,this.onMouseUp),this.mcamera||(this.mcamera=this.owner.getChildByName("Main Camera"),this.mcamera.enableHDR=!1,"iOS"!=lplatform.channel&&"Android"!=lplatform.channel&&"web"!=lplatform.channel||this.setBloom(),this.setSkyBox())}setBloom(){var e=new Laya.PostProcess,t=new Laya.BloomEffect;e.addEffect(t),this.mcamera.postProcess=e,t.intensity=5,t.threshold=.9,t.softKnee=.5,t.clamp=65472,t.diffusion=5,t.anamorphicRatio=0,t.color=new Laya.Color(236/255,179/255,235/255,1),t.fastMode=!0}setFog(){this.owner.enableFog=!0,this.owner.fogColor=new Laya.Vector3(1.5,1.5,1.5),this.owner.fogStart=3,this.owner.fogRange=300}setSkyBox(){}onEnable(){}onDisable(){}loadLevel(e){this.clearLevel()}clearLevel(){}setGState(e){a.gstate=e}onMouseClick(e){}onMouseDrag(e){}onMouseDown(e){a.gstate==a.G_STATE_RUNNING&&(this.touchDowning=!0,this.touchDownX=Laya.stage.mouseX,this.touchDownY=Laya.stage.mouseY)}onMouseUp(e){a.gstate==a.G_STATE_RUNNING&&(this.touchDowning=!1)}onMouseOut(e){}onUpdate(){Laya.timer.delta}onLateUpdate(){this.lupdate()}_update3D(){}lupdate(){}}var o={llabHost:"https://www.bwyxa.com/web/lab/games/",locationUrl:"https://whois.pconline.com.cn/ipJson.jsp?json=true&qq-pf-to=pcqq.c2c",tdappid:"09CC7809F76E43F792CF421D91D2E1A1",llabName:"KuaiLeShuiBei3",appName:"快乐水杯3",onlineCompanyName:"石家庄通玩信息科技有限公司",softCompanyName:"石家庄布丸网络科技有限公司",softRegisterNumber:"2022SRE019224",web:{showLog:!0},wx:{llabVer:"100",bannerID:"",interstitialID:"",rewardedVideoID:"",nativeID:"",useNativeAd:!1,showLog:!0,bannerOnBottom:!0,gameClubLeft:.85,gameClubTop:.12,shareRecordBtnHeight:50,shareRecordBtnLeft:.5,shareRecordBtnTop:.695,shareAppTitle:"",showVideoShareBtn:!1,moreGameBannerAppId:["wx5ef5327220364198"],moreGameBannerPercent:0,moreGamePortalAppId:["wx5ef5327220364198"],moreGamePortalPercent:0,canShareReward:!1,needPushPrivacy:!1},qq:{llabVer:"100",bannerID:"12dc88b84c7c9392372d89af98d8e6cd",interstitialID:"526c745e7ec0ddf438cfe404e20e56a7",rewardedVideoID:"1131fef4e64ea2eab3aaa605e76781ba",nativeID:"",useNativeAd:!1,showLog:!0,bannerOnBottom:!0,gameClubLeft:.85,gameClubTop:.12,shareRecordBtnHeight:50,shareRecordBtnLeft:.5,shareRecordBtnTop:.695,shareAppTitle:"",showVideoShareBtn:!1,moreGameBannerAppId:["99ea3ba1845ccee4ae526c81d51a033a"],moreGameBannerPercent:0,moreGamePortalAppId:["d3fdcb0b616b41bdb48f990c836c0996"],moreGamePortalPercent:0,shareAppImgUrl:"",mmgPos:[{x:.85,y:.1}],mmgSize:[2],mmgOrientation:["vertical"],mmgId:[""],tmplIds:[""],canShareReward:!0,needPushPrivacy:!1},tt:{llabVer:"101",bannerID:"2a4ko0mgnnko30ji2m",interstitialID:"7vricebs568bb65j85",rewardedVideoID:"he0g4f2b4e4c117fd6",shareID:"",videoTopics:[""],useNativeAd:!1,showLog:!0,bannerHeight:70,bannerOnBottom:!0,followBtnLeft:0,followBtnTop:.15,moreGameLeft:0,moreGameTop:.23,moreGameBannerAppId:["tt6e7518c8f14c4d4902"],moreGameBannerAutoCloseTime:0,moreGameBannerPercent:0,moreGamePortalPercent:0,canShareReward:!0,needPushPrivacy:!1},oppo:{llabVer:"100",bannerID:"820450",interstitialID:"",rewardedVideoID:"820454",nativeID:["820452"],nativeTemplateID:"820453",spreadBoxID:["820464"],moreGameBannerId:"820465",useNativeAd:!0,showLog:!0,bannerWidth:1080,bannerHeight:300,nativeInterstitialLeft:0,nativeInterstitialTop:0,nativeInterstitialWidth:600,nativeInterstitialHeight:200,bannerOnBottom:!0,canRecord:!1,closeBtnScale:1,moreGameBannerPercent:0,moreGamePortalPercent:0,canShareReward:!1,moreGameBannerWidth:720,moreGameBannerHeight:260},vivo:{llabVer:"100",bannerID:"f2545e73df1d42f5b7873abe2f2793bd",interstitialID:"3652af1c7bfa4ddeacfe20af7d09266e",rewardedVideoID:"c6e27df1115e49249abe4d44c95d912a",nativeID:["601f40707e5543cea58b3dd4b1e0ed48"],spreadBoxID:["d269323b14e645bdb512602c077288d5"],moreGameBannerId:"f735ac8b04c14b6584fa7d42b5dd63d6",showLog:!0,bannerWidth:1080,bannerHeight:0,bannerOnBottom:!0,canRecord:!1,closeBtnScale:1,moreGameBannerPercent:0,moreGamePortalPercent:0,moreGameBannerWidth:720,moreGameBannerHeight:0,moreGamePortalIconUrl:null,moreGamePortalMarginTop:200,needPushPrivacy:!0},huawei:{llabVer:"100",bannerID:"j1pcnpx5tu",interstitialID:"testb4znbuh3n2",rewardedVideoID:"u2k89ub7vq",nativeID:["u7m3hc4gvm"],spreadBoxID:[""],shareAppTitle:"脑洞老司机发车了",shareAppImgUrl:"https://cdn.bwyxa.com/shareImg/qq/NaoDongLaoSiJi2/qqShare.jpg",useNativeAd:!0,showLog:!0,bannerOnBottom:!0,closeBtnScale:1,moreGameBannerPercent:0,moreGamePortalPercent:0,bannerWidth:360,bannerHeight:57,nativeInterstitialWidth:600,nativeInterstitialHeight:372,canRecord:!1,moreGameBannerPercent:0,moreGamePortalPercent:0,canShareReward:!0,needPushPrivacy:!0},baidu:{llabVer:"100",bannerOnBottom:!0,appSid:"b8553a99",bannerID:"7586383",interstitialID:"",rewardedVideoID:"7586384",moreGameLeft:.85,moreGameTop:.12,bannerHeight:100,shareAppImgUrl:"https://cdn.bwyxa.com/shareImg/qq/NaoDongLaoSiJi2/qqShare.jpg",showLog:!0,canRecord:!1,moreGameBannerPercent:0,moreGamePortalPercent:0,navigateToId:["WP08D3oQRkDHAGlycfiejknIAQA1uopf"],canShareReward:!0,needPushPrivacy:!0},native:{llabVer:"102",bannerOnBottom:!0,showLog:!0,moreGameBannerPercent:0,moreGamePortalPercent:0,canShareReward:!1},gb4399:{llabVer:"100",bannerID:"noNeed",interstitialID:"noNeed",rewardedVideoID:"noNeed",nativeID:"noNeed",useNativeAd:!1,showLog:!0,bannerOnBottom:!0,gameClubLeft:0,gameClubTop:.23,shareRecordBtnHeight:50,shareRecordBtnLeft:.5,shareRecordBtnTop:.695,shareAppTitle:"脑洞老司机发车了",showVideoShareBtn:!1,moreGameBannerAppId:["noNeed"],moreGameBannerPercent:0,moreGamePortalAppId:["noNeed"],moreGamePortalPercent:0,canShareReward:!1,needPushPrivacy:!0},h54399:{llabVer:"noNeed",bannerID:"noNeed",interstitialID:"noNeed",rewardedVideoID:"noNeed",nativeID:"noNeed",useNativeAd:!1,showLog:!0,bannerOnBottom:!0,gameClubLeft:0,gameClubTop:.23,shareRecordBtnHeight:50,shareRecordBtnLeft:.5,shareRecordBtnTop:.695,shareAppTitle:"脑洞老司机发车了",showVideoShareBtn:!1,moreGameBannerAppId:["noNeed"],moreGameBannerPercent:0,moreGamePortalAppId:["noNeed"],moreGamePortalPercent:0,canShareReward:!1,needPushPrivacy:!0},ks:{llabVer:"100",bannerID:"",interstitialID:"2300002190_02",rewardedVideoID:"2300002190_01",shareID:"",videoTopics:[""],useNativeAd:!1,showLog:!0,bannerHeight:70,bannerOnBottom:!0,followBtnLeft:0,followBtnTop:.15,moreGameLeft:-1,moreGameTop:.23,moreGameBannerAppId:[""],moreGameBannerAutoCloseTime:0,moreGameBannerPercent:0,moreGamePortalPercent:0,canShareReward:!0,needPushPrivacy:!1},uc:{llabVer:"100",bannerID:"noNeed",interstitialID:"noNeed",rewardedVideoID:"noNeed",nativeID:"noNeed",showLog:!0,bannerWidth:1080,bannerHeight:200,needPushPrivacy:!0},loadLLabTryCount:3,randVideoLoopCountMax:0,randVideoLoopCount:0,bannerWidth:640,defBannerMoveDelay:1200,defInterstitialDelay:1200,usrClickDelay:1200,autoShareOnLttrStop:!1,autoStartOnLttrClose:!1,followBtnLeft:0,followBtnTop:0,showRecordBtn:!1,uiGroupIndex:1,uiGroup:"default"};class n{constructor(){}init(){}initAD(){}release(){}loadBanner(e){}showBanner(){}hideBanner(){}loadInterstitial(e){}showInterstitial(){}hideInterstitial(){}createRewardedVideo(e){}loadRewardedVideo(e){}showRewardedVideo(e){e&&e(!0)}hideRewardedVideo(){}shareAppMessage(e){}canRecord(){return!1}canShareRecord(){return!1}startRecord(e){}pauseRecord(){}stopRecord(e){}shareRecord(e,t){}resetRecord(){}shareInnerRecord(e,t){}createMoreGameButton(){}createMoreGameBanner(){}createMoreGamePortal(){}goToGameOrGameList(e){}showFavoriteGuide(){}followAccount(){}openAwemeUserProfile(){}analytics(e,t){}showLoading(e){this.hideLoading()}hideLoading(){}createGameClub(){}navigateToMiniProgram(e){}shareMessageToFriend(e){}sendMsgToOpenDataProject(e){}makeShareUI(e,t,a,i=0,o=!1){e&&e()}}class r extends n{constructor(){super(),this.bannerAd=null,this.insterstitialAd=null,this.rewardedVideoAd=null,this.gameRecorderManager=null,this.info=null,this.bw=0,this.bh=0,this.btop=0,this.videoPath=null,this.gameRecordStartTime=0,this.gameRecordStopTime=0,this.recordStartCb=null,this.recordStopCb=null,this.rewardedVideoTimeMax=5e3,this.rewardedVideoLoadTimeout=null,this.rewardedVideoIsLoaded=!1,this.moreGameBanner=null,this.moreGameBtn=null,this.followBtn=null,this.env=null,this.init()}init(){this.env=tt,this.info=window.lplatform&&lplatform.systemInfo||this.env.getSystemInfoSync(),this.bh=lplatform.cparam.bannerHeight||170,this.bw=lplatform.cparam.bannerWidth||Math.min(this.info.windowWidth,16*this.bh/9),this.gameRecorderManager=this.env.getGameRecorderManager()}initAD(){this.loadBanner(!1),this.loadInterstitial(!1),this.createRewardedVideo(!1)}checkOpenSceneValue(){let e=!0;if("function"==typeof this.env.getLaunchOptionsSync){let t=this.env.getLaunchOptionsSync().scene;console.log("sceneValue:"+t),this.recordSceneValue(t),(!lplatform.labData.openSceneValues||lplatform.labData.openSceneValues.indexOf(t)<0)&&(e=!1)}return e}release(){this.hideBanner(!0),this.hideInterstitial(),this.hideRewardedVideo(),this.hideLoading(),this.moreGameBanner&&this.moreGameBanner.destroy(),this.followBtn&&this.followBtn.destroy()}loadBanner(e){this.hideBanner(!1),this.btop=0,lplatform.cparam.bannerOnBottom&&(this.btop=this.info.windowHeight-this.bh),lplatform.plog("loadBanner this.bh:"+this.bh+" this.btop:"+this.btop+" this.bw:"+this.bw),this.bannerAd=this.env.createBannerAd({adUnitId:lplatform.cparam.bannerID,adIntervals:30,style:{width:this.bw,left:(this.info.windowWidth-this.bw)/2,top:this.btop}}),this.bannerAd.onLoad(this.onBannerLoad.bind(this)),this.bannerAd.onError(this.onBannerError.bind(this)),this.bannerAd.onResize(this.onBannerResize.bind(this)),this.bannerAutoShow=e,this.bannerAutoShow&&this.bannerAd.show()}onBannerLoad(){}onBannerError(e,t){lplatform.plog("onBannerError code:"+JSON.stringify(e)+" msg:"+t)}onBannerResize(e){this.btop=0,lplatform.cparam.bannerOnBottom&&(this.btop=this.info.windowHeight-e.height),this.bannerAd.style.top=this.btop,this.bannerAd.style.left=(this.info.windowWidth-e.width)/2,lplatform.plog("onBannerResize this.bannerAd.style.top:"+this.bannerAd.style.top+" .left:"+this.bannerAd.style.left+" lplatform.cparam.bannerOnBottom:"+lplatform.cparam.bannerOnBottom)}showBanner(){this.bannerAd?this.bannerAd.show().then(()=>{}).catch(e=>{lplatform.plog(e)}):this.loadBanner(!0)}hideBanner(e=!1){this.bannerAd&&(this.bannerAd.hide(),e&&(this.bannerAd.offLoad(this.onBannerLoad),this.bannerAd.offError(this.onBannerError),this.bannerAd.offResize(this.onBannerResize),this.bannerAd.destroy(),this.bannerAd=null)),this.moreGameBanner&&(this.moreGameBanner.hide(),e&&"function"==typeof this.moreGameBanner.destroy&&this.moreGameBanner.destroy())}showCenterBanner(){if(!this.centerBanner){this.btop=0,lplatform.cparam.bannerOnBottom&&(this.btop=this.info.windowHeight-this.bh),this.centerBanner=this.env.createBannerAd({adUnitId:lplatform.cparam.bannerID,adIntervals:30,style:{width:this.bw,height:this.bh,left:0,top:this.btop}});let e=this;this.centerBanner.onLoad(()=>{}),this.centerBanner.onError((e,t)=>{lplatform.plog("centerBanner code:"+JSON.stringify(e)+" msg:"+t)}),this.centerBanner.onResize(t=>{e.centerBanner.style.left=0,e.centerBanner.style.top=e.info.windowHeight-t.height})}this.centerBanner.show()}hideCenterBanner(e=!1){this.centerBanner&&(this.centerBanner.hide(),e&&(this.centerBanner.offLoad(()=>{}),this.centerBanner.offError(()=>{}),this.centerBanner.offResize(()=>{}),this.centerBanner.destroy(),this.centerBanner=null))}loadInterstitial(e){this.hideInterstitial(),this.insterstitialAd=this.env.createInterstitialAd({adUnitId:lplatform.cparam.interstitialID}),this.insterstitialAd.onLoad(this.onInterstitialLoad.bind(this)),this.insterstitialAd.onError(this.onInterstitialError.bind(this)),this.insterstitialAd.onClose(this.onInterstitialClose.bind(this)),this.insterstitialAd.load(),e&&this.showInterstitial()}onInterstitialLoad(){}onInterstitialError(e,t){lplatform.plog("onInterstitialError code:"+e+" msg:"+t)}onInterstitialClose(){this.loadInterstitial(!1)}showInterstitial(){this.insterstitialAd?this.insterstitialAd.show():this.loadInterstitial(!0)}hideInterstitial(){this.insterstitialAd&&(this.insterstitialAd.offLoad(this.onInterstitialLoad),this.insterstitialAd.offError(this.onInterstitialError),this.insterstitialAd.offClose(this.onInterstitialClose),this.insterstitialAd.destroy())}createRewardedVideo(e){lplatform.cparam.rewardedVideoID&&(this.rewardedVideoAd||"function"!=typeof this.env.createRewardedVideoAd||(this.rewardedVideoAd=this.env.createRewardedVideoAd({adUnitId:lplatform.cparam.rewardedVideoID}),this.rewardedVideoAd.onError(this.onRewardedVideoError.bind(this)),this.rewardedVideoAd.onClose(this.onRewardedVideoClose.bind(this)),this.rewardedVideoAd.onLoad(this.onRewardedVideoLoad.bind(this))),e&&this.showRewardedVideo(window.vcb))}loadRewardedVideo(e){this.createRewardedVideo(e),lplatform.plog("loadRewardedVideo this.rewardedVideoAd.load()"),this.rewardedVideoAd.load()}onRewardedVideoLoad(){lplatform.plog("onRewardedVideoLoad this.rewardedVideoIAutoShow:"+this.rewardedVideoIAutoShow)}onRewardedVideoError(e,t){lplatform.plog("onRewardedVideoError code:"+JSON.stringify(e)+" msg:"+t),this.resetRewardedVideo()}onRewardedVideoClose(e){if(lplatform.plog("onRewardedVideoClose res.isEnded:"+e.isEnded),e.isEnded)window.vcb&&window.vcb(e.isEnded),this.resetRewardedVideo(!1,!0),this.loadRewardedVideo(!1);else if(lplatform.labData.openSecondTipVideo){let e=this;e.env.showModal({title:"继续吗",content:"观看完视频才能获得奖励哦",success(t){t.confirm?e.showRewardedVideo(window.vcb):t.cancel&&(window.vcb&&window.vcb(t.isEnded),this.resetRewardedVideo(!1,!0),this.loadRewardedVideo(!1))}})}else window.vcb&&window.vcb(e.isEnded)}showRewardedVideo(e){let t=this;e&&(window.vcb=e),this.rewardedVideoAd?(this.showLoading(),this.rewardedVideoLoadTimeout=setTimeout(function(){lplatform.plog("rewardedVideoLoadTimeout 广告超时 timeMax:"+this.rewardedVideoTimeMax),clearTimeout(this.rewardedVideoLoadTimeout),window.vcb&&window.vcb(!1,"广告超时"),this.resetRewardedVideo(!0,!0)}.bind(this),this.rewardedVideoTimeMax),lplatform.plog("showRewardedVideo this.rewardedVideoIsLoaded:"+this.rewardedVideoIsLoaded),this.rewardedVideoAd.show().then(()=>{lplatform.plog("showRewardedVideo then "),t.hideLoading(),clearTimeout(t.rewardedVideoLoadTimeout)}).catch(e=>{lplatform.plog("showRewardedVideo catch:"+JSON.stringify(e)),t.hideLoading(),clearTimeout(t.rewardedVideoLoadTimeout),t.rewardedVideoAd.load().then(()=>{t.rewardedVideoAd.show()}).catch(()=>{t.loadRewardedVideo(!1)})})):this.createRewardedVideo(!0)}resetRewardedVideo(e=!1,t=!1){this.rewardedVideoAd&&e&&(this.rewardedVideoAd.offLoad(this.onRewardedVideoLoad),this.rewardedVideoAd.offError(this.onRewardedVideoError),this.rewardedVideoAd.offClose(this.onRewardedVideoClose),this.rewardedVideoAd.destroy(),this.rewardedVideoAd=null),t&&(window.vcb=null),this.rewardedVideoLoadTimeout&&clearTimeout(this.rewardedVideoLoadTimeout),this.hideLoading()}shareAppMessage(){this.env.shareAppMessage({templateId:lplatform.cparam.shareID,query:"",success(){},fail(e){lplatform.plog("分享失败:"+e)}})}canRecord(){return!!this.gameRecorderManager}canShareRecord(){return!!this.videoPath}startRecord(e){lplatform.plog("startRecord"),this.recordStartCb=e,this.videoPath=null,this.gameRecorderManager.start({duration:30}),this.gameRecorderManager.onStart(this.onGameRecordStart.bind(this)),this.gameRecorderManager.onError(this.onGameRecordError.bind(this)),this.gameRecorderManager.onStop(this.onGameRecordStop.bind(this));let t=this;this.env.onShow(e=>{lplatform.plog("startRecord this.env.onShow"),t.resumeRecord()}),this.env.onHide(()=>{lplatform.plog("startRecord this.env.onHide"),t.pauseRecord()})}onGameRecordStart(){this.gameRecordStartTime=Date.now(),this.recordStartCb&&(this.recordStartCb(),this.recordStartCb=null)}onGameRecordError(e){lplatform.plog("onGameRecordError:"+e,"error")}onGameRecordStop(e){lplatform.plog("onGameRecordStop this.recordStopCb:"+this.recordStopCb),this.gameRecordStopTime=Date.now(),this.gameRecordStopTime-this.gameRecordStartTime>4500?this.videoPath=e.videoPath:(lplatform.plog("onGameRecordStop 实际录屏时间少于5秒就有可能分享失败"),this.env.showToast({title:"录制时间太短，可能无法分享。",icon:"none",duration:1e3,mask:!1,success(e){},fail(e){lplatform.plog(e)}})),this.recordStopCb&&(this.recordStopCb(this.videoPath),this.recordStopCb=null)}pauseRecord(){this.gameRecorderManager.pause()}resumeRecord(){this.gameRecorderManager.resume()}stopRecord(e){lplatform.plog("stopRecord cb:"+e),this.recordStopCb=e,this.gameRecorderManager.stop()}shareRecord(e,t){if(this.videoPath){let a=this;this.env.shareAppMessage({channel:"video",extra:{videoPath:this.videoPath,videoTopics:lplatform.cparam.videoTopics,hashtag_list:lplatform.cparam.videoTopics,createChallenge:!0},success(){e&&e()},fail(e){let i=null,o=JSON.stringify(e);o.indexOf("cancel")>=0?i="您取消了本次分享":o.indexOf("21105")>=0&&(i="视频太短，无法进行分享"),i&&a.env.showToast({title:i,icon:"none",duration:1e3,mask:!1,success(e){},fail(e){lplatform.plog(e)}}),t&&t()}})}else this.env.showToast({title:"暂无可分享的视频",icon:"none",duration:1e3,mask:!1,success(e){},fail(e){lplatform.plog(e)}}),t&&t()}resetRecord(){this.stopRecord(),this.videoPath=null}shareInnerRecord(e,t){}createMoreGameButton(){this.moreGameBtn=this.env.createMoreGamesButton({type:"image",image:"moreGame.png",actionType:"box",style:{left:lplatform.cparam.moreGameLeft*lplatform.systemInfo.windowWidth,top:lplatform.cparam.moreGameTop*lplatform.systemInfo.windowHeight,width:49.5,height:39.9,lineHeight:1,backgroundColor:"#00000000",textColor:"#ffffff",textAlign:"center",fontSize:16,borderRadius:1,borderWidth:0,borderColor:"#ff0000"},appLaunchOptions:[],onNavigateToMiniGame(e){lplatform.plog("跳转其他小游戏",e)}}),this.moreGameBtn.onTap(()=>{lplatform.plog("点击更多游戏")})}showFavoriteGuide(){this.env.showFavoriteGuide({type:"bar",content:"一键加关注，从此不迷路!",position:"bottom",success(e){},fail(e){lplatform.plog("showFavoriteGuide fail:"+e)}})}followAccount(){if("function"==typeof this.env.checkFollowState){let e=this;e.env.checkFollowState({success(t){t.errMsg&&lplatform.plog("checkFollowState success, but has errMsg:"+t.errMsg),t.result||e.env.createFollowButton&&(e.followBtn=e.env.createFollowButton({type:"image",image:"follow_btn.png",style:{left:lplatform.cparam.followBtnLeft*lplatform.systemInfo.windowWidth,top:lplatform.cparam.followBtnTop*lplatform.systemInfo.windowHeight,width:49.5,height:39.9,lineHeight:40,backgroundColor:"#ff0000",textColor:"#ffffff",textAlign:"center",fontSize:16,borderRadius:4,borderWidth:1,borderColor:"#ff0000"}}))},fail(e){lplatform.plog("followAccount fail:"+e)}})}else"function"==typeof this.env.openAwemeUserProfile&&this.env.openAwemeUserProfile()}goToGameOrGameList(e){this.env.showMoreGamesModal({appLaunchOptions:[],success(e){console.log("success",e.errMsg)},fail(e){console.log("fail",e.errMsg)}})}openAwemeUserProfile(){}createMoreGameBanner(){if(lplatform.cparam.moreGameBannerAppId){let e=Math.floor(Math.random()*lplatform.cparam.moreGameBannerAppId.length),t=lplatform.cparam.moreGameBannerAppId[e];if(!this.moreGameBanner){let e=300,a=104;this.btop=0,lplatform.cparam.bannerOnBottom&&(this.btop=this.info.windowHeight-a),this.moreGameBanner=this.env.createMoreGamesBanner({style:{width:e,height:a,left:0,top:this.btop},appLaunchOptions:[{appId:t,query:"foo=bar&baz=qux",extraData:{}}]});let i=(e,t)=>{lplatform.plog("监听事件:"+JSON.stringify(e)+" "+JSON.stringify(t))};this.moreGameBanner.onResize(function(t){this.moreGameBanner.style.top=this.info.windowHeight-a,this.moreGameBanner.style.left=(this.info.windowWidth-e)/2,lplatform.plog("moreGameBanner size.width:"+t.width+" size.height:"+t.height+" lplatform.cparam.bannerOnBottom:"+lplatform.cparam.bannerOnBottom)}.bind(this)),this.moreGameBanner.onTap(i),this.moreGameBanner.onError(i)}this.moreGameBanner.show(),lplatform.cparam.moreGameBannerAutoCloseTime>0&&setTimeout(function(){this.moreGameBanner.hide()}.bind(this),lplatform.cparam.moreGameBannerAutoCloseTime)}}createMoreGamePortal(){"ios"!==this.info.platform?tt.showMoreGamesModal({appLaunchOptions:[{appId:"ttXXXXXX",query:"foo=bar&baz=qux",extraData:{}}],success(e){console.log("success",e.errMsg)},fail(e){console.log("fail",e.errMsg)}}):tt.showToast({title:" iOS不支持此功能"})}analytics(e,t){"function"==typeof this.env.reportAnalytics&&this.env.reportAnalytics(e,t)}showLoading(e){this.hideLoading(),"function"==typeof this.env.showLoading&&this.env.showLoading({title:e||"处理中，请稍候...",success(e){},fail(e){lplatform.plog("showLoading调用失败:"+e)}})}hideLoading(){let e=this;"function"==typeof this.env.hideLoading&&this.env.hideLoading({success(e){},fail(t){lplatform.plog("hideLoading调用失败:"+t),setTimeout(function(){e.env.hideLoading({success(e){},fail(e){lplatform.plog("hideLoading二次调用失败:"+e)}})}.bind(this),1e3)},complete(){}})}createGameClub(){}navigateToMiniProgram(){}shareMessageToFriend(e){}sendMsgToOpenDataProject(e){}makeShareUI(e,t,a,i=0,o=!1){lplatform.uiEngine.CreateShareK(function(){this.shareRecord(e,t)}.bind(this),function(){t&&t()}.bind(this),a,i,o)}httpRequest(e,t,a,i,o,n,r){let s=new XMLHttpRequest;s.timeout=a,s.onreadystatechange=function(){4==s.readyState&&(s.status>=200&&s.status<400?t(null,s.response,s.responseText):t(s.status,null,null))},s.open(i||"GET",e,!0),s.send(o)}recordSceneValue(e){if(lplatform.labData.recordSceneValue){this.env.request({url:"https://lab.bwyxa.com/api/userinfo",data:{sceneValue:e},header:{"content-type":"application/json"},success(e){},fail(e){}})}}}class s{constructor(){this.mAutoCloseTimeout=0,this.autoCloseInterval=null,this.hideShareClose=0,this.rootNode=null}closeToYou(){this.rootNode&&this.rootNode.removeFromParent(),this.autoCloseInterval&&clearInterval(this.autoCloseInterval)}createChaping(e,t,a){let i=e.imgUrlList&&e.imgUrlList[0]?e.imgUrlList[0]:e.iconUrlList&&e.iconUrlList[0]?e.iconUrlList[0]:null,o=e.source,n=e.title,r=cc.view.getVisibleSize(),s=(cc.v2(r.width/2,r.height/2),new cc.Node);s.width=10*cc.winSize.width,s.height=10*cc.winSize.height;let l=cc.director.getScene();s.parent=l,s.zIndex=cc.macro.MAX_ZINDEX,s.group=lplatform.params.uiGroup;let h=new cc.Node;h.parent=s;let d=Math.min(cc.winSize.width,cc.winSize.height);if(h.width=.8*d,lplatform.plog("createChaping:"+lplatform.channel),h.height=9*h.width/16,"Oppo"!=lplatform.channel||lplatform.labData.mainSwitch){s.addComponent(cc.Button);let e=s.addComponent(cc.Graphics);e.strokeColor=new cc.color(0,0,0,180),e.fillColor=new cc.color(0,0,0,180),e.fillRect(-s.width/2,-s.height/2,s.width,s.height)}let c=new cc.Node;c.parent=h,c.x=0,c.y=-h.height/2-90;let m=c.addComponent(cc.Sprite);lplatform.plog("adInfo.clickBtnTxt:"+e.clickBtnTxt);cc.loader.loadRes("ysguanggao/dakaibg",function(e,t){e?console.log(e):m&&(m.spriteFrame=new cc.SpriteFrame(t))});let p=function(){console.log("ad click"),a&&a(),lplatform.oppoNativeClick=null,s.destroy()};lplatform.oppoNativeClick=p,c.on("touchend",p),h.x=cc.winSize.width/2,h.y=cc.winSize.height/2,h.on("touchend",p);let u=new cc.Texture2D;u.initWithData(new Uint8Array([0,0,0]),cc.Texture2D.PixelFormat.RGB888,1,1);let f=h.addComponent(cc.Sprite);f.sizeMode=cc.Sprite.SizeMode.CUSTOM,f.spriteFrame=new cc.SpriteFrame(u),cc.assetManager&&cc.assetManager.loadRemote?cc.assetManager.loadRemote(i,{ext:".jpg"},(e,t)=>{e||!t?(console.log("加载失败，ext .jpg, 尝试png"),cc.assetManager.loadRemote(i,{ext:".png"},(e,t)=>{e||!t?console.log("加载失败，ext .png"):f&&(f.spriteFrame=new cc.SpriteFrame(t))})):f&&(f.spriteFrame=new cc.SpriteFrame(t))}):cc.loader.load({url:i,type:"image"},function(e,t){e?console.log(e):f&&(f.spriteFrame=new cc.SpriteFrame(t))});let g=new cc.Node;g.parent=h,g.width=83,g.height=31,g.x=-h.width/2+g.width/2,g.y=-h.height/2+g.height/2;let w=g.addComponent(cc.Sprite);cc.loader.loadRes("ysguanggao/native_1",function(e,t){e?console.log(e):w.spriteFrame=new cc.SpriteFrame(t)});let y=new cc.Node;y.parent=h;let b=new cc.Node;if(b.parent=h,lplatform.plog("lplatform.cparam.closeBtnScale:"+lplatform.cparam.closeBtnScale+" "),lplatform.cparam.closeBtnScale>=1?(y.width=y.height=58,b.width=b.height=58,y.x=h.width/2+50,y.y=h.height/2+50,b.x=h.width/2+50,b.y=h.height/2+50):(y.width=y.height=58,b.width=b.height=58,y.x=h.width/2-y.width/2,y.y=h.height/2-y.height/2,y.scale=lplatform.cparam.closeBtnScale,b.x=h.width/2-b.width/2,b.y=h.height/2-b.height/2),y.scale=lplatform.cparam.closeBtnScale,o&&"undefined"!=o){let e=new cc.Node;e.x=h.width/2,e.y=-h.height/2,e.anchorX=1,e.anchorY=0,e.parent=h,e.addComponent(cc.Label).string=o}if(n&&"undefined"!=o){let e=new cc.Node;e.x=0,e.y=h.height/2,e.anchorY=0,e.parent=h,e.addComponent(cc.Label).string=n}y.on("touchend",e=>{console.log("closeBtn click"),e.stopPropagation(),t&&t(),s.removeFromParent()});let S=b.addComponent(cc.Sprite);return S.sizeMode=cc.Sprite.SizeMode.CUSTOM,cc.loader.loadRes("ysguanggao/native_3",function(e,t){e?console.log(e):S&&(S.spriteFrame=new cc.SpriteFrame(t))}),s}CreateShareK(e,t,a,i=0,o=!1){let n=lplatform.systemInfo,r=cc.view.getVisibleSize(),s=(cc.v2(r.width/2,r.height/2),new cc.Node);if(this.rootNode=s,s.x=.5*r.width,s.y=.5*r.height,s.parent=cc.director.getScene(),s.zIndex=cc.macro.MAX_ZINDEX,s.setContentSize(cc.winSize),s.group=lplatform.params.uiGroup,a){let e=new cc.Node;e.zIndex=1,e.width=r.width,e.height=r.height,e.parent=s;let t=lGlobal.nodeShot(e,a,t),i=new cc.SpriteFrame(t);i.setFlipY(!0),e.addComponent(cc.Sprite).spriteFrame=i,cc.tween(e).to(.5,{width:691.5,height:847.5,x:0,y:112}).start()}let l=new cc.Node;l.parent=s,l.opacity=120,l.scale=1e3,cc.loader.loadRes("fenxiang/mask",function(e,t){l.addComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t)}),s.on("touchstart",e=>{},this,!0),s.on("touchend",e=>{},this,!0);let h=new cc.Node;h.parent=s,h.x=0,h.y=0,h.scale=1.5,h.zIndex=2,cc.loader.loadRes("fenxiang/share",function(e,t){h.addComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t)});let d=new cc.Node;d.parent=h,d.x=0,d.scale=.9,d.y=-295,cc.loader.loadRes("fenxiang/queding",function(e,t){d.addComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t)}),d.on(cc.Node.EventType.TOUCH_END,function(t){e&&e(),s.removeFromParent()});let c=new cc.Node;c.parent=h,n.windowWidth>n.windowHeight?(c.x=290,c.y=190):(c.x=190,c.y=310),c.scale=1,cc.loader.loadRes("fenxiang/close",function(e,t){c.addComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(t)});var m=new cc.Node;m.parent=h,m.x=0,m.y=-240,m.color=cc.color(3,35,79,255);let p=m.addComponent(cc.Label);if(p.string="秒自动关闭",i){m.active=!0,this.mAutoCloseTimeout=i;let e=16;this.autoCloseInterval=setInterval(function(){this.mAutoCloseTimeout-=e/1e3,p.string=Math.ceil(this.mAutoCloseTimeout)+"秒自动关闭",this.mAutoCloseTimeout<=0&&(this.autoCloseInterval&&clearInterval(this.autoCloseInterval),console.log("auto close"),t&&t(),s.removeFromParent())}.bind(this),e)}else m.active&&(m.active=!1);if(this.hideShareClose=lplatform.cparam.hideShareClose,Math.random()<=this.hideShareClose)c.active=!1;else{c.scale=0;let e=cc.delayTime(1),t=cc.scaleTo(.3,1,1).easing(cc.easeBackOut()),a=cc.scaleTo(.3,10,10).easing(cc.easeBackOut());c.runAction(cc.sequence(e,a,t))}if(c.on(cc.Node.EventType.TOUCH_END,function(e){console.log("closeBtn click closeShare"),t&&t(),s.removeFromParent(),this.autoCloseInterval&&clearInterval(this.autoCloseInterval)}.bind(this)),h.opacity=0,cc.tween(h).delay(.3).to(.4,{opacity:255}).start(),o&&"ios"!==n.platform){let e=new cc.Node;e.parent=s,e.x=-.5*r.width,e.y=.5*r.height,e.anchorX=0,e.anchorY=1,cc.loader.loadRes("fenxiang/adlist",function(t,a){e.addComponent(cc.Sprite).spriteFrame=new cc.SpriteFrame(a);let i=cc.moveTo(6,cc.v2(-.5*r.width-1e3+r.width,.5*r.height)),o=cc.moveTo(6,cc.v2(-.5*r.width,.5*r.height));e.runAction(cc.repeatForever(cc.sequence(i,o)))}),e.on(cc.Node.EventType.TOUCH_END,function(e){lplatform.goToGameOrGameList(null)})}return s}getCanvas(){return cc.game.canvas}}class l{constructor(){this.mAutoCloseTimeout=0,this.autoCloseInterval=null,this.hideShareClose=0,this.videoAd=null,this.bannerAd=null,this.yuanshengIndex=0,this.yuanshengADK=null,this.yuanshengADBanner=null}closeToYou(){this.yuanshengADK&&this.yuanshengADK.destroy(),this.yuanshengADBanner&&this.yuanshengADBanner.destroy()}createChaping(e,t,a){let i=e.imgUrlList&&e.imgUrlList[0]?e.imgUrlList[0]:e.iconUrlList&&e.iconUrlList[0]?e.iconUrlList[0]:null,o=e.source,n=e.title,r=new Laya.Box;r.left=-10,r.right=-10,r.top=-10,r.bottom=-10,r.zOrder=1e4,Laya.stage.addChild(r);let s=new Laya.Image("res/ysguanggao/native_2.png");s.left=-10,s.right=-10,s.top=-10,s.bottom=-10,s.alpha=.7,r.addChild(s),s.on("click",this,function(){});let l=new Laya.Image(i);l.centerX=0,l.centerY=0,l.width=360,l.height=240;let h=(Laya.stage.width-50)/l.width;l.scaleX=h,l.scaleY=h,r.addChild(l);let d=function(){a&&a(),r.destroy(),console.log("ad click")}.bind(this);l.on("click",this,d);let c=new Laya.Image("res/ysguanggao/native_1.png");c.anchorX=1,c.anchorY=1,c.centerX=150*h,c.centerY=110*h,r.addChild(c);let m=new Laya.Image("res/ysguanggao/native_3.png");m.scaleX=lplatform.cparam.closeBtnScale||1,m.scaleY=lplatform.cparam.closeBtnScale||1,lplatform.cparam.closeBtnScale<1?(m.centerX=170*h,m.centerY=-110*h):(m.centerX=170*h,m.centerY=-140*h),m.width=58,m.height=58,r.addChild(m),m.on("click",this,function(){console.log("ad close"),t&&t(),r.destroy()});let p=new Laya.Image("res/ysguanggao/native_3.png");p.centerX=m.centerX,p.centerY=m.centerY,p.width=m.width,p.height=m.height,p.scaleX=1,p.scaleY=1,r.addChild(p);let u=null;u=e.clickBtnTxt.indexOf("下载")>=0?"res/ysguanggao/xiazaibg.png":"res/ysguanggao/dakaibg.png";let f=new Laya.Image(u);f.centerX=0*h,f.centerY=140*h,f.on("click",this,d),r.addChild(f);let g=new Laya.Label(o||"");g.fontSize=30,g.centerX=-110*h,g.centerY=110*h,r.addChild(g);let w=new Laya.Label(n||"");return w.fontSize=30,w.centerX=0*h,w.centerY=-130*h,r.addChild(w),r.alpha=0,(new Laya.Tween).to(r,{alpha:1},500,Laya.Ease.backOut),r}createBanner(e,t,a){let i=e.imgUrlList[0],o=e.source,n=e.title,r=new Laya.Sprite;r.width=r.height=0,r.zOrder=1e4,Laya.stage.addChild(r);Laya.stage.width;let s=new Laya.Image(i);s.width=Laya.stage.width-20,s.height=240,s.x=10,s.y=Laya.stage.height-s.height+0,r.addChild(s);let l=function(){console.log("ad click"),a&&a(),r.destroy()}.bind(this);s.on("click",this,l);let h=new Laya.Image("res/ysguanggao/native_1.png");h.width=83,h.height=31,h.x=s.width-h.width,h.y=s.height-h.height,s.addChild(h);let d=new Laya.Image("res/ysguanggao/native_3.png");d.width=38,d.height=38,d.x=s.width-d.width-5,d.y=5,d.scaleX=lplatform.cparam.closeBtnScale||1,d.scaleY=lplatform.cparam.closeBtnScale||1,s.addChild(d),d.on("click",this,function(){console.log("ad close"),t&&t(),r.destroy()});let c=new Laya.Image("res/ysguanggao/native_3.png");c.width=d.width,c.height=d.height,c.x=d.centerX,c.y=d.centerY,s.addChild(c);let m=null;m=e.clickBtnTxt.indexOf("下载")>=0?"res/ysguanggao/xiazaibg.png":"res/ysguanggao/dakaibg.png";let p=new Laya.Image(m);if(p.width=200,p.height=70,p.x=s.width/2-p.width/2,p.y=-p.height-20,p.on("click",this,l),s.addChild(p),o){let e=new Laya.Label(o);e.fontSize=25,e.bgColor="#ffffffff",e.x=0,e.y=s.height-e.height,s.addChild(e)}if(n){let e=new Laya.Label(n);e.fontSize=25,e.bgColor="#ffffffff",e.x=s.width/2-e.width/2,e.y=0,s.addChild(e)}return r.alpha=0,(new Laya.Tween).to(r,{alpha:1},500,Laya.Ease.backOut),r}CreateShareK(e,t,a,i=0,o=!1){let n=new Laya.Box;n.left=-10,n.right=-10,n.top=-10,n.bottom=-10,n.zOrder=1e4,Laya.stage.addChild(n);let r=new Laya.Image("fenxiang/mask.png");r.left=-10,r.right=-10,r.top=-10,r.bottom=-10,r.alpha=.4,n.addChild(r),r.on("click",this,function(){});let s=new Laya.Image("fenxiang/share.png");s.centerX=0,s.centerY=0,n.addChild(s);let l=new Laya.Image("fenxiang/queding.png");l.centerX=0,l.centerY=270,n.addChild(l),l.on("click",this,function(){e&&e(),n.destroy()});let h=new Laya.Image("fenxiang/close.png");info.windowWidth>info.windowHeight?(h.centerX=-310,h.centerY=-195):(h.centerX=-195,h.centerY=-310),n.addChild(h),h.on("click",this,function(e){console.log("closeBtn click"),t&&t(),this.autoCloseInterval&&clearInterval(this.autoCloseInterval),n.destroy()});let d=Math.random();if(lplatform.cparam.hideShareClose&&d<=lplatform.cparam.hideShareClose?h.visible=!1:(h.scaleX=0,h.scaleY=0,(new Laya.Tween).to(h,{scaleX:1,scaleY:1},300,Laya.Ease.backOut,null,1e3)),n.alpha=0,(new Laya.Tween).to(n,{alpha:1},500,Laya.Ease.backOut),o&&"ios"!==lplatform.systemInfo.platform){let e=new Laya.Image("fenxiang/adlist"+Math.floor(4*Math.random())+".png");e.x=0,e.y=0,n.addChild(e),e.on(Laya.Event.CLICK,this,function(e){lplatform.goToGameOrGameList(null)}),this.zuo=function(){(new Laya.Tween).to(e,{x:Laya.stage.width-1e3},3e3,null,Laya.Handler.create(this,function(){this.you()}))}.bind(this),this.you=function(){(new Laya.Tween).to(e,{x:0},3e3,null,Laya.Handler.create(this,function(){this.zuo()}))}.bind(this),this.zuo()}return n}getCanvas(){return Laya.Render.canvas}}class h extends r{constructor(){super(),this.gameRecordShareBtn=null,this.moreGamePortal=null}init(){this.env=window.wx,this.info=window.lplatform&&lplatform.systemInfo||this.env.getSystemInfoSync(),this.bh=lplatform.cparam.bannerHeight||170,this.bw=lplatform.cparam.bannerWidth||Math.min(this.info.windowWidth,16*this.bh/9),this.gameRecorderManager=this.env.getGameRecorder(),this.createGameClub(),this.showShareMenu(),this.checkLogin()}initAD(){this.loadBanner(!1),this.loadInterstitial(!1),this.createRewardedVideo(!1)}checkLogin(){let e=this;e.env.checkSession({success(){e.logined=!0},fail(){e.env.login({success(t){t.code?e.logined=!0:console.log("登录失败！"+t.errMsg)}})}})}loadInterstitial(e){this.hideInterstitial(),this.insterstitialAd?this.insterstitialAd.load():(this.insterstitialAd=this.env.createInterstitialAd({adUnitId:lplatform.cparam.interstitialID}),this.insterstitialAd.onLoad(this.onInterstitialLoad.bind(this)),this.insterstitialAd.onError(this.onInterstitialError.bind(this)),this.insterstitialAd.onClose(this.onInterstitialClose.bind(this))),e&&this.showInterstitial()}onInterstitialError(e,t){}onInterstitialClose(){}showInterstitial(){let e=this;this.insterstitialAd?this.insterstitialAd.show().catch(t=>{lplatform.plog("showInterstitial cache:"+JSON.stringify(t)),e.createMoreGamePortal(!0,!0)}):this.loadInterstitial(!0),this.createNativeGridAd()}hideInterstitial(){this.insterstitialAd,this.nativeGridAd&&this.nativeGridAd.hide()}createGridAd(){this.gridAd&&this.gridAd.destroy();let e=this.info.windowWidth-100,t=this.info.windowWidth/2-e/2,a=this.info.windowHeight/2-e/2;this.gridAd=this.env.createGridAd({adUnitId:lplatform.cparam.gridID,adIntervals:30,gridCount:5,style:{left:t,top:a,width:e,opacity:.8}}),this.gridAd.show()}showGridAd(){this.gridAd?this.gridAd.show():this.createGridAd()}createNativeGridAd(){this.nativeGridAd&&this.nativeGridAd.destroy();let e=this.info.windowWidth,t=this.info.windowWidth/2-e/2;this.nativeGridAd=wx.createCustomAd({adUnitId:lplatform.cparam.nativeID,style:{left:t,top:0,width:e,fixed:!0}}),this.nativeGridAd.show()}showNativeGridAd(){this.nativeGridAd?this.nativeGridAd.show():this.createNativeGridAd()}createGameClub(){this.env.createGameClubButton({icon:"green",style:{left:lplatform.cparam.gameClubLeft*lplatform.systemInfo.windowWidth,top:lplatform.cparam.gameClubTop*lplatform.systemInfo.windowHeight,width:40,height:40}})}showShareMenu(){"function"==typeof this.env.showShareMenu&&this.env.showShareMenu({withShareTicket:!0,menus:["shareAppMessage","shareTimeline"]}),this.env.onShareAppMessage(function(){return{title:lplatform.cparam.shareAppTitle,imageUrl:lplatform.uiEngine.getCanvas().toTempFilePathSync({destWidth:500,destHeight:400})}})}shareAppMessage(e){this.env.shareAppMessage({title:lplatform.cparam.shareAppTitle})}navigateToMiniProgram(){}shareMessageToFriend(e){}showFavoriteGuide(){console.log("微信未实现showFavoriteGuide")}subscribeAppMsg(){this.env.subscribeAppMsg({tmplIds:lplatform.cparam.tmplIds,subscribe:!0,success(e){console.log("----subscribeAppMsg----success",e)},fail(e){console.log("----subscribeAppMsg----fail",e)}})}sendMsgToOpenDataProject(e){if(this.logined){this.env.getOpenDataContext().postMessage(e)}else this.checkLogin()}setUserCloudStorage(e){this.sendMsgToOpenDataProject({name:"setUserCloudStorage",kvdata:e})}canRecord(){return!(!this.gameRecorderManager||!this.gameRecorderManager.isFrameSupported())||(console.log("不支持录制游戏画面"),!1)}startRecord(e){if(this.canRecord()){lplatform.plog("startRecord"),this.recordStartCb=e,this.videoPath=null,this.gameRecorderManager.start({fps:24,bitrate:1e3,hookBgm:!1,duration:30}),this.gameRecorderManager.on("start",this.onGameRecordStart.bind(this)),this.gameRecorderManager.on("error",this.onGameRecordError.bind(this)),this.gameRecorderManager.on("stop",this.onGameRecordStop.bind(this));let t=this;this.env.onShow(e=>{lplatform.plog("startRecord this.env.onShow"),t.resumeRecord()}),this.env.onHide(()=>{lplatform.plog("startRecord this.env.onHide"),t.pauseRecord()})}}onGameRecordStart(){this.gameRecordStartTime=Date.now(),this.recordStartCb&&(this.recordStartCb(),this.recordStartCb=null)}onGameRecordError(e){lplatform.plog("onGameRecordError:"+JSON.stringify(e),"error")}onGameRecordStop(e){lplatform.plog("onGameRecordStop this.recordStopCb:"+this.recordStopCb),this.gameRecordStopTime=Date.now(),this.gameRecordStopTime-this.gameRecordStartTime>4500?this.videoPath="res.videoPath":lplatform.plog("onGameRecordStop 实际录屏时间少于5秒就有可能分享失败"),this.recordStopCb&&(this.recordStopCb(this.videoPath),this.recordStopCb=null)}pauseRecord(){this.gameRecorderManager.pause()}resumeRecord(){this.gameRecorderManager.resume()}stopRecord(e){this.canRecord()&&(lplatform.plog("stopRecord cb:"+e),this.recordStopCb=e,this.gameRecorderManager.stop())}shareRecord(e,t){this.shareAppMessage(null)}resetRecord(){this.stopRecord(),this.videoPath=null}shareInnerRecord(e,t){}makeShareUI(e,t,a,i=0,o=!1){if(lplatform.uiEngine.CreateShareK(function(){this.shareRecord(e,t)}.bind(this),function(){t&&t(),this.gameRecordShareBtn&&this.gameRecordShareBtn.hide()}.bind(this),a,i,o),!this.gameRecordShareBtn){this.gameRecordShareBtn=this.env.createGameRecorderShareButton({style:{left:lplatform.cparam.shareRecordBtnLeft*lplatform.systemInfo.windowWidth-lplatform.systemInfo.windowWidth/3.5,top:lplatform.cparam.shareRecordBtnTop*lplatform.systemInfo.windowHeight-lplatform.cparam.shareRecordBtnHeight/2,height:lplatform.cparam.shareRecordBtnHeight,color:"#ffffff",textAlign:"center",fontSize:16,borderRadius:4,iconMarginRight:16,paddingLeft:1,paddingRight:30},text:"分享你的神操作",share:{query:"a=1&b=2",bgm:"bgm.mp3",timeRange:[[0,3e4]]}});let e=this;this.gameRecordShareBtn.onTap(t=>{console.error(JSON.stringify(t)),lplatform.uiEngine.closeToYou(),e.gameRecordShareBtn.hide()})}lplatform.cparam.showVideoShareBtn?this.gameRecordShareBtn.show():this.gameRecordShareBtn.hide()}showBanner(){if(this.hideBanner(),lplatform.labData.mainSwitch){Math.random()<=lplatform.cparam.moreGameBannerPercent?this.createMoreGameBanner():this.bannerAd?this.bannerAd.show().then(()=>{}).catch(e=>{lplatform.plog(e)}):this.loadBanner(!0)}}createMoreGameBanner(){if("function"==typeof this.env.createGameBanner){let e=Math.floor(Math.random()*lplatform.cparam.moreGameBannerAppId.length),t=lplatform.cparam.moreGameBannerAppId[e],a=300,i=104;this.btop=0,lplatform.cparam.bannerOnBottom&&(this.btop=this.info.windowHeight-i),this.moreGameBanner&&this.moreGameBanner.destroy(),this.moreGameBanner=this.env.createGameBanner({adUnitId:t,style:{left:(this.info.windowWidth-a)/2,top:this.btop}}),this.moreGameBanner.show()}}createMoreGamePortal(e=!1,t=!1){}goToGameOrGameList(e){this.createMoreGamePortal(!0,!0)}httpRequest(e,t,a,i,o,n,r){this.env.request({url:e,data:o,header:n,timeout:a,method:i,dataType:r,success(e){t(null,e.data,JSON.stringify(e.data))},fail(e){t(e,null,null)}})}}class d extends h{constructor(){super(),this.moreGamePortal=null,this.moreGameBanner=null,this.moreGameBannerLeft=16,this.moreGameBannerTop=16,this.multiMoreGameBanner=[]}init(){this.env=window.qq,this.info=window.lplatform&&lplatform.systemInfo||this.env.getSystemInfoSync(),this.bh=lplatform.cparam.bannerHeight||170,this.bw=lplatform.cparam.bannerWidth||Math.min(this.info.windowWidth,16*this.bh/9),this.logined=!1,this.showShareMenu(),this.checkLogin()}initAD(){this.loadBanner(!1),this.loadInterstitial(!1),this.createRewardedVideo(!1)}checkLogin(){let e=this;e.env.checkSession({success(){e.logined=!0},fail(){e.env.login({success(t){t.code?e.logined=!0:console.log("登录失败！"+t.errMsg)}})}})}showFavoriteGuide(){this.env.addToFavorites({title:"加关注，不迷路。",imageUrl:"",query:"a=1&b=2",success:function(e){},fail:function(e){console.log("addToFavorites fail",e)},complete:function(e){}}),setTimeout(function(){this.saveAppToDesktop()}.bind(this),15e3),setTimeout(function(){this.addRecentColorSign()}.bind(this),1e5)}showShareMenu(){"function"==typeof this.env.showShareMenu&&this.env.showShareMenu({showShareItems:["qq","qzone","wechatFriends","wechatMoment"]}),this.env.onShareAppMessage(function(){return lplatform.plog("onShareAppMessage lplatform.cparam.shareAppImgUrl:"+lplatform.cparam.shareAppImgUrl),{title:lplatform.cparam.shareAppTitle,imageUrl:lplatform.cparam.shareAppImgUrl}})}shareAppMessage(e,t){lplatform.plog("shareAppMessage lplatform.cparam.shareAppImgUrl:"+lplatform.cparam.shareAppImgUrl),this.env.shareAppMessage({title:lplatform.cparam.shareAppTitle,imageUrl:lplatform.cparam.shareAppImgUrl,success:function(){e&&e()},fail:function(){t&&t()}})}shareRecord(e,t){this.shareAppMessage(e,t)}makeShareUI(e,t,a,i=0,o=!1){lplatform.uiEngine.CreateShareK(function(){this.shareRecord(e,t)}.bind(this),function(){t&&t(),this.gameRecordShareBtn&&this.gameRecordShareBtn.hide()}.bind(this),a,i,!1)}showInterstitial(){this.insterstitialAd?this.insterstitialAd.show().catch(e=>{lplatform.plog("showInterstitial cache:"+JSON.stringify(e));let t=this;lplatform.labData.mainSwitch&&t.createMoreGamePortal(!1,!0)}):this.loadInterstitial(!0)}hideInterstitial(){this.insterstitialAd,this.moreGamePortal&&this.moreGamePortal.destroy()}createMoreGamePortal(e=!1,t=!0){if(lplatform.plog("QQ createMoreGamePortal typeof this.env.createAppBox:"+typeof this.env.createAppBox),"function"==typeof this.env.createAppBox&&lplatform.cparam.moreGamePortalAppId&&lplatform.cparam.moreGamePortalAppId.length>0){if(e&&this.moreGamePortal&&(this.moreGamePortal.destroy(),this.moreGamePortal=null),lplatform.plog("QQ createMoreGamePortal this.moreGamePortal:"+this.moreGamePortal),!this.moreGamePortal){let e=Math.floor(Math.random()*lplatform.cparam.moreGamePortalAppId.length),t=lplatform.cparam.moreGamePortalAppId[e];lplatform.plog("QQ createMoreGamePortal baid:"+t),this.moreGamePortal=this.env.createAppBox({adUnitId:t})}lplatform.plog("QQ createMoreGamePortal autoShow:"+t);let a=this;this.moreGamePortal.load().then(()=>{t&&a.moreGamePortal.show()}).catch(e=>{lplatform.plog("moreGamePortal load catch:"+JSON.stringify(e))})}}showRealBanner(){this.bannerAd?this.bannerAd.show():this.loadBanner(!0)}showBanner(){this.hideBanner(),lplatform.labData.mainSwitch;Math.random()<=lplatform.cparam.moreGameBannerPercent?this.createMoreGameBanner(!0,!0):this.showRealBanner()}hideBanner(e=!1){this.bannerAd&&(this.bannerAd.hide(),e&&(this.bannerAd.offLoad(this.onBannerLoad),this.bannerAd.offError(this.onBannerError),this.bannerAd.offResize(this.onBannerResize),this.bannerAd.destroy(),this.bannerAd=null)),this.moreGameBanner&&this.moreGameBanner.hide()}hideMoreGameBanner(){this.moreGameBanner&&(this.moreGameBanner.offResize(()=>{}),this.moreGameBanner.offLoad(()=>{}),this.moreGameBanner.offError(()=>{}),this.moreGameBanner.destroy(),this.moreGameBanner=null)}createMoreGameBanner(e=!1,t=!1){if(lplatform.plog("QQ createMoreGameBanner typeof this.env.createBlockAd:"+typeof this.env.createBlockAd),"function"==typeof this.env.createBlockAd){let a=this;if(lplatform.cparam.moreGameBannerAppId&&(e&&this.moreGameBanner&&(this.moreGameBanner.offResize(()=>{}),this.moreGameBanner.offLoad(()=>{}),this.moreGameBanner.offError(()=>{}),this.moreGameBanner.destroy(),this.moreGameBanner=null),!this.moreGameBanner)){let e=Math.floor(Math.random()*lplatform.cparam.moreGameBannerAppId.length),i=lplatform.cparam.moreGameBannerAppId[e];lplatform.plog("QQ createMoreGameBanner baid:"+i+" this.moreGameBannerLeft:"+this.moreGameBannerLeft+" this.moreGameBannerTop:"+this.moreGameBannerTop),this.moreGameBanner=this.env.createBlockAd({adUnitId:i,style:{left:Math.max(0,this.moreGameBannerLeft),top:Math.max(0,this.moreGameBannerTop)},size:5,orientation:"landscape"}),this.moreGameBanner.onResize(e=>{a.moreGameBannerTop=0,lplatform.cparam.bannerOnBottom&&(a.moreGameBannerTop=a.info.windowHeight-e.height-20),a.moreGameBanner.style.top=Math.max(0,a.moreGameBannerTop),a.moreGameBanner.style.left=Math.max(0,(a.info.windowWidth-e.width)/2),lplatform.plog("QQ createMoreGameBanner onResize size:"+JSON.stringify(e)+" top:"+a.moreGameBanner.style.top+" left:"+a.moreGameBanner.style.left)}),this.moreGameBanner.onLoad(()=>{lplatform.plog("QQ createMoreGameBanner onLoad autoShow:"+t),t&&a.moreGameBanner.show()}),this.moreGameBanner.onError(e=>{lplatform.plog("QQ createmoreGameBanner onError res:"+JSON.stringify(e))})}}}createOutMoreGameBanner(e,t,a,i){let o=e.x,n=e.y;var r=this.env.createBlockAd({adUnitId:i,style:{left:o,top:n},size:t||1,orientation:a||"vertical"});return r.onResize(t=>{r.style.left=Math.max(0,e.x-t.width/2/1),r.style.top=Math.max(0,e.y-t.height/2/1)}),r.onLoad(()=>{r.show()}),r.onError(e=>{lplatform.plog("QQ createOutMoreGameBanner onError res:"+JSON.stringify(e))}),r}createMultiMoreGameBanner(){let e=this;for(let t=0;t<lplatform.cparam.mmgPos.length;t++)if(this.multiMoreGameBanner[t]&&(this.multiMoreGameBanner[t].offResize(()=>{}),this.multiMoreGameBanner[t].offLoad(()=>{}),this.multiMoreGameBanner[t].offError(()=>{}),this.multiMoreGameBanner[t].destroy(),this.multiMoreGameBanner[t]=null),!this.multiMoreGameBanner[t]){let a={x:e.info.windowWidth*lplatform.cparam.mmgPos[t].x,y:e.info.windowHeight*lplatform.cparam.mmgPos[t].y},i=lplatform.cparam.mmgSize[t],o=lplatform.cparam.mmgOrientation[t],n=lplatform.cparam.mmgId[t];this.multiMoreGameBanner[t]=this.createOutMoreGameBanner(a,i,o,n)}}showMultiMoreGameBanner(){this.createMultiMoreGameBanner()}hideMultiMoreGameBanner(){for(let e=0;e<this.multiMoreGameBanner.length;e++)this.multiMoreGameBanner[e]&&this.multiMoreGameBanner[e].hide()}canRecord(){return console.log("不支持录制游戏画面"),!1}canShareRecord(){return!0}goToGameOrGameList(e){lplatform.plog("qq未实现 goToGameOrGameList")}shareMessageToFriend(e){}saveAppToDesktop(){this.env.saveAppToDesktop({success:()=>{},fail:()=>{},complete:()=>{}})}subscribeAppMsg(){this.env.subscribeAppMsg({tmplIds:lplatform.cparam.tmplIds,subscribe:!0,success(e){console.log("----subscribeAppMsg----success",e)},fail(e){console.log("----subscribeAppMsg----fail",e)}})}sendMsgToOpenDataProject(e){this.logined?super.sendMsgToOpenDataProject(e):this.checkLogin()}setUserCloudStorage(e){this.sendMsgToOpenDataProject({name:"setUserCloudStorage",kvdata:e})}addRecentColorSign(){this.env.addRecentColorSign({query:"a=1&b=2",success(e){},fail(e){console.log("addRecentColorSign fail: ",e)},complete(e){}})}}class c extends h{constructor(){super()}init(){this.env=window.swan,this.info=window.lplatform&&lplatform.systemInfo||this.env.getSystemInfoSync(),this.bh=lplatform.cparam.bannerHeight||170,this.bw=lplatform.cparam.bannerWidth||Math.min(this.info.windowWidth,16*this.bh/9),this.gameRecorderManager=this.env.getVideoRecorderManager(),this.createMoreGameButton(),this.showShareMenu()}initAD(){this.loadBanner(!1),this.createRewardedVideo(!1)}loadBanner(e){this.hideBanner(!0),this.bannerAd||(this.btop=0,lplatform.cparam.bannerOnBottom&&(this.btop=this.info.windowHeight-this.bh),this.bannerAd=this.env.createBannerAd({adUnitId:lplatform.cparam.bannerID,appSid:lplatform.cparam.appSid,adIntervals:30,style:{width:this.bw,height:this.bh,left:(this.info.windowWidth-this.bw)/2,top:this.btop}}),this.bannerAd.onLoad(this.onBannerLoad.bind(this)),this.bannerAd.onError(this.onBannerError.bind(this)),this.bannerAd.onResize(this.onBannerResize.bind(this))),this.bannerAutoShow=e}onBannerResize(e){this.btop=0,lplatform.cparam.bannerOnBottom&&(this.btop=this.info.windowHeight-e.height),this.bannerAd.style.top=this.btop,this.bannerAd.style.left=0}createRewardedVideo(e){lplatform.cparam.rewardedVideoID&&(this.rewardedVideoAd||"function"!=typeof this.env.createRewardedVideoAd||(this.rewardedVideoAd=this.env.createRewardedVideoAd({adUnitId:lplatform.cparam.rewardedVideoID,appSid:lplatform.cparam.appSid}),this.rewardedVideoAd.onError(this.onRewardedVideoError.bind(this)),this.rewardedVideoAd.onClose(this.onRewardedVideoClose.bind(this)),this.rewardedVideoAd.onLoad(this.onRewardedVideoLoad.bind(this))),e&&this.showRewardedVideo(window.vcb))}showRewardedVideo(e){lplatform.pauseGame(),super.showRewardedVideo(e)}onRewardedVideoError(e,t){super.onRewardedVideoError(e,t),lplatform.resumeGame()}onRewardedVideoClose(e){super.onRewardedVideoClose(e),lplatform.resumeGame()}loadInterstitial(e){}onInterstitialClose(){}showInterstitial(){}hideInterstitial(){}showFavoriteGuide(){lplatform.plog("PBaiDu,showFavoriteGuide"),"function"==typeof this.env.showFavoriteGuide&&this.env.showFavoriteGuide({type:"tip",content:"一键添加到我的小程序"})}showAddToDesktopGuide(){"function"==typeof this.env.showAddToDesktopGuide&&this.env.showAddToDesktopGuide({type:"bar-autohide",content:"一键添加到我的桌面",success:e=>{console.log("添加成功：",e)},fail:e=>{console.log("添加失败：",e)}})}showShareMenu(){"function"==typeof this.env.showShareMenu&&this.env.showShareMenu({success:function(){},fail:function(){},complete:function(){}}),this.env.onShareAppMessage(function(){return{title:lplatform.cparam.shareAppTitle,imageUrl:lplatform.cparam.shareAppImgUrl,query:"key1=1&key2=2&key3=3",success:e=>{lplatform.plog("onShareAppMessage share success",JSON.stringify(e))},fail:e=>{lplatform.plog("onShareAppMessage share fail",JSON.stringify(e))}}})}shareAppMessage(e){this.env.shareAppMessage({title:lplatform.cparam.shareAppTitle,imageUrl:lplatform.cparam.shareAppImgUrl})}canRecord(){return!(!this.gameRecorderManager||!lplatform.cparam.canRecord)||(lplatform.plog("PBaiDu,不支持录制游戏画面"),!1)}startRecord(e){if(this.canRecord()){lplatform.plog("startRecord"),this.recordStartCb=e,this.videoPath=null,this.gameRecorderManager.start({duration:30}),this.gameRecorderManager.onStart(this.onGameRecordStart.bind(this)),this.gameRecorderManager.onError(this.onGameRecordError.bind(this)),this.gameRecorderManager.onStop(this.onGameRecordStop.bind(this));let t=this;this.env.onShow(e=>{lplatform.plog("startRecord this.env.onShow"),t.resumeRecord()}),this.env.onHide(()=>{lplatform.plog("startRecord this.env.onHide"),t.pauseRecord()})}}onGameRecordStart(){lplatform.plog("PBaiDu,onGameRecordStart"),this.gameRecordStartTime=Date.now(),this.recordStartCb&&(this.recordStartCb(),this.recordStartCb=null)}onGameRecordError(e){lplatform.plog("onGameRecordError:"+JSON.stringify(e),"error")}onGameRecordStop(e){lplatform.plog("onGameRecordStop this.recordStopCb:"+this.recordStopCb),this.gameRecordStopTime=Date.now(),this.gameRecordStopTime-this.gameRecordStartTime>4500?this.videoPath=e.videoPath:lplatform.plog("onGameRecordStop 实际录屏时间少于5秒就有可能分享失败"),this.recordStopCb&&(this.recordStopCb(this.videoPath),this.recordStopCb=null)}pauseRecord(){this.gameRecorderManager.pause()}resumeRecord(){this.gameRecorderManager.resume()}stopRecord(e){lplatform.plog("stopRecord cb:"+e),this.canRecord()&&(this.recordStopCb=e,this.gameRecorderManager.stop())}shareRecord(e,t){lplatform.plog("PBaiDu,shareRecord videoPath:"+this.videoPath),this.canShareRecord()?this.env.shareVideo({videoPath:this.videoPath,success(){e&&e()},fail(e){t&&t(e)}}):this.shareAppMessage()}resetRecord(){this.stopRecord(),this.videoPath=null}createMoreGameButton(){this.createRecommendationButton()}createMoreGameBanner(){}createMoreGamePortal(){}createRecommendationButton(){if("function"==typeof this.env.createRecommendationButton)if(this.moreGameBtn)this.moreGameBtn.show();else{this.moreGameBtn=this.env.createRecommendationButton({type:"list",style:{left:lplatform.cparam.moreGameLeft*lplatform.systemInfo.windowWidth,top:lplatform.cparam.moreGameTop*lplatform.systemInfo.windowHeight}});let e=this;this.moreGameBtn.onLoad(()=>{e.moreGameBtn.show(),e.moreGameBtn.offLoad(()=>{})}),this.moreGameBtn.load()}}makeShareUI(e,t,a,i=0,o=!1){lplatform.uiEngine.CreateShareK(function(){this.shareRecord(e,t)}.bind(this),function(){t&&t(),this.gameRecordShareBtn&&this.gameRecordShareBtn.hide()}.bind(this),a,i,o)}goToGameOrGameList(e){this.navigateToMiniProgram()}navigateToMiniProgram(e){this.env.navigateToMiniProgram({appKey:e||lplatform.cparam.navigateToId[0],path:"/path/page/0",extraData:{},success:e=>{console.log("navigateToMiniProgram success",e)},fail:e=>{console.log("navigateToMiniProgram fail",e)}})}}class m extends r{constructor(){super(),this.yuanshengIndex=0,this.yuanshengADK=null}init(){this.env=window.qg,this.info=window.lplatform&&lplatform.systemInfo||this.env.getSystemInfoSync(),this.bh=lplatform.cparam.bannerHeight||170,this.bw=lplatform.cparam.bannerWidth||Math.min(this.info.windowWidth,16*this.bh/9),"function"==typeof this.env.getGameRecorder&&(this.gameRecorderManager=this.env.getGameRecorder())}initAD(){this.loadBanner(!1),this.createRewardedVideo(!1),this.loadMoreGamePortal(!1)}createRewardedVideo(e){lplatform.cparam.rewardedVideoID&&(this.rewardedVideoAd||"function"!=typeof this.env.createRewardedVideoAd||(this.rewardedVideoAd=this.env.createRewardedVideoAd({adUnitId:lplatform.cparam.rewardedVideoID}),this.rewardedVideoAd.onError(this.onRewardedVideoError.bind(this)),this.rewardedVideoAd.onClose(this.onRewardedVideoClose.bind(this)),this.rewardedVideoAd.onLoad(this.onRewardedVideoLoad.bind(this))),e&&this.showRewardedVideo(window.vcb))}showRewardedVideo(e){let t=this;e&&(window.vcb=e),this.rewardedVideoAd?(lplatform.plog("showRewardedVideo this.rewardedVideoIsLoaded:"+this.rewardedVideoIsLoaded),this.rewardedVideoAd.show().then(()=>{lplatform.plog("oppo的rewardedVideo.show().then()在视频结束时才调用，shit.")}).catch(e=>{lplatform.plog("showRewardedVideo catch:"+JSON.stringify(e)),t.rewardedVideoAd.load().then(()=>{t.rewardedVideoAd.show()}).catch(()=>{t.loadRewardedVideo(!1)})})):this.createRewardedVideo(!0)}onRewardedVideoError(e,t){super.onRewardedVideoError(e,t),this.env.showToast({title:"加载中，请稍候",message:"加载中，请稍候"})}onRewardedVideoClose(e){super.onRewardedVideoClose(e)}showFavoriteGuide(){let e=this;e.env.hasShortcutInstalled({success:function(t){0==t&&e.env.installShortcut({success:function(){},fail:function(e){},complete:function(){}})},fail:function(e){},complete:function(){}})}createMoreGamePortal(e=!1,t=!1){console.log("poppo createMoreGamePortal"),this.moreGamePortal?(console.log("直接显示",JSON.stringify(this.moreGamePortal)),this.moreGamePortal.show().then(()=>{console.log("show success")}).catch(e=>{console.log("show fail with:"+e.errCode+","+e.errMsg),window.moreGameButton&&(window.moreGameButton.active=!1),this.moreGamePortal.destroy(),this.loadMoreGamePortal(!0)})):(console.log("加载后直接显示"),this.loadMoreGamePortal(!0))}loadMoreGamePortal(e){this.moreGamePortal&&(this.moreGamePortal.destroy(),this.moreGamePortal=null),this.moreGamePortal=qg.createGamePortalAd({adUnitId:lplatform.cparam.spreadBoxID[0]}),this.moreGamePortal.onLoad(()=>{console.log("互推盒子九宫格广告加载成功"),window.moreGameButton&&(window.moreGameButton.active=!0),e&&this.moreGamePortal.show().then(()=>{console.log("show success")}).catch(e=>{console.log("show fail with:"+e.errCode+","+e.errMsg),window.moreGameButton&&(window.moreGameButton.active=!1)})}),this.moreGamePortal.onClose(()=>{console.log("互推盒子九宫格广告关闭"),this.moreGamePortal.destroy().then(()=>{console.log("destroy success")}).catch(e=>{console.log("destroy fail with:"+e.errCode+","+e.errMsg)}),this.loadMoreGamePortal(!1)}),this.moreGamePortal.onError(e=>{window.moreGameButton&&(window.moreGameButton.active=!1),console.log("互推盒子九宫格加载失败"+JSON.stringify(e))})}createMoreGameButton(){}createMoreGameBanner(){if(lplatform.cparam.moreGameBannerId){if(!this.moreGameBanner){lplatform.cparam.moreGameBannerWidth;let e=lplatform.cparam.moreGameBannerHeight;this.btop=0,lplatform.cparam.bannerOnBottom&&(this.btop=this.info.windowHeight-e),this.moreGameBanner=this.env.createGameBannerAd({adUnitId:lplatform.cparam.moreGameBannerId});let t=(e,t)=>{lplatform.plog("监听事件:"+JSON.stringify(e)+" "+JSON.stringify(t))};this.moreGameBanner.onError(t)}this.moreGameBanner.show(),lplatform.cparam.moreGameBannerAutoCloseTime>0&&setTimeout(function(){this.moreGameBanner.hide()}.bind(this),lplatform.cparam.moreGameBannerAutoCloseTime)}}showShareMenu(){}shareAppMessage(e){}canRecord(){return!(!this.gameRecorderManager||!lplatform.cparam.canRecord)}canShareRecord(){return!1}startRecord(e){}onGameRecordStart(){}onGameRecordError(e){}pauseRecord(){}resumeRecord(){}stopRecord(e){}resetRecord(){}shareInnerRecord(e,t){}showBanner(){super.showBanner()}loadInterstitial(e){let t=this;lplatform.plog("createNativeAd lplatform.cparam.nativeID:"+lplatform.cparam.nativeID);let a=lplatform.cparam.nativeID;this.yuanshengIndex+=1,this.yuanshengIndex>=a.length&&(this.yuanshengIndex=0),t.nativeAd&&(t.nativeAd.destroy(),t.nativeAd=null);let i=qg.createNativeAd({adUnitId:a[this.yuanshengIndex]});t.nativeAd=i,i.onLoad(function(e){lplatform.plog("nativeAd.onLoad:"+JSON.stringify(e)),i.reportAdShow({adId:e.adList[0].adId}),t.yuanshengADK&&t.yuanshengADK.destroy&&(lplatform.plog("onLoad this.yuanshengADK.destroy:"+t.yuanshengADK.destroy),t.yuanshengADK.destroy()),lplatform.labData.mainSwitch&&(t.yuanshengADK=lplatform.uiEngine.createChaping(e.adList[0],function(){t.yuanshengADK=null}.bind(t),function(){i.reportAdClick({adId:e.adList[0].adId}),t.yuanshengADK=null}.bind(t)))}.bind(t)),i.onError(function(e){console.log("nativeAd.onError:"+JSON.stringify(e)),i.destroy(),t.yuanshengADK&&t.yuanshengADK.destroy&&(lplatform.plog("onError this.yuanshengADK.destroy:"+t.yuanshengADK.destroy),t.yuanshengADK.destroy())}.bind(this)),i.load()}onInterstitialLoad(){}onInterstitialError(e,t){lplatform.plog("onInterstitialError code:"+e+" msg:"+t)}onInterstitialClose(){}showInterstitial(){this.loadNativeTemplate(!0)}hideInterstitial(){}loadNativeTemplate(e=!0){if(lplatform.cparam.nativeTemplateID){let t=Math.min(this.info.windowWidth,this.info.windowHeight),a=9*t/16,i=this.info.windowWidth,o=qg.createCustomAd({adUnitId:lplatform.cparam.nativeTemplateID,style:{top:(this.info.windowHeight-a)/2,left:.5*i-.8*t/2,width:.8*t}});this.customAd=o,e&&o.show().then(()=>{console.log("show success")}).catch(e=>{console.log("show fail with:"+e.errCode+","+e.errMsg),this.createMoreGamePortal()})}}onGameRecordStop(e){super.onGameRecordStop(e),this.gameRecorderManager.saveToAlbum()}shareRecord(e,t){}makeShareUI(e,t,a,i=0,o=!1){t&&t()}analytics(e,t){}httpRequest(e,t,a,i,o,n,r){let s=new XMLHttpRequest;s.timeout=a,s.onreadystatechange=function(){4==s.readyState&&(s.status>=200&&s.status<400?t(null,s.response,s.responseText):t(s.status,null,null))},s.open(i||"GET",e,!0),s.send(o)}goToGameOrGameList(e){lplatform.plog("Oppo未实现 goToGameOrGameList")}}class p extends m{constructor(){super()}init(){this.env=window.qg,this.info=window.lplatform&&lplatform.systemInfo||this.env.getSystemInfoSync(),this.bh=lplatform.cparam.bannerHeight||170,this.bw=lplatform.cparam.bannerWidth||Math.min(this.info.windowWidth,16*this.bh/9)}initAD(){this.createRewardedVideo(!1),setTimeout(function(){this.createMoreGamePortal(!1,!0)}.bind(this),1e4)}loadBanner(e){this.hideBanner(!0),this.bannerAd||(this.btop=0,lplatform.cparam.bannerOnBottom&&(this.btop=this.info.windowHeight-this.bh),lplatform.plog("loadBanner this.bh:"+this.bh+" this.btop:"+this.btop+" this.bw:"+this.bw+" lplatform.cparam.bannerID:"+lplatform.cparam.bannerID),this.bannerAd=this.env.createBannerAd({posId:lplatform.cparam.bannerID,adIntervals:30,style:{}}),this.bannerAd.onLoad(this.onBannerLoad.bind(this)),this.bannerAd.onError(this.onBannerError.bind(this)),this.bannerAd.onSize(this.onBannerResize.bind(this))),this.bannerAutoShow=e,e&&this.bannerAd.show()}showBanner(){this.loadBanner(!0)}showVivoInterstitial(){const e=qg.createInterstitialAd({posId:lplatform.cparam.interstitialID});e.onError(e=>{console.log("插屏广告加载失败",e)}),e.show().then(()=>{console.log("插屏广告展示完成"),this.customAd&&this.customAd.destroy()}).catch(e=>{console.log("插屏广告展示失败",JSON.stringify(e))})}loadInterstitial(e){{let t=this;this.customAd&&this.customAd.destroy();let a=this.env.createCustomAd({posId:lplatform.cparam.nativeID[0],style:{left:(this.info.windowWidth-1080)/2,top:(this.info.windowHeight-720)/2}});a.onLoad(function(){}.bind(this)),a.onError(function(){t.showVivoInterstitial()}.bind(this)),a.onClose(function(){}.bind(this)),this.customAd=a,e&&this.customAd.show()}}showInterstitial(){this.loadInterstitial(!0)}hideInterstitial(){this.customAd&&(this.customAd.destroy(),this.customAd=null)}createMoreGameBanner(){if(lplatform.cparam.moreGameBannerId){if(!this.moreGameBanner){console.log("createBoxBannerAd:"+lplatform.cparam.moreGameBannerId),this.moreGameBanner=this.env.createBoxBannerAd({posId:lplatform.cparam.moreGameBannerId});let e=(e,t)=>{lplatform.plog("moreGameBanner onError:"+JSON.stringify(e)+" "+JSON.stringify(t))};this.moreGameBanner.onError(e)}console.log("moreGameBanner show"),this.moreGameBanner.show().then(function(){console.log("moreGameBanner show success")}).catch(function(e){console.log("moreGameBanner show fail with:"+e.errCode+","+e.errMsg)}),lplatform.cparam.moreGameBannerAutoCloseTime>0&&setTimeout(function(){this.moreGameBanner.hide()}.bind(this),lplatform.cparam.moreGameBannerAutoCloseTime)}}createMoreGamePortal(e=!1,t=!1){if("function"==typeof this.env.createBoxPortalAd){if(e&&this.moreGamePortal,!this.moreGamePortal){let e=Math.floor(Math.random()*lplatform.cparam.spreadBoxID.length),t=lplatform.cparam.spreadBoxID[e];lplatform.plog("createMoreGamePortal:"+t),this.moreGamePortal=this.env.createBoxPortalAd({posId:t,image:lplatform.cparam.moreGamePortalIconUrl,marginTop:lplatform.cparam.moreGamePortalMarginTop})}t&&this.moreGamePortal.show().then(function(){}).catch(function(e){lplatform.plog("createMoreGamePortal show fail:"+JSON.stringify(e))})}}createRewardedVideo(e){lplatform.cparam.rewardedVideoID&&(this.rewardedVideoAd||"function"!=typeof this.env.createRewardedVideoAd||(this.rewardedVideoAd=this.env.createRewardedVideoAd({posId:lplatform.cparam.rewardedVideoID}),this.rewardedVideoAd.onError(this.onRewardedVideoError.bind(this)),this.rewardedVideoAd.onClose(this.onRewardedVideoClose.bind(this)),this.rewardedVideoAd.onLoad(this.onRewardedVideoLoad.bind(this))),e&&this.showRewardedVideo(window.vcb))}showRewardedVideo(e){let t=this;e&&(window.vcb=e),lplatform.pauseGame(),this.rewardedVideoAd?(lplatform.plog("showRewardedVideo this.rewardedVideoIsLoaded:"+this.rewardedVideoIsLoaded),this.rewardedVideoAd.show().then(()=>{lplatform.plog("oppo的rewardedVideo.show().then()在视频结束时才调用，shit.")}).catch(e=>{lplatform.plog("showRewardedVideo catch:"+JSON.stringify(e)),t.rewardedVideoAd.load().then(()=>{t.rewardedVideoAd.show()}).catch(()=>{t.loadRewardedVideo(!1)})})):this.createRewardedVideo(!0)}onRewardedVideoError(e,t){super.onRewardedVideoError(e,t),this.env.showToast({message:"广告展示失败，请稍后重试！"}),lplatform.resumeGame()}onRewardedVideoClose(e){super.onRewardedVideoClose(e),lplatform.resumeGame()}goToGameOrGameList(e){lplatform.plog("vivoGame未实现 goToGameOrGameList")}showFavoriteGuide(){let e=this;lplatform.cparam.closeBtnScale,e.env.hasShortcutInstalled({success:function(t){0==t&&e.env.installShortcut({success:function(){},fail:function(e){},complete:function(){}})},fail:function(e){},complete:function(){}})}canRecord(){return!1}canShareRecord(){return!1}startRecord(e){}pauseRecord(){}resumeRecord(){}stopRecord(e){}shareRecord(e,t){t&&t()}resetRecord(){}httpRequest(e,t,a,i,o,n,r="text"){this.env.request({url:e,data:o,header:n,timeout:a,method:i,dataType:r,success(e){t(null,e.data,e.data)},fail(e){t(e,null,null)}})}}class u extends m{constructor(){super()}init(){this.env=window.qg,this.info=window.lplatform&&lplatform.systemInfo||this.env.getSystemInfoSync(),this.bh=lplatform.cparam.bannerHeight||170,this.bw=lplatform.cparam.bannerWidth||Math.min(this.info.windowWidth,16*this.bh/9)}initAD(){lplatform.plog("PHuaWei constructor initAD"),qg.setUnderAgeOfPromise(!1),qg.setNonPersonalizedAd(!1),this.createRewardedVideo(!1)}loadBanner(e){if(this.hideBanner(!1),!this.bannerAd){let e=720,t=0;this.btop=0,lplatform.cparam.bannerOnBottom&&(this.btop=this.info.windowHeight-this.bh),lplatform.plog("loadBanner this.bh:"+this.bh+" this.btop:"+this.btop+" this.bw:"+this.bw),this.bannerAd=this.env.createBannerAd({adUnitId:lplatform.cparam.bannerID,adIntervals:60,style:{width:this.bw,height:this.bh,left:t,top:e}}),this.bannerAd.onError(function(e){console.log("bannerAd 广告加载出错",e)}),this.bannerAd.onLoad(function(){console.log("bannerAd 广告加载成功")}),this.bannerAd.onClose(function(){console.log("bannerAd 广告关闭")})}this.bannerAd.show()}showBanner(){this.hideBanner(),lplatform.labData.mainSwitch&&this.loadBanner(!0)}hideBanner(e=!1){this.bannerAd&&(this.bannerAd.hide(),e&&(this.bannerAd.offLoad(this.onBannerLoad),this.bannerAd.offError(this.onBannerError),this.bannerAd.offResize(this.onBannerResize),this.bannerAd.destroy(),this.bannerAd=null)),this.moreGameBanner&&this.moreGameBanner.hide()}loadInterstitial(e){let t=this;this.createMoreGamePortal(!1,!0),lplatform.plog("createNativeAd lplatform.cparam.nativeID:"+lplatform.cparam.nativeID);let a=lplatform.cparam.nativeID;this.yuanshengIndex+=1,this.yuanshengIndex>=a.length&&(this.yuanshengIndex=0);let i=qg.createNativeAd({adUnitId:a[this.yuanshengIndex],success:e=>{console.log("loadNativeAd loadNativeAd : success "+e)},fail:(e,t)=>{console.log("loadNativeAd loadNativeAd fail: "+e+","+t)},complete:()=>{i.load()}});i.onLoad(function(e){lplatform.plog("nativeAd.onLoad:"+JSON.stringify(e)),i.reportAdShow({adId:e.adList[0].adId}),t.yuanshengADK&&(lplatform.plog("this.yuanshengADK.destroy:"+t.yuanshengADK.destroy),t.yuanshengADK.destroy()),t.yuanshengADK=lplatform.uiEngine.createChaping(e.adList[0],function(){t.yuanshengADK=null}.bind(t),function(){i.reportAdClick({adId:e.adList[0].adId}),t.yuanshengADK=null}.bind(t)),qg.onShow(a=>{console.log("lyn qg.onShow:"+JSON.stringify(a)+" nativeAd:"+i+" ts.yuanshengADK:"+t.yuanshengADK),i&&t.yuanshengADK&&(console.log("qg.onShow reportAdShow:"+e.adList[0].adId),i.reportAdShow({adId:e.adList[0].adId}))}),qg.onHide(()=>{})}.bind(t)),i.onError(function(e){console.log("nativeAd.onError:"+JSON.stringify(e)),t.showBanner()}.bind(this))}createRewardedVideo(e){if(lplatform.cparam.rewardedVideoID){let t=this;this.rewardedVideoAd||"function"!=typeof this.env.createRewardedVideoAd||(this.rewardedVideoAd=this.env.createRewardedVideoAd({adUnitId:lplatform.cparam.rewardedVideoID,success:e=>{},fail:(e,a)=>{console.log("loadAndShowVideoAd createRewardedVideoAd fail: "+e+","+a),t.onRewardedVideoError&&t.onRewardedVideoError({msg:"createRewardedVideoAd fail"},"createRewardedVideoAd fail")},complete:()=>{t.rewardedVideoAd.load(),e&&this.showRewardedVideo(window.vcb)}}),this.rewardedVideoAd.onError(this.onRewardedVideoError.bind(this)),this.rewardedVideoAd.onClose(this.onRewardedVideoClose.bind(this)),this.rewardedVideoAd.onLoad(this.onRewardedVideoLoad.bind(this)))}}canRecord(){return!(!this.gameRecorderManager||!lplatform.cparam.canRecord)||(lplatform.plog("huaWei,不支持录制游戏画面"),!1)}shareAppMessage(e){qg.serviceShare({shareType:0,title:lplatform.cparam.shareAppTitle,summary:lplatform.cparam.shareAppTitle,imagePath:lplatform.cparam.shareAppImgUrl,targetUrl:lplatform.cparam.shareAppImgUrl,mediaUrl:lplatform.cparam.shareAppImgUrl,platforms:"",fail:function(e,t){console.log("service share fail:"+t+e)},cancel:function(){console.log("cancel")}})}makeShareUI(e,t,a,i=0,o=!1){lplatform.uiEngine.CreateShareK(function(){this.shareRecord(e,t)}.bind(this),function(){t&&t(),this.gameRecordShareBtn&&this.gameRecordShareBtn.hide()}.bind(this),a,i,o)}shareRecord(e,t){this.shareAppMessage(null)}createMoreGameButton(){}createMoreGameBanner(){}createMoreGamePortal(){}goToGameOrGameList(e){lplatform.plog("huaWei未实现 goToGameOrGameList")}}class f extends h{constructor(){super()}init(){}initAD(){}release(){}loadBanner(e){}onBannerLoad(){}onBannerError(e,t){}onBannerResize(e){}showBanner(){let e={name:"showBanner",data:{}};e=JSON.stringify(e),lplatform.js2NativeEvent(e)}hideBanner(e=!1){let t={name:"closeBanner",data:{}};t=JSON.stringify(t),lplatform.js2NativeEvent(t)}loadInterstitial(e){}onInterstitialLoad(){}onInterstitialError(e,t){}onInterstitialClose(){}showInterstitial(){let e={name:"showChaPing",data:{}};e=JSON.stringify(e),lplatform.js2NativeEvent(e)}hideInterstitial(){}createRewardedVideo(e){}loadRewardedVideo(e){}onRewardedVideoLoad(){}onRewardedVideoError(e,t){}onRewardedVideoClose(e){}showRewardedVideo(e){console.log("","showRewardedVideo"),e&&(window.vcb=e,window.android&&(window.android.videoRewardCb=function(){lplatform.resumeGame(),e(!0)},window.android.videoFailCb=function(){lplatform.resumeGame(),e(!1)}));let t={name:"showvideoAD",data:{}};t=JSON.stringify(t),lplatform.js2NativeEvent(t),lplatform.pauseGame()}resetRewardedVideo(e=!1,t=!1){}shareAppMessage(){}canRecord(){return!1}canShareRecord(){return!1}startRecord(e){}onGameRecordStart(){}onGameRecordError(e){}onGameRecordStop(e){}pauseRecord(){}resumeRecord(){}stopRecord(e){}shareRecord(e,t){}resetRecord(){}shareInnerRecord(e,t){}createMoreGameButton(){}showFavoriteGuide(){}followAccount(){}goToGameOrGameList(e){this.env.showMoreGamesModal({appLaunchOptions:[],success(e){console.log("success",e.errMsg)},fail(e){console.log("fail",e.errMsg)}})}openAwemeUserProfile(){}createMoreGameBanner(){}createMoreGamePortal(){}analytics(e,t){let a={name:e,data:t};lplatform.js2NativeEvent(JSON.stringify(a))}showLoading(e){}hideLoading(){}createGameClub(){}navigateToMiniProgram(){}shareMessageToFriend(e){}sendMsgToOpenDataProject(e){}makeShareUI(e,t,a,i=0,o=!1){t&&t()}httpRequest(e,t,a,i,o,n,r){let s=new XMLHttpRequest;s.timeout=a,s.onreadystatechange=function(){4==s.readyState&&(s.status>=200&&s.status<400?t(null,s.response,s.responseText):t(s.status,null,null))},s.open(i||"GET",e,!0),s.send(o)}}class g extends h{constructor(){super()}init(){this.env=window.gamebox,this.info=window.lplatform&&lplatform.systemInfo||this.env.getSystemInfoSync(),this.bh=lplatform.cparam.bannerHeight||170,this.bw=lplatform.cparam.bannerWidth||Math.min(this.info.windowWidth,16*this.bh/9);gamebox.login()}initAD(){this.loadBanner(!1),this.loadInterstitial(!1),this.createRewardedVideo(!1)}loadBanner(e){this.hideBanner(!0),this.bannerAd||(this.btop=0,lplatform.cparam.bannerOnBottom&&(this.btop=this.info.windowHeight-this.bh),lplatform.plog("loadBanner this.bh:"+this.bh+" this.btop:"+this.btop+" this.bw:"+this.bw),this.bannerAd=this.env.createBannerAd({style:{width:this.bw,height:this.bh,left:(this.info.windowWidth-this.bw)/2,top:this.btop}}),this.bannerAd.onLoad(this.onBannerLoad.bind(this)),this.bannerAd.onError(this.onBannerError.bind(this))),this.bannerAutoShow=e}loadInterstitial(e){this.hideInterstitial(),this.insterstitialAd?this.insterstitialAd.load():(this.insterstitialAd=this.env.createInterstitialAd(),this.insterstitialAd.onLoad(this.onInterstitialLoad.bind(this)),this.insterstitialAd.onError(this.onInterstitialError.bind(this)),this.insterstitialAd.onClose(this.onInterstitialClose.bind(this))),e&&this.showInterstitial()}createRewardedVideo(e){lplatform.cparam.rewardedVideoID&&(this.rewardedVideoAd||"function"!=typeof this.env.createRewardedVideoAd||(this.rewardedVideoAd=this.env.createRewardedVideoAd(),this.rewardedVideoAd.onError(this.onRewardedVideoError.bind(this)),this.rewardedVideoAd.onClose(this.onRewardedVideoClose.bind(this)),this.rewardedVideoAd.onLoad(this.onRewardedVideoLoad.bind(this))),e&&this.showRewardedVideo(window.vcb))}shareAppMessage(e){this.env.shareMessageToFriend({type:1,success:e=>{},fail:e=>{},complete:e=>{}})}makeShareUI(e,t,a,i=0,o=!1){lplatform.uiEngine.CreateShareK(function(){this.shareRecord(e,t)}.bind(this),function(){t&&t(),this.gameRecordShareBtn&&this.gameRecordShareBtn.hide()}.bind(this),a,i,o)}analytics(e,t){}}class w extends r{constructor(){super(),this.gameRecordShareBtn=null,this.moreGamePortal=null}init(){this.env=window.ks||window.kwaigame||window.wx,this.info=window.lplatform&&lplatform.systemInfo||this.env.getSystemInfoSync(),this.bh=lplatform.cparam.bannerHeight||170,this.bw=lplatform.cparam.bannerWidth||Math.min(this.info.windowWidth,16*this.bh/9),"function"==typeof this.env.getGameRecorder&&(this.gameRecorderManager=this.env.getGameRecorder())}initAD(){this.createRewardedVideo(!1)}createGameClub(){}showShareMenu(){}shareAppMessage(e){}navigateToMiniProgram(){}shareMessageToFriend(e){}showFavoriteGuide(){console.log("快手未实现showFavoriteGuide")}sendMsgToOpenDataProject(e){}canRecord(){return!!this.gameRecorderManager||(console.log("不支持录制游戏画面"),!1)}startRecord(e){lplatform.plog("startRecord"),this.recordStartCb=e,this.videoPath=null,this.gameRecorderManager.start({duration:30}),this.gameRecorderManager.on("start",this.onGameRecordStart.bind(this)),this.gameRecorderManager.on("error",this.onGameRecordError.bind(this)),this.gameRecorderManager.on("stop",this.onGameRecordStop.bind(this));let t=this;this.env.onShow(e=>{lplatform.plog("startRecord this.env.onShow"),t.resumeRecord()}),this.env.onHide(()=>{lplatform.plog("startRecord this.env.onHide"),t.pauseRecord()})}onGameRecordStart(){this.gameRecordStartTime=Date.now(),this.recordStartCb&&(this.recordStartCb(),this.recordStartCb=null)}onGameRecordError(e){lplatform.plog("onGameRecordError:"+JSON.stringify(e),"error")}onGameRecordStop(e){lplatform.plog("onGameRecordStop this.recordStopCb:"+this.recordStopCb),this.gameRecordStopTime=Date.now(),this.gameRecordStopTime-this.gameRecordStartTime>4500?this.videoPath="res.videoPath":lplatform.plog("onGameRecordStop 实际录屏时间少于5秒就有可能分享失败"),this.recordStopCb&&(this.recordStopCb(this.videoPath),this.recordStopCb=null)}pauseRecord(){this.gameRecorderManager.pause()}resumeRecord(){this.gameRecorderManager.resume()}stopRecord(e){this.canRecord()&&(lplatform.plog("stopRecord cb:"+e),this.recordStopCb=e,this.gameRecorderManager.stop())}shareRecord(e,t){this.gameRecorderManager.publishVideo({callback:a=>{null!=a&&null!=a?(console.log("分享录屏失败: "+JSON.stringify(a)),t&&t()):(console.log("分享录屏成功"),e&&e())}})}resetRecord(){this.stopRecord(),this.videoPath=null}shareInnerRecord(e,t){}makeShareUI(e,t,a,i=0,o=!1){this.canRecord()?lplatform.uiEngine.CreateShareK(function(){this.shareRecord(e,t)}.bind(this),function(){t&&t()}.bind(this),a,i,o):t&&t()}loadBanner(e){}onBannerLoad(){}onBannerError(e,t){}onBannerResize(e){}showBanner(){}hideBanner(e=!1){}loadInterstitial(e){this.hideInterstitial(),console.log("KS loadInterstitial:"+lplatform.cparam.interstitialID),this.insterstitialAd=this.env.createInterstitialAd({adUnitId:lplatform.cparam.interstitialID}),this.insterstitialAd.onError(this.onInterstitialError.bind(this)),this.insterstitialAd.onClose(this.onInterstitialClose.bind(this)),e&&this.insterstitialAd&&(console.log("KS insterstitialAd show"),this.insterstitialAd.show().catch(e=>{console.log("KS insterstitialAd show error:"+JSON.stringify(e))}))}onInterstitialLoad(){}onInterstitialError(e,t){lplatform.plog("onInterstitialError code:"+JSON.stringify(e)+" msg:"+t)}onInterstitialClose(){this.loadInterstitial(!1)}showInterstitial(){this.loadInterstitial(!0)}hideInterstitial(){this.insterstitialAd&&(this.insterstitialAd.offError(this.onInterstitialError),this.insterstitialAd.offClose(this.onInterstitialClose),this.insterstitialAd.destroy(),this.insterstitialAd=null)}createMoreGameBanner(){}createMoreGamePortal(e=!1,t=!1){}goToGameOrGameList(e){this.createMoreGamePortal()}analytics(e,t){}httpRequest(e,t,a,i,o,n,r){this.env.request({url:e,data:o,header:n,timeout:a,method:i,dataType:r,success(e){t(null,e.data,e.data)},fail(e){t(e,null,null)}})}}class y extends g{constructor(){super()}init(){this.env=window.h5api}initAD(){this.createRewardedVideo(!1)}loadBanner(e){}showBanner(){}hideBanner(){}loadInterstitial(e){}showInterstitial(){}hideInterstitial(){}createRewardedVideo(e){}loadRewardedVideo(e){}showRewardedVideo(e){this.env.canPlayAd(function(t){console.log("是否可播放广告",t.canPlayAd,"剩余次数",t.remain),t.canPlayAd,this.env.playAd(function(t){console.log("代码:"+t.code+",消息:"+t.message),1e4===t.code||(10001===t.code?e&&e(!0):console.log("广告异常"))})}.bind(this))}hideRewardedVideo(){}shareAppMessage(e){}makeShareUI(e,t,a,i=0,o=!1){t&&t()}analytics(e,t){}httpRequest(e,t,a,i,o,n,r){t&&t("h54399不允许外网连接",null,null)}}class b extends r{constructor(){super()}init(){this.env=uc}initAD(){}loadBanner(e){if(!this.bannerAd){let t={style:{width:lplatform.cparam.bannerWidth,height:lplatform.cparam.bannerHeight,gravity:7}};this.bannerAd=uc.createBannerAd(t),this.bannerAd.onLoad(function(){}.bind(this)),this.bannerAd.onError(function(){}.bind(this)),e&&this.bannerAd.show()}}showBanner(){this.hideBanner(),this.bannerAd?this.bannerAd.show():this.loadBanner(!0)}hideBanner(){this.bannerAd&&(this.bannerAd.destroy(),this.bannerAd=null)}hideInterstitial(){}createRewardedVideo(e){lplatform.cparam.rewardedVideoID&&(this.rewardedVideoAd||"function"!=typeof this.env.createRewardedVideoAd||(this.rewardedVideoAd=this.env.createRewardedVideoAd({adUnitId:lplatform.cparam.rewardedVideoID}),this.rewardedVideoAd.onError(this.onRewardedVideoError.bind(this)),this.rewardedVideoAd.onClose(this.onRewardedVideoClose.bind(this)),this.rewardedVideoAd.onLoad(this.onRewardedVideoLoad.bind(this))),e&&this.showRewardedVideo(window.vcb))}loadRewardedVideo(e){this.createRewardedVideo(e),lplatform.plog("loadRewardedVideo this.rewardedVideoAd.load()")}onRewardedVideoLoad(){lplatform.plog("onRewardedVideoLoad this.rewardedVideoIAutoShow:"+this.rewardedVideoIAutoShow)}onRewardedVideoError(e,t){lplatform.plog("onRewardedVideoError code:"+JSON.stringify(e)+" msg:"+t),this.resetRewardedVideo()}onRewardedVideoClose(e){if(lplatform.plog("onRewardedVideoClose res.isEnded:"+e.isEnded),e.isEnded)lplatform.plog("onRewardedVideoClose window.vcb:"+window.vcb),window.vcb&&window.vcb(e.isEnded),this.resetRewardedVideo(!1,!0),this.loadRewardedVideo(!1);else if(lplatform.labData.openSecondTipVideo){let e=this;e.env.showModal({title:"继续吗",content:"观看完视频才能获得奖励哦",success(t){t.confirm?e.showRewardedVideo(window.vcb):t.cancel&&(window.vcb&&window.vcb(t.isEnded),this.resetRewardedVideo(!1,!0),this.loadRewardedVideo(!1))}})}}showRewardedVideo(e){let t=this;lplatform.plog("showRewardedVideo vcb:"+e),e&&(window.vcb=e),this.rewardedVideoAd?(this.showLoading(),this.rewardedVideoLoadTimeout=setTimeout(function(){lplatform.plog("rewardedVideoLoadTimeout 广告超时 timeMax:"+this.rewardedVideoTimeMax),clearTimeout(this.rewardedVideoLoadTimeout),window.vcb&&window.vcb(!1,"广告超时"),this.resetRewardedVideo(!0,!0)}.bind(this),this.rewardedVideoTimeMax),lplatform.plog("showRewardedVideo this.rewardedVideoIsLoaded:"+this.rewardedVideoIsLoaded),this.rewardedVideoAd.show().then(()=>{lplatform.plog("showRewardedVideo then "),t.hideLoading(),clearTimeout(t.rewardedVideoLoadTimeout)}).catch(e=>{lplatform.plog("showRewardedVideo catch:"+JSON.stringify(e)),t.hideLoading(),clearTimeout(t.rewardedVideoLoadTimeout),t.rewardedVideoAd.load().then(()=>{t.rewardedVideoAd.show()}).catch(()=>{t.loadRewardedVideo(!1)})})):this.createRewardedVideo(!0)}resetRewardedVideo(e=!1,t=!1){this.rewardedVideoAd&&e&&(this.rewardedVideoAd.offLoad(this.onRewardedVideoLoad),this.rewardedVideoAd.offError(this.onRewardedVideoError),this.rewardedVideoAd.offClose(this.onRewardedVideoClose),this.rewardedVideoAd=null),t&&(window.vcb=null),this.rewardedVideoLoadTimeout&&clearTimeout(this.rewardedVideoLoadTimeout),this.hideLoading()}shareAppMessage(e){}makeShareUI(e,t,a,i=0,o=!1){t&&t()}analytics(e,t){}showFavoriteGuide(){}canRecord(){return!1}canShareRecord(){return!1}startRecord(e){}pauseRecord(){}resumeRecord(){}stopRecord(e){}shareRecord(e,t){t&&t()}resetRecord(){}}window.nativeChannel="",window.fuckyou="",window.CHANNEL={web:"web",oppo:"Oppo",vivo:"vivoGame",tt:"TT",android:"Android",iOS:"iOS",qq:"qq"};class S{constructor(){this.channel="web",this.engine="egret",this.label=null,this.area=null,this.platform=new n,this.wx=null,this.systemInfo={appName:"Platform.systemInfo default",windowWidth:720,windowHeight:1280,platform:window.cc?"creator":window.Laya||window.laya?"laya":"none"},this.llaburl=null,this.myLocation=null,this.params=o,this.cparam=o.web,this.labData={},this.initChannelTimeout=null,window.lplatform=this,lplatform.plog("plog open"),this.checkEngine(),this.checkChannel(),this.initChannel(),this.getArea(),this.gameStartMS=Date.now(),this.adSecondMax=90,this.adSecondNow=this.adSecondMax,this.outRewardVideoCb=null,this.resetInterstitialPer60Second()}checkSystemInfoAndAppName(e){this.wx=e,this.wx&&"function"==typeof this.wx.getSystemInfoSync&&(this.systemInfo=this.wx.getSystemInfoSync())}checkEngine(){window.cc&&window.cc.director?(this.engine="cc",this.uiEngine=new s):(window.Laya||window.laya)&&(this.engine="laya",this.uiEngine=new l)}checkChannel(){if(window.tt)this.checkSystemInfoAndAppName(window.tt),this.channel="TT",this.cparam=o.tt;else if(window.qg){this.checkSystemInfoAndAppName(window.qg);let e=this.wx.getSystemInfoSync().brand;e&&(e=e.toLowerCase(),this.channel="Oppo",this.cparam=o.oppo,e.indexOf("oppo")>=0||e.indexOf("OPPO")>=0||e.indexOf("Oppo")>=0||e.indexOf("REALME")>=0||e.indexOf("Realme")>=0?(this.channel="Oppo",this.cparam=o.oppo):e.indexOf("vivo")>=0||e.indexOf("Vivo")>=0||e.indexOf("VIVO")>=0||e.indexOf("iqoo")>=0||e.indexOf("IQOO")>=0?(this.channel="vivoGame",this.cparam=o.vivo):(e.indexOf("huawei")>=0||e.indexOf("honor")>=0||e.indexOf("Huawei")>=0||e.indexOf("HuaWei")>=0||e.indexOf("HONOR")>=0)&&(this.channel="huaWei",this.cparam=o.huawei))}else window.swan?(this.checkSystemInfoAndAppName(window.swan),this.channel="BaiDu",this.cparam=o.baidu):window.qq?(this.checkSystemInfoAndAppName(window.qq),this.channel="qq",this.cparam=o.qq):window.hasOwnProperty("gamebox")?(this.checkSystemInfoAndAppName(window.gamebox),this.channel="gb4399",this.cparam=o.gb4399):window.h5api?(this.checkSystemInfoAndAppName(window.h5api),this.channel="h54399",this.cparam=o.h54399):window.ks||window.kwaigame?(this.checkSystemInfoAndAppName(window.ks),this.channel="ks",this.cparam=o.ks):"undefined"!=typeof uc?(this.checkSystemInfoAndAppName(uc),this.channel="uc",this.cparam=o.uc):window.wx?(this.checkSystemInfoAndAppName(window.wx),this.channel="wx",this.cparam=o.wx):"cc"==this.engine?CC_JSB&&jsb.reflection&&(cc.sys.os==cc.sys.OS_ANDROID?(this.channel="Android",this.cparam=o.native):cc.sys.os==cc.sys.OS_IOS&&(this.channel="iOS",this.cparam=o.native)):"laya"==this.engine&&(Laya.Browser.onAndroid?(this.channel="Android",this.cparam=o.native):Laya.Browser.onIOS&&(this.channel="iOS",this.cparam=o.native));"web"==this.channel&&(window.android?(this.channel="Android",this.cparam=o.native):window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.jsToOcWithPrams&&window.webkit.messageHandlers.jsToOcWithPrams.postMessage&&(window.ios={},this.channel="iOS",this.cparam=o.native)),lplatform.plog("checkChannel:"+this.channel)}initChannel(){this.platform&&(this.platform.release(),this.platform=null),"TT"==this.channel?this.platform=new r:"gb4399"==this.channel?this.platform=new g:"h54399"==this.channel?this.platform=new y:"ks"==this.channel?this.platform=new w:"wx"==this.channel?this.platform=new h:"qq"==this.channel?this.platform=new d:"BaiDu"==this.channel?this.platform=new c:"Oppo"==this.channel?this.platform=new m:"vivoGame"==this.channel?this.platform=new p:"huaWei"==this.channel?this.platform=new u:"uc"==this.channel?this.platform=new b:"web"==this.channel?this.platform=new n:"cc"==this.engine?CC_JSB&&jsb.reflection?cc.sys.os==cc.sys.OS_ANDROID?this.platform=new f:cc.sys.os==cc.sys.OS_IOS&&(this.platform=new f):(console.log("cocos web内嵌"),this.platform=new f):"laya"==this.engine&&(Laya.Browser.onAndroid?this.platform=new f:Laya.Browser.onIOS?this.platform=new f:(console.log("使用laya web内嵌"),this.platform=new f))}getArea(){""!=this.params.locationUrl&&(lplatform.plog("getArea "+this.params.locationUrl),this.httpRequest(this.params.locationUrl,function(e,t,a){if(e)lplatform.plog("getArea res:"+e);else{let e=JSON.parse(a);e&&(this.myLocation=e.cityCode+","+e.proCode),lplatform.plog("getArea this.myLocation:"+this.myLocation)}this.getLabel()}.bind(this)))}getLabel(){let e=o.llabHost+o.llabName+"/lab"+this.channel+nativeChannel+this.cparam.llabVer+".json";lplatform.plog("getLabel llaburl:"+e),this.httpRequest(e,function(e,t,a){if(e)lplatform.plog("getLabel error:"+JSON.stringify(e));else{lplatform.plog("getLabel resText:"+a);let e=JSON.parse(a);this.labData=e||{},lplatform.plog("getLabel this.labData:"+JSON.stringify(this.labData))}this.initChannelTimeout&&clearTimeout(this.initChannelTimeout),this.startLabWhenGet(),this.platform.initAD(),this.labData.mainSwitch,this.ipReg()}.bind(this))}setLabDataToCParam(){if(this.labData)for(let e in this.labData)void 0!==lplatform.cparam[e]&&this.labData[e]&&(lplatform.cparam[e]=this.labData[e])}startLabWhenGet(){if(this.setLabDataToCParam(),this.labData){let e=this.labData.alwaysOn,t=!1;if(this.labData.locationList||this.labData.province){this.labData.locationList=this.labData.province;for(let e=0;e<this.labData.locationList.length;e++)if(this.myLocation&&this.myLocation.indexOf(this.labData.locationList[e])>=0){t=!0;break}}t&&(this.labData={});let a=new Date,i=a.getHours(),o=a.getMinutes();if(this.labData.time){let e=!1;for(let t in this.labData.time){let a=this.labData.time[t][0].split(":"),n=this.labData.time[t][1].split(":");if(i>=a[0]&&i<n[0]&&o>=a[1]){e=!0;break}if(i>=a[0]&&i==n[0]&&o>=a[1]&&o<n[1]){e=!0;break}}e||(this.labData={})}if(this.labData.mainSwitch||(this.labData={}),this.labData.openSceneValues&&this.platform.checkOpenSceneValue&&!this.platform.checkOpenSceneValue()&&(this.labData={},console.log("checkOpenSceneValue set labData = {}")),this.labData.lockLocation)t&&this.startLabWhenGet();else{this.labData.openIntervalBanner&&setInterval(function(){this.showBanner()}.bind(this),1e3*this.labData.openIntervalBanner),this.labData.openIntervalInterstitial&&setInterval(function(){this.showInterstitial()}.bind(this),1e3*this.labData.openIntervalInterstitial),this.labData.openIntervalVideo&&setInterval(function(){this.showRewardedVideo()}.bind(this),1e3*this.labData.openIntervalVideo),this.labData.openScreenVideo&&("TT"==this.channel||"qq"==this.channel||"wx"==this.channel||"ks"==this.channel||"gb4399"==this.channel?this.showRewardedVideo(function(e){this.showInterstitial(),this.showBanner()}):this.showInterstitial());for(let e in this.labData)void 0!==lplatform.cparam[e]&&(this.labData[e]||0==this.labData[e])&&(lplatform.cparam[e]=this.labData[e])}this.resetTimeVideoAd(),this.resetInterstitialPer60Second(),this.labData.alwaysOn=e}lplatform.plog("Over---labData:"+JSON.stringify(this.labData))}httpRequest(e,t,a=3e3,i,o,n,r){if("function"==typeof this.platform.httpRequest)this.platform.httpRequest(e,t,a,i,o,n,r);else{let n=new XMLHttpRequest;n.timeout=a,n.onreadystatechange=function(){4==n.readyState&&(n.status>=200&&n.status<400?t(null,n.response,n.responseText):t(n.status,null,null))},n.open(i||"GET",e,!0),n.send(o)}}native2JsEvent(e){lplatform.plog("native2JsEvent str:"+e+" window.vcb:"+window.vcb),"playADSuccess"==e?(window.vcb&&(window.vcb(!0),window.vcb=null),lplatform.resumeGame()):"playADFailed"==e&&(window.vcb&&(window.vcb(!1),window.vcb=null),lplatform.resumeGame())}js2NativeEvent(e){let t=!0;return window.android?window.android.js2NativeEvent(e):window.ios?window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.jsToOcWithPrams&&window.webkit.messageHandlers.jsToOcWithPrams.postMessage?window.webkit.messageHandlers.jsToOcWithPrams.postMessage({params:e}):console.error(this.engine+"ios微端 未实现webkit.messageHandlers以外，其他的js-原生通信方式"):"cc"==this.engine?CC_JSB&&jsb.reflection?cc.sys.os==cc.sys.OS_ANDROID?jsb.reflection.callStaticMethod("org/cocos2dx/javascript/Jsni","js2JavaEvent","(Ljava/lang/String;)V",e):cc.sys.os==cc.sys.OS_IOS&&jsb.reflection.callStaticMethod("Jsni","js2OcEvent:",e):t=!1:"laya"==this.engine?window.webkit&&window.webkit.messageHandlers&&window.webkit.messageHandlers.jsToOcWithPrams&&window.webkit.messageHandlers.jsToOcWithPrams.postMessage?window.webkit.messageHandlers.jsToOcWithPrams.postMessage({params:e}):console.error(this.engine+" 未实现webkit.messageHandlers以外，其他的js-原生通信方式"):console.error(this.engine+" 未实现js2NativeEvent"),t}pauseGame(){window.cc?cc.audioEngine.pauseAll():window.Laya&&(Laya.SoundManager.setMusicVolume(0),Laya.SoundManager.setSoundVolume(0))}resumeGame(){window.cc?cc.audioEngine.resumeAll():window.Laya&&(Laya.SoundManager.setMusicVolume(1),Laya.SoundManager.setSoundVolume(1))}analytics(e,t){if(this.platform.analytics(e,t),"cc"==this.engine&&CC_JSB){let a={name:e,data:t};this.js2NativeEvent(JSON.stringify(a))}}showFavoriteGuide(){this.platform.showFavoriteGuide()}showBanner(){this.platform.showBanner()}showDelayBanner(e){return e=e||2e3,setTimeout(function(){this.showBanner()}.bind(this),e)}hideBanner(){this.platform.hideBanner()}showInterstitial(){this.resetInterstitialPer60Second(),this.platform.showInterstitial()}showDelayInterstitial(e){return e=e||2e3,setTimeout(function(){this.showInterstitial()}.bind(this),e)}showInterstitialPer60Second(){this.canShowInterstitial60Second&&this.showInterstitial()}showDelayInterstitialPer60Second(e){return this.canShowInterstitial60Second?this.showDelayInterstitial(e):null}resetInterstitialPer60Second(e=10){this.labData.interstitial90RealTime&&(e=this.labData.interstitial90RealTime),this.canShowInterstitial60Second=!1,this.interstitial60Timeout&&(clearTimeout(this.interstitial60Timeout),this.interstitial60Timeout=null),this.interstitial60Timeout=setTimeout(()=>{this.canShowInterstitial60Second=!0},1e3*e)}hideInterstitial(){this.platform.hideInterstitial()}showRanRewardedVideo(e){if(this.outRewardVideoCb=e,console.log("mainSwitch:",this.labData.mainSwitch,"playVideo:",this.labData.playVideo),this.labData.mainSwitch&&null!=this.labData.playVideo){let t=Math.random();console.log("rand:",t),t<=this.labData.playVideo?this.showRewardedVideo(e):this.pRewradVideoCb(!0)}else this.showRewardedVideo(e)}showRewardedVideo(e){this.outRewardVideoCb=e,this.platform.showRewardedVideo(this.pRewradVideoCb.bind(this))}hideRewardedVideo(){this.platform.hideRewardedVideo()}createMoreGamePortal(){this.platform.createMoreGamePortal()}createMoreGameBanner(){this.platform.createMoreGameBanner()}canRecord(){return this.platform.canRecord()}canShareRecord(){return this.platform.canShareRecord()}makeShareUI(e,t,a,i=0,o=!1){this.platform.makeShareUI(e,t,a,i,o)}startRecord(e){this.platform.startRecord(e)}pauseRecord(){this.platform.pauseRecord()}stopRecord(e){this.platform.stopRecord(e)}shareRecord(e,t){this.platform.shareRecord(e,t)}resetRecord(){this.platform.resetRecord()}shareInnerRecord(e,t){this.platform.shareInnerRecord(e,t)}createMoreGameButton(){this.platform.createMoreGameButton()}goToGameOrGameList(e){this.platform.goToGameOrGameList(e)}followAccount(){this.platform.followAccount()}openAwemeUserProfile(){this.platform.openAwemeUserProfile()}createGameClub(){this.platform.createGameClub()}navigateToMiniProgram(e){this.platform.navigateToMiniProgram(e)}shareMessageToFriend(e){this.platform.shareMessageToFriend()}sendMsgToOpenDataProject(e){this.platform.sendMsgToOpenDataProject(e)}plog(...e){this.cparam.showLog&&console.log(...e)}showLoading(e){this.platform.showLoading(e)}hideLoading(){this.platform.hideLoading()}pRewradVideoCb(e){this.outRewardVideoCb&&(this.outRewardVideoCb(e),this.outRewardVideoCb=null),this.resetTimeVideoAd()}timeVideoAd(e){let t=!1;return this.adSecondMax=lplatform.labData.interstitial90RealTime||this.adSecondMax,console.log("timeVideoAd adSecondNow:"+this.adSecondNow+" this.adSecondMax:"+this.adSecondMax),lplatform.labData.interstitial90RealTime&&0==this.adSecondNow?(this.resetTimeVideoAd(),"iOS"==lplatform.channel||lplatform.channel,lplatform.showRewardedVideo(e||function(){}.bind(this)),t=!0,lplatform.analytics("timeVideoAd",{})):e&&e(!1),t}resetTimeVideoAd(){this.adSecondMax=lplatform.labData.interstitial90RealTime||this.adSecondMax,console.log("resetTimeVideoAd adSecondMax:"+this.adSecondMax),this.adSecondNow=this.adSecondMax,this.adTimeout&&clearTimeout(this.adTimeout),this.adTimeout=setTimeout(function(){this.adSecondNow=0}.bind(this),1e3*this.adSecondMax)}showRandVideo(e,t){if(this.labData.playVideo){Math.random()<=this.labData.playVideo?this.showRewardedVideo(function(a){a?e&&e():t&&t()}):t&&t()}else t&&t()}ipReg(){if(this.labData.getIP){window.wx&&wx.request({url:"https://lab.bwyxa.com/api/userinfo",data:{},header:{"content-type":"application/json"},success(e){},fail(e){}})}}}class v extends Laya.Script3D{constructor(){super(),this.target=null,this.defDistance=null,this.followX=!1,this.followY=!1,this.followZ=!0,this.followRotationX=!1,this.followRotationY=!1,this.followRotationZ=!1,this.defTagYawPitchRoll=null,this.defTagPos=null,this.defPos=null}onAwake(){this.defTagYawPitchRoll=new Laya.Vector3,this.defYawPitchRoll=new Laya.Vector3,this.yawPitchRoll=new Laya.Vector3,this.owner.transform.localRotation.getYawPitchRoll(this.yawPitchRoll)}setYawPitchRollOffset(e=0,t=0,a=0){this.owner.transform.localRotation.getYawPitchRoll(this.yawPitchRoll),this.yawPitchRoll.x+=e,this.yawPitchRoll.y+=t,this.yawPitchRoll.z+=a;let i=new Laya.Quaternion;Laya.Quaternion.createFromYawPitchRoll(this.yawPitchRoll.x,this.yawPitchRoll.y,this.yawPitchRoll.z,i),this.owner.transform.rotation=i}follow(e,t=!1,a=!0,i=!0,o=!0,n=!1,r=!1,s=!1){e&&(this.followX=a,this.followY=i,this.followZ=o,this.followRotationX=n,this.followRotationY=r,this.followRotationZ=s,this.target=e,this.defTagPos=this.target.transform.position.clone(),this.defPos=this.owner.transform.position.clone(),this.defDistance=new Laya.Vector3(0,0,0),Laya.Vector3.subtract(this.target.transform.position,this.defPos,this.defDistance),this.distanceMax=new Laya.Vector3(0,0,0),Laya.Vector3.scale(this.defDistance,1.2,this.distanceMax),this.target.transform.rotation.getYawPitchRoll(this.defTagYawPitchRoll),this.owner.transform.localRotation.getYawPitchRoll(this.defYawPitchRoll)),this.needLookat=t}unfollow(e){this.target!=e&&e||(this.target=null)}setFollow(e,t,a){this.followX=e,this.followY=t,this.followZ=a}onUpdate(){if(this.target&&this.target.transform){let e=new Laya.Vector3(0,0,0);Laya.Vector3.subtract(this.target.transform.position,this.defDistance,e),e.x=this.followX?e.x:this.owner.transform.position.x,e.y=this.followY?e.y:this.owner.transform.position.y,e.z=this.followZ?e.z:this.owner.transform.position.z;let t=new Laya.Vector3(0,0,0);Laya.Vector3.lerp(this.owner.transform.position,e,.3,t),this.owner.transform.position=t,this.needLookat&&this.owner.transform.lookAt(this.target.transform.position,new Laya.Vector3(0,1,0))}}mouseDown(e){}mouseUp(e){}}class L extends Laya.Script3D{constructor(){super()}onDestroy(){super.onDestroy(),this.kinematicTimeout&&clearTimeout(this.kinematicTimeout)}onAwake(){this.needCount=20,this.needCount=Number(this.owner.getChildByName("chainTrigger").getChildAt(0).name),this.enterdBall=[];let e=this.owner.getChildByName("chains");for(let t=0;t<e.numChildren;t++){let a=e.getChildAt(t).getComponent(Laya.Rigidbody3D);a.collisionGroup=Laya.Physics3DUtils.COLLISIONFILTERGROUP_CUSTOMFILTER3,a.canCollideWith=Laya.Physics3DUtils.COLLISIONFILTERGROUP_CUSTOMFILTER2}this.kinematicTimeout=setTimeout(()=>{e.getChildAt(0).getComponent(Laya.Rigidbody3D).isKinematic=!0,e.getChildAt(e.numChildren-1).getComponent(Laya.Rigidbody3D).isKinematic=!0},33.4),this.matOffsets={0:0,1:.07142857,2:.1428571,3:.2142857,4:.2857143,5:.3571429,6:.4285714,7:.5,8:.5714286,9:.6428571,"+":.7142857,"/":.7857143,"+":.8571429,"-":.9285714},this.setText(this.enterdBall.length+"-"+this.needCount)}onEnable(){}onDisable(){}setText(e){let t=this.owner.getChildByName("Text");for(let e=0;e<t.numChildren;e++){t.getChildAt(e).active=!1}for(let a=0;a<e.length;a++){let i=t.getChildAt(a),o=i._render.material.clone();o.tilingOffset.z=this.matOffsets[e[a]],o.tilingOffset=o.tilingOffset,i._render.material=o,i.active=!0}}onUpdate(){this.setText(this.enterdBall.length+"-"+this.needCount),this.enterdBall.length>=this.needCount&&this.owner.destroy()}}class I extends Laya.Script3D{constructor(){super(),this.symbol="",this.multi=1,this.matOffsetStep=1/14,this.matOffsets={0:0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:0,9:0,x:0,"/":0,"+":0,"-":0};let e=0;for(let t in this.matOffsets)this.matOffsets[t]=this.matOffsetStep*e,e++;this.colors={"+":"#0C11BF","-":"#BF0A0F",x:"#0066BF","/":"#BF0A0F"},this.nowCount=this.multi}onDestroy(){super.onDestroy()}onAwake(){this.moveStart=lloading.sampleScene.getChildByName("moveStart"),this.moveEnd=lloading.sampleScene.getChildByName("moveEnd"),this.moveStart&&this.moveEnd&&(this.owner.removeChild(this.moveStart),this.owner.removeChild(this.moveEnd),this.owner.parent.parent.addChild(this.moveStart),this.owner.parent.parent.addChild(this.moveEnd),this.owner.transform.position=this.moveStart.transform.position),this.defSpeed=2.5,this.speed=this.defSpeed,this.dir=1,this.setMulti(),this.setColor()}onEnable(){}onDisable(){}multiSubtract(e){this.multi-=e,this.multi<=0?this.owner.destroy():(this.owner.name=this.symbol+this.multi,this.setMulti())}setMulti(e){e=e||this.owner.name,this.symbol=e[0],this.multi=Number(e.substring(1)),this.nowCount=this.multi;let t=this.owner.getChildByName("Text"),a=t.getChildAt(0),i=a._render.material.clone(),o=t.getChildAt(1),n=o._render.material.clone(),r=t.getChildAt(2),s=r._render.material.clone();3==e.length?(i.tilingOffset.z=this.matOffsets[e[0]],i.tilingOffset=i.tilingOffset,n.tilingOffset.z=this.matOffsets[e[1]],n.tilingOffset=n.tilingOffset,s.tilingOffset.z=this.matOffsets[e[2]],s.tilingOffset=s.tilingOffset):(i.tilingOffset.z=this.matOffsets[e[0]],i.tilingOffset=i.tilingOffset,o.active=!1,s.tilingOffset.z=this.matOffsets[e[1]],s.tilingOffset=s.tilingOffset),a._render.material=i,o._render.material=n,r._render.material=s;let l=this.owner.getChildByName("Visual"),h=this.HexToRgb(this.colors[e[0]]),d=l._render.material.emissionColor;for(let e=0;e<h.length;e++)h[e]=h[e]*this.multi%255;d.x=h[0]/255*2.5,d.y=h[1]/255*2.5,d.z=h[2]/255*2.5,l._render.material.emissionColor=l._render.material.emissionColor}setColor(e){new Laya.Vector4(0,0,0,0)}HexToRgb(e){if(!/^\#?[0-9A-F]{6}$/.test(e))return window.alert("输入错误的hex");for(var t=(e=e.replace("#","")).match(/../g),a=0;a<3;a++)t[a]=parseInt(t[a],16);return t}onUpdate(){if(this.moveStart&&this.moveEnd){let e=Laya.timer.delta/1e3,t=this.owner.transform.position,a=Math.round(Math.abs(this.moveEnd.transform.position.x-this.moveStart.transform.position.x)/(this.moveEnd.transform.position.x-this.moveStart.transform.position.x));t.x+=this.speed*this.dir*a*e,1==this.dir&&Math.abs(t.x-this.moveEnd.transform.position.x)<this.speed*e?(this.dir=-1,t.x=this.moveEnd.transform.position.x):-1==this.dir&&Math.abs(t.x-this.moveStart.transform.position.x)<this.speed*e&&(this.dir=1,t.x=this.moveStart.transform.position.x),this.owner.transform.position=t}}onCollisionEnter(e){}onCollisionStay(e){}onCollisionExit(e){}onTriggerEnter(e){}}class A extends Laya.Script3D{constructor(){super(),this.reset()}reset(){this.triggeredNode||(this.triggeredNode=[]),this.type=0,this.skin=0,this.color="",this.canDestroy=!1,this.scored=!1,this.score=a.ballDefScore}onDestroy(){super.onDestroy()}onAwake(){this.rbody=this.owner.getComponent(Laya.Rigidbody3D),this.rbody.collisionGroup=Laya.Physics3DUtils.COLLISIONFILTERGROUP_CUSTOMFILTER2}onEnable(){}onDisable(){}onUpdate(){}copySelf(e,t=!1){if(!t&&this.owner.parent.numChildren>=a.ballCountMax)this.score=this.score*a.ballDefScore*e;else for(let t=0;t<e;t++){let e=game.getBallFromPool(this.type,void 0);e.active=!0,e.transform.position=this.owner.transform.position;let t=e.getComponent(A);game.sballs.push(t),t.reset(),t.setType(this.type);for(let e=0;e<this.triggeredNode.length;e++)t.triggeredNode.push(this.triggeredNode[e]);this.owner.parent.addChild(e)}}setType(e){this.type=e}setSkin(e){this.skin=e}setColor(e){this.color=e}isInRotateContainer(){let e=!1,t=[],a=this.owner.transform.position.clone(),i=new Laya.Vector3(a.x,a.y,a.z+100);game.owner.physicsSimulation.raycastAllFromTo(a,i,t);for(let a=0;a<t.length;a++)if("backWall"===t[a].collider.owner.name||"CPlane"===t[a].collider.owner.name||"trangle"===t[a].collider.owner.name){e=!0;break}return e}setJoint(e){}onCollisionEnter(e){}onCollisionStay(e){}onCollisionExit(e){0==e.other.owner.name.indexOf("rr0")&&(this.rbody.linearVelocity=new Laya.Vector3(0,0,0))}onTriggerEnter(e){if(0==e.owner.name.indexOf("Visual")){if(this.triggeredNode.indexOf(e.owner)<0){this.triggeredNode.push(e.owner);let t=e.owner.parent.getComponent(I),i=t.multi;"+"===t.symbol||("-"===t.symbol?(t.multiSubtract(1),game.putBallToPool(this.owner)):"x"===t.symbol?this.copySelf(i):"/"===t.symbol&&(t.nowCount<=1?t.nowCount=t.multi:(t.nowCount--,game.putBallToPool(this.owner)))),a.playSound("sound/MediumBall.mp3",1)}}else if(0==e.owner.name.indexOf("DestroyTrigger"))this.canDestroy=!0;else if(0==e.owner.name.indexOf("chainTrigger")){e.owner.parent.getComponent(L).enterdBall.push(this.owner)}}onTriggerExit(e){if(!this.scored&&(0==e.owner.name.indexOf("FillTrigger")&&(this.scored=!0,game.addScore(this.score)),0==e.owner.name.indexOf("chainTrigger"))){e.owner.parent.getComponent(L).enterdBall.pop(this.owner)}}onTriggerStay(){}}class R extends i{constructor(){super(),this.touchDowning=!1,this.lastMouseX=0,this.lastMouseY=0,this.dragDir=0,this.lvScore=0}onDestroy(){super.onDestroy()}onAwake(){super.onAwake(),window.game=this,this.owner.physicsSimulation.continuousCollisionDetection=1,this.ballPrefabRoot=lloading.pbScene.getChildByName("ballPrefab"),this.ballPrefabs=[];let t=this.ballPrefabRoot._children;for(let e=0;e<t.length;e++){this.ballPrefabs[e]=[];let a=t[e]._children;for(let t=0;t<a.length;t++)this.ballPrefabs[e].push(a[t])}for(let e=0;e<this.ballPrefabs.length;e++)for(let t=0;t<this.ballPrefabs[e].length;t++)if(!this.ballPrefabs[e][t].getComponent(A)){this.ballPrefabs[e][t].addComponent(A);let a=this.ballPrefabs[e][t].getComponent(Laya.Rigidbody3D);a.friction=.1,a.angularDamping=.5,a.linearDamping=0}this.ballRoot=this.owner.getChildByName("balls"),this.guide1=lloading.getChildByUrl_L("mc/Guides/Guide1",this.owner),this.FillTrigger=lloading.getChildByUrl_L("mc/Bucket/FillTrigger",this.owner),this.ElegantSparks=lloading.getChildByUrl_L("mc/Bucket/ElegantSparks",this.owner),this.cameraFollowScript=this.mcamera.addComponent(v),this.maxYBall=null,this.needScroll=!1,this.stand=lloading.getChildByUrl_L("mc/Stand/2dscorepos",this.owner),this.panelBg=this.owner.getChildByName("bg"),this.sballs=[],this.loadLevel(e.level)}onEnable(){}onDisable(){}loadLevel(t){window.lplatform&&"ios"==window.lplatform.systemInfo.platform&&(a.ballCountMax=5),t=t||e.level;let i=a.lvCfg[t].shape,o=a.lvCfg[t].name,n=lloading.getChildByUrl_L(i+"/"+o,lloading.pbScene);n.transform.position=new Laya.Vector3(0,0,0),this.ccc=Laya.Sprite3D.instantiate(n);let r=[];this.bianLiGet(this.ccc,"rr0",r);for(let e=0;e<r.length;e++){let t=r[e].getComponent(Laya.Rigidbody3D);t&&(t.collisionGroup=Laya.Physics3DUtils.COLLISIONFILTERGROUP_CUSTOMFILTER4,t.canCollideWith=Laya.Physics3DUtils.COLLISIONFILTERGROUP_CUSTOMFILTER2)}this.ccc.transform.position=new Laya.Vector3(0,0,0),this.owner.addChild(this.ccc),this.cccs=this.ccc.getChildByName("cccs"),this.ballBornNode=this.ccc.getChildByName("ballBornNode");let s=lloading.getChildByUrl_L("Multiplicators",this.ccc);if(s)for(let e=0;e<s.numChildren;e++){s.getChildAt(e).addComponent(I)}this.rotatedccc=this.ccc,this.mcamera.transform.position.y=this.ballBornNode.transform.position.y,this.mcamera.transform.position.y<0&&(this.mcamera.transform.position.y=0),this.mcamera.transform.position=this.mcamera.transform.position;var l=new Laya.Vector3;this.mcamera.viewport.project(this.ccc.transform.position,this.mcamera.projectionViewMatrix,l);var h=new Laya.Vector3;h.x=l.x/Laya.stage.clientScaleX,h.y=l.y/Laya.stage.clientScaleY,console.log("spos:"+JSON.stringify(h)),this.cccsx=h.x,this.cccsy=h.y,this.initBallPool(1),setTimeout(()=>{for(let t=0;t<a.lvCfg[e.level].ballNum;t++)this.addBall(e.curBallType)},500)}bianLiGet(e,t,a){e.name.indexOf(t)>=0&&a.push(e);for(let i=0;i<e._children.length;i++)this.bianLiGet(e._children[i],t,a)}reAddBall(){if(this.sballs&&this.sballs.length>0)for(let e=0;e<this.sballs.length;e++)this.putBallToPool(this.sballs[e].owner),e--;this.sballs=[];for(let t=0;t<a.lvCfg[e.level].ballNum;t++)this.addBall(e.curBallType)}initBallPool(e){this.ballPool=[];for(let t=0;t<this.ballPrefabs.length;t++){this.ballPool[t]=[];for(let a=0;a<this.ballPrefabs[t].length;a++){this.ballPool[t][a]=[];for(let i=0;i<e;i++){let e=this.makeBall(t,a);e.active=!1,this.ballPool[t][a].push(e)}}}}makeBall(e,t,a){let i=Laya.Sprite3D.instantiate(this.ballPrefabs[e][t]),o=i.getComponent(A);return o.setType(e),o.setSkin(t),a&&o.setColor(a),i}getBallFromPool(e,t){void 0!==t&&-1!=t||(t=Math.floor(Math.random()*this.ballPrefabs[e].length));let a=null;return this.ballPool&&this.ballPool[e]&&this.ballPool[e][t]&&this.ballPool[e][t].length>0?(a=this.ballPool[e][t][0],this.ballPool[e][t].splice(0,1)):a=this.makeBall(e,t),a}putBallToPool(e){let t=e.getComponent(A),a=this.sballs.indexOf(t);a>=0&&this.sballs.splice(a,1);let i=t.type,o=t.skin;e&&(e.parent&&e.parent.removeChild(e),!this.ballPool||!this.ballPool[i]||this.ballPool[i][o]||this.ballPool[i][o].length>100?e.destroy():(this.ballPool[i][o].push(e),e.transform.position=new Laya.Vector3(0,0,0),e.active=!1))}addBall(t,a,i,o,n){void 0===t&&(t=e.curBallType),n||(n=1),void 0!==a&&-1!=a||(a=Math.floor(Math.random()*this.ballPrefabs[t].length));for(let e=0;e<n;e++){let e=this.getBallFromPool(t,a);i&&(e.scale=i);let n=e.getComponent(A);this.sballs.push(n),n.reset(),n.setType(t),a&&n.setSkin(a),o&&n.setColor(o),this.ballRoot.addChild(e);let r=this.ballBornNode.transform.position.clone();Math.random();r.x-=.3*(.5-Math.random()),r.y-=.3*(.5-Math.random()),e.transform.position=r,e.active=!0}}addScore(e){this.lvScore+=e,this.ElegantSparks&&(this.ElegantSparks.particleSystem.isPlaying||this.ElegantSparks.particleSystem.play()),a.playSound("sound/MediumBall.mp3",1)}onMouseDown(e){if(a.gstate==a.G_STATE_RUNNING&&(this.touchDowning=!0,this.lastMouseX=Laya.stage.mouseX,this.lastMouseY=Laya.stage.mouseY,this.cccs)){let e=99999;for(let a=0;a<this.cccs.numChildren;a++){let o=this.cccs.getChildAt(a);var t=new Laya.Vector3;this.mcamera.viewport.project(o.transform.position,this.mcamera.projectionViewMatrix,t);var i=new Laya.Vector3;i.z=0,i.x=t.x/Laya.stage.clientScaleX,i.y=t.y/Laya.stage.clientScaleY;let n=Laya.Vector3.distance(i,new Laya.Vector3(Laya.stage.mouseX,Laya.stage.mouseY,0));n<=e&&(e=n,this.rotatedccc=o,this.cccsx=i.x,this.cccsy=i.y)}}}onMouseUp(e){a.gstate==a.G_STATE_RUNNING&&(this.touchDowning=!1)}onUpdate(){if(this.touchDowning){let e=Laya.stage.mouseX-this.lastMouseX,t=Laya.stage.mouseY-this.lastMouseY;if(0!=e||0!=t){let e=Laya.stage.mouseX,t=Laya.stage.mouseY,a=e-this.cccsx,i=t-this.cccsy,o=Math.sqrt(a*a+i*i),n=this.lastMouseX-this.cccsx,r=this.lastMouseY-this.cccsy,s=Math.sqrt(n*n+r*r),l=Math.acos(a/o)-Math.acos(n/s);this.dragDir=1,e>=this.cccsx&&t>=this.cccsy?this.dragDir=-1:e<=this.cccsx&&t>=this.cccsy?this.dragDir=-1:e<=this.cccsx&&t<=this.cccsy?this.dragDir=1:e>=this.cccsx&&t<=this.cccsy&&(this.dragDir=1);let h=this.rotatedccc,d=new Laya.Vector3;h.transform.rotation.getYawPitchRoll(d);let c=.035,m=-this.dragDir*l,p=(d.z,Math.abs(m)>c?c*(Math.abs(m)/m):m);h.transform.rotate(new Laya.Vector3(0,0,p))}}this.lastMouseX=Laya.stage.mouseX,this.lastMouseY=Laya.stage.mouseY,this.checkDestroy(),this.setMaxYBall();let e=this.mcamera.transform.position.clone();e.z=13.96,this.panelBg.transform.position=e}checkDestroy(){let e=!1,t=0,a=[],i=[];for(let o=0;o<this.sballs.length;o++){let n=this.sballs[o];n.scored&&(a.push(n),++t>50&&(e=!0)),n.canDestroy&&i.push(n)}if(e){for(let e=0;e<i.length;e++)this.putBallToPool(i[e].owner);a=[]}}setMaxYBall(){if(this.needScroll){let e=null,t=-9999;for(let a=0;a<this.sballs.length;a++)this.sballs[a].owner.transform.position.y>t&&(t=(e=this.sballs[a].owner).transform.position.y);e&&this.maxYBall!==e&&(this.maxYBall=e,this.cameraFollowScript.follow(this.maxYBall,!1,!1,!0,!1))}this.mcamera.transform.position.y<=0?(this.mcamera.transform.position.y=0,this.mcamera.transform.position=this.mcamera.transform.position,this.needScroll=!1,this.cameraFollowScript.follow(null)):this.needScroll=!0}}class x extends Laya.Scene{constructor(){super();this.platform=new S,a.init(),a.loadData(),this.curSceneName="",this.prevSceneName="",this.gameUI=null,this.lvScen=null,this.loadLevelEndCb=null,this.scriptLvScen=null,this.shopUI=null,this.winUI=null,this.loseUI=null,this.outlineRewardUI=null,this.itemPush=null,this.arrToasts=[],this.sampleScene=null,this.chuShiUI=null,this.chuShiS3DC=null,this.tryDownloadZipCount=0}onConfigLoaded(){if("undefined"!=typeof minigame){let e=this;minigame.initializeAsync().then(function(){console.log("FB initializeAsync"),e.startMiniGameSDK()})}}startMiniGameSDK(){"undefined"!=typeof minigame&&(minigame.setLoadingProgress(100),minigame.startGameAsync().then(function(){console.log("开始loadPBScene"),window.lloading.loadPBScene()}).catch(function(e){console.info("startGameAsync error: "+e)}))}onAwake(){Laya.timer.frameLoop(1,this,this.lupdate),window.lloading=this;let e=500;setTimeout(function(){"wx"==lplatform.channel?this.loadPBScene():"qq"==lplatform.channel?this.loadPBScene():"Oppo"==lplatform.channel||"ks"==lplatform.channel?this.loadPBScene():this.onConfigLoaded()}.bind(this),e)}onEnable(){if(this.pbar&&(this.pbar.value=0),"TT"==lplatform.channel){let e=this.getChildAt(3);e&&(e.visible=0)}}lupdate(){this.pbar&&(this.pbar.value+=Laya.timer.delta/1e3/3,this.pbar.value>1&&(this.pbar.value=1))}loadSub(e,t){let a=this;(window.ks||window.kwaigame||window.tt||window.qq||window.swan||window.wx||window.gamebox||window.qg).loadSubpackage({name:e,success:function(e){console.log("jiazaifenbao success = "+JSON.stringify(e)),t()},fail:function(e){console.log("jiazaifenbao fail"+JSON.stringify(e)),t()}}).onProgressUpdate(e=>{a.pbar&&(a.pbar.value=e.progress/100),console.log("分包下载进度百分比",e.progress),console.log("已经下载的数据长度",e.totalBytesWritten),console.log("数据总长度",e.totalBytesExpectedToWrite)})}loadArrayBao(e,t){let a=this,i=0,o=function(){++i>=e.length?t():a.loadSub(e[i],o)};a.loadSub(e[i],o)}loadOnlineZip(e){let t=this,a=window.ks||window.kwaigame||window.tt||window.qq||window.swan||window.wx||window.gamebox||window.qg;if(a&&a.getFileSystemManager&&a.downloadFile){lplatform&&lplatform.showLoading("资源载入中...");var i=a.getFileSystemManager(),o=a.env.USER_DATA_PATH+"/ziyuan/",n=o;i.access({path:n,success(t){console.log(`${n} 部分资源存放在cdn，更新版本时，记得更新cdn资源。`),Laya.URL.basePath=o,lplatform&&lplatform.hideLoading(),e(!0)},fail(r){console.log(`${n} 不存在或其他错误`,r.errMsg);a.downloadFile({url:"https://cdn.bwyxa.com/gameRes/ATMMDGS/gameresv6.zip",success:function(a){var n=a.tempFilePath;window.swan&&i.mkdirSync(o),i.unzip({zipFilePath:n,targetPath:o,success:function(t){Laya.URL.basePath=o,lplatform&&lplatform.hideLoading(),e(!0)},fail:function(a){if(console.log("index.js unzip fail",a),lplatform&&lplatform.showLoading("资源解压失败，请重启本游戏..."),t.tryDownloadZipCount++,t.tryDownloadZipCount<3){try{fileSystemManager.rmdirSync(o)}catch(e){console.log("移除解压失败的zip失败:"+JSON.stringify(e)),lplatform&&lplatform.showLoading("资源更新失败，请重启本游戏...")}t.loadOnlineZip(e)}else e(!1)}})},fail:function(a){console.log("index.js downloadFile fail",a),lplatform&&lplatform.showLoading("资源获取失败，请重启本游戏..."),t.tryDownloadZipCount++,t.tryDownloadZipCount<3?t.loadOnlineZip(e):e(!1)}})}})}else e(!0)}onDisable(){}loadItemPush(e){this.removeItemPush(),Laya.Scene.load("scene/ItemPush.scene",Laya.Handler.create(this,function(t){Laya.stage.addChild(t),t.zOrder=6,this.itemPush=t,e&&e("ItemPush")}))}removeItemPush(){this.itemPush&&(this.itemPush.destroy(),this.itemPush=null)}loadWinUI(e){this.removeWinUI(),Laya.Scene.load("scene/Win.scene",Laya.Handler.create(this,function(t){Laya.stage.addChild(t),t.zOrder=3,this.winUI=t,e&&e("Win")}))}removeWinUI(){this.winUI&&(this.winUI.destroy(),this.winUI=null)}loadLoseUI(e){this.removeLoseUI(),Laya.Scene.load("scene/Lose.scene",Laya.Handler.create(this,function(t){Laya.stage.addChild(t),t.zOrder=3,this.loseUI=t,e&&e("Lose")}))}removeLoseUI(){this.loseUI&&(this.loseUI.destroy(),this.loseUI=null)}loadOutlineRewardUI(e){this.removeOutlineRewardUI(),Laya.Scene.load("scene/OutlineReward.scene",Laya.Handler.create(this,function(t){Laya.stage.addChild(t),t.zOrder=3,this.outlineRewardUI=t,e&&e("OutlineReward")}))}removeOutlineRewardUI(){this.outlineRewardUI&&(this.outlineRewardUI.destroy(),this.outlineRewardUI=null)}loadShopUI(e){this.removeShopUI(),Laya.Scene.load("scene/ShopUI.scene",Laya.Handler.create(this,function(t){Laya.stage.addChild(t),t.zOrder=2,this.shopUI=t,e&&e("ShopUI")}))}removeShopUI(){this.shopUI&&(this.shopUI.destroy(),this.shopUI=null)}loadGameUI(e){this.removeGameUI(),Laya.Scene.load("scene/GameUI.scene",Laya.Handler.create(this,function(t){Laya.stage.addChildAt(t,2),this.gameUI=t,e&&e("GameUI")}))}removeGameUI(){this.gameUI&&(this.gameUI.destroy(),this.gameUI=null)}loadChuShiUI(e){this.removeChuShiUI(),Laya.Scene.load("scene/ChuShiUI.scene",Laya.Handler.create(this,function(t){Laya.stage.addChildAt(t,2),this.chuShiUI=t,e&&e("ChuShiUI")}))}removeChuShiUI(){this.chuShiUI&&(this.chuShiUI.destroy(),this.chuShiUI=null)}loadPBScene(){this.removePBScene(),Laya.Sprite3D.load("u3d/Conventional/PbScene.lh",Laya.Handler.create(null,function(e){this.pbScene=e,this.loadSampleScene()}.bind(this))),Laya.loader.load("ui/Usernames.txt",Laya.Handler.create(this,function(e){a.botNames=e.split("\n")}.bind(this)),null,Laya.Loader.TEXT)}removePBScene(){this.pbScene&&(this.pbScene.destroy(),this.pbScene=null)}loadSampleScene(e,t){this.removeSampleScene();let a="NewScene";window.lplatform&&"vivoGame"==window.lplatform.channel&&(a="NewSceneVivo"),Laya.Scene3D.load("u3d/Conventional/"+a+".ls",Laya.Handler.create(this,function(e){this.sampleScene=e,this.scriptLvScen=this.sampleScene.addComponent(R),Laya.stage.addChildAt(e,1),this.loadGameUI(function(e){this.loadLevelEndCb&&(this.loadLevelEndCb(e),this.loadLevelEndCb=null)}.bind(this))}.bind(this)))}removeSampleScene(){this.sampleScene&&(this.sampleScene.destroy(),this.sampleScene=null)}sceneLoadFinished(e){this.lvScen=e,Laya.stage.addChildAt(e,1),this.scriptLvScen=e.addComponent(RunFireS3DC),this.loadGameUI(function(e){this.loadLevelEndCb&&(this.loadLevelEndCb(e),this.loadLevelEndCb=null)}.bind(this))}loadYinSiZhengCe(e){Laya.Scene.load("yinSiZhengCe/YinSiZhengCe.scene",Laya.Handler.create(this,function(t){this.sceneYinSiZhengCe=t,e&&e()}))}firstShowYinSiZhengCe(){this.loadYinSiZhengCe(function(){e.yinSiZhengCeAutoShowed||Laya.stage.addChildAt(this.sceneYinSiZhengCe,3)}.bind(this))}showYinSiZhengCe(){this.loadYinSiZhengCe(function(){Laya.stage.addChildAt(this.sceneYinSiZhengCe,3)}.bind(this))}showToast(e){let t=new Laya.Label(e);t.bold=!1,t.fontSize=30,t.color="#ffffff",t.align="center",t.valign="middle",t.bgColor="#000000a4",t.stroke=1,t.strokeColor="#f0f0f0",t.anchorX=t.anchorY=.5,t.x=Laya.stage.width/2,t.y=Laya.stage.height/2/2,t.scaleX=t.scaleY=0,t.zOrder=9999,Laya.stage.addChild(t),this.arrToasts.unshift(t);for(let e=0;e<this.arrToasts.length;e++)this.arrToasts[e].y=Laya.stage.height/2/2-35*e;(new Laya.Tween).to(t,{scaleX:1,scaleY:1},300),(new Laya.Tween).to(t,{scaleX:0,scaleY:0},300,null,Laya.Handler.create(this,()=>{t.destroy(),this.arrToasts.pop(t)}),2300)}createPrefab_L(e,t,a){Laya.Sprite3D.load(e,Laya.Handler.create(this,function(e){a&&a.addChild(e),t&&t(e)}))}getObjFromPbScene(e,t=500){let a=this.getChildByUrl_L(e,this.pbScene),i=Laya.Sprite3D.instantiate(a);return t>0&&(i.timeout=setTimeout(function(){this.destroy()}.bind(i),t)),i}getChildByUrl_L(e,t){let a=null;if(e){let i=e.split("/"),o=t=t||Laya.stage;for(let e=0;e<i.length&&null!=(o=o.getChildByName(i[e]));e++);a=o}return a}lerpRadius_L(e,t,a){e=Math.round(100*e)/100;let i=0,o=0,n=(t=Math.round(100*t)/100)-e,r=0;r=e>=0?Math.PI-e:-Math.PI-e;let s=0;s=t>=0?Math.PI-t:-Math.PI-t;let l=Math.abs(r)+Math.abs(s);return l=Math.round(100*l)/100,(i=e+(o=Math.abs(n)<=l?n*a:n>=0?-l*a:l*a))>Math.PI&&(i=-(i-2*Math.PI)),i<-Math.PI&&(i+=2*Math.PI),[i,o]}}var B=[];class C extends Laya.Script{constructor(){super()}onEnable(){console.log(this.owner.getComponent(Laya.List));for(var e=0;e<600;e++)B.push({m_label:"No."+e});this.owner.array=B,this.owner.renderHandler=new Laya.Handler(this,this.onRender),this.owner.selectHandler=new Laya.Handler(this,this.onSelect),this.owner.vScrollBarSkin="",this.owner.selectEnable=!0}onRender(e,t){let a=e._children[0];a.text="老6",this.cind==t&&(a.text="666")}onSelect(e){console.log("当前选择的索引："+e),this.cind=e,this.owner._cells[e].getChildAt(0).text="fxxk"}onDisable(){}}class M extends Laya.Script{constructor(){super(),this.colorMatrix=[250/255,0,0,0,0,0,200/255,0,0,0,0,0,237/255,0,0,0,0,0,1,0],this.glowFilterMax=20,this.glowFilterSpd=1,this.glowBulr=8,this.colorFilter=new Laya.ColorFilter(this.colorMatrix),this.glowFilter=new Laya.GlowFilter("#9640ed",8,0,0),this.blurFilter=new Laya.BlurFilter(2)}onEnable(){this.owner.on(Laya.Event.MOUSE_DOWN,this,this.onMouseDown),this.owner.on(Laya.Event.MOUSE_UP,this,this.onMouseUp),this.owner.on(Laya.Event.MOUSE_OUT,this,this.onMouseOut),this.setAutoBulr(this.autoBulr),this.defScaleX=this.owner.scaleX,this.defScaleY=this.owner.scaleY}onDisable(){}onDestroy(){this.owner.off(Laya.Event.MOUSE_DOWN,this,this.onMouseDown),this.owner.off(Laya.Event.MOUSE_UP,this,this.onMouseUp),this.owner.off(Laya.Event.MOUSE_OUT,this,this.onMouseOut),this.autoBulrInterval&&clearInterval(this.autoBulrInterval)}autoGlowBulr(e=1){this.glowFilter=null,this.glowFilter=new Laya.GlowFilter("#9640ed",this.glowBulr,0,0),this.glowBulr+=this.glowFilterSpd*e,this.glowBulr>=this.glowFilterMax?(this.glowBulr=this.glowFilterMax,this.glowFilterSpd=-this.glowFilterSpd):this.glowBulr<=0&&(this.glowBulr=0,this.glowFilterSpd=-this.glowFilterSpd),this.updateBulr(this.glowFilter)}setAutoBulr(e){if(this.autoBulr=e,this.autoBulr){let e=this;this.autoBulrInterval&&clearInterval(this.autoBulrInterval),this.autoBulrInterval=setInterval(function(){e.autoGlowBulr()},16)}else this.autoBulrInterval&&clearInterval(this.autoBulrInterval),this.updateBulr(this.glowFilter,!0),this.glowFilter=null}updateBulr(e,t=!1){if(this.owner.filters){let a=-1;for(let t=0;t<this.owner.filters.length;t++){if(e.constructor.name===this.owner.filters[t].constructor.name){a=t;break}}a>=0?t?this.owner.filters.splice(a,1):this.owner.filters.splice(a,1,e):t||this.owner.filters.push(e)}else t||(this.owner.filters=[e]);let a=this.owner.filters;this.owner.filters=[],this.owner.filters=a}calColorFilterByScale(e){let t=this;t.colorMatrix[0]=1-(1-250/255)*(this.defScaleX-e)/.1,t.colorMatrix[6]=1-(1-200/255)*(this.defScaleX-e)/.1,t.colorMatrix[12]=1-(1-237/255)*(this.defScaleX-e)/.1,t.colorFilter.setByMatrix(t.colorMatrix)}clickTween(e,t,a=!1){let i=this;Laya.Tween.clearAll(i.owner),Laya.Tween.to(this.owner,{scaleX:e*this.defScaleX,scaleY:e*this.defScaleY,update:new Laya.Handler(this,function(e){i.calColorFilterByScale(e.scaleX),i.updateBulr(i.colorFilter),i.autoGlowBulr(8)},[this.owner])},t,Laya.Ease.linearNone,Laya.Handler.create(this,function(e){a&&(i.updateBulr(i.colorFilter,!0),i.updateBulr(i.glowFilter,!0))},[this.owner]))}onMouseDown(e){this.clickTween(.9,200)}onMouseUp(e){this.clickTween(1,200,!0)}onMouseOut(e){this.clickTween(1,200,!0)}}const{abs:G,cos:T,sin:D,acos:V,atan2:P,sqrt:N,pow:E}=Math;function crt(e){return e<0?-E(-e,1/3):E(e,1/3)}const k=Math.PI,O=2*k,U=k/2,_=Number.MAX_SAFE_INTEGER||9007199254740991,z=Number.MIN_SAFE_INTEGER||-9007199254740991,F={x:0,y:0,z:0},H={Tvalues:[-.06405689286260563,.06405689286260563,-.1911188674736163,.1911188674736163,-.3150426796961634,.3150426796961634,-.4337935076260451,.4337935076260451,-.5454214713888396,.5454214713888396,-.6480936519369755,.6480936519369755,-.7401241915785544,.7401241915785544,-.820001985973903,.820001985973903,-.8864155270044011,.8864155270044011,-.9382745520027328,.9382745520027328,-.9747285559713095,.9747285559713095,-.9951872199970213,.9951872199970213],Cvalues:[.12793819534675216,.12793819534675216,.1258374563468283,.1258374563468283,.12167047292780339,.12167047292780339,.1155056680537256,.1155056680537256,.10744427011596563,.10744427011596563,.09761865210411388,.09761865210411388,.08619016153195327,.08619016153195327,.0733464814110803,.0733464814110803,.05929858491543678,.05929858491543678,.04427743881741981,.04427743881741981,.028531388628933663,.028531388628933663,.0123412297999872,.0123412297999872],arcfn:function(e,t){const a=t(e);let i=a.x*a.x+a.y*a.y;return void 0!==a.z&&(i+=a.z*a.z),N(i)},compute:function(e,t,a){if(0===e)return t[0].t=0,t[0];const i=t.length-1;if(1===e)return t[i].t=1,t[i];const o=1-e;let n=t;if(0===i)return t[0].t=e,t[0];if(1===i){const t={x:o*n[0].x+e*n[1].x,y:o*n[0].y+e*n[1].y,t:e};return a&&(t.z=o*n[0].z+e*n[1].z),t}if(i<4){let t,r,s,l=o*o,h=e*e,d=0;2===i?(n=[n[0],n[1],n[2],F],t=l,r=o*e*2,s=h):3===i&&(t=l*o,r=l*e*3,s=o*h*3,d=e*h);const c={x:t*n[0].x+r*n[1].x+s*n[2].x+d*n[3].x,y:t*n[0].y+r*n[1].y+s*n[2].y+d*n[3].y,t:e};return a&&(c.z=t*n[0].z+r*n[1].z+s*n[2].z+d*n[3].z),c}const r=JSON.parse(JSON.stringify(t));for(;r.length>1;){for(let t=0;t<r.length-1;t++)r[t]={x:r[t].x+(r[t+1].x-r[t].x)*e,y:r[t].y+(r[t+1].y-r[t].y)*e},void 0!==r[t].z&&(r[t]=r[t].z+(r[t+1].z-r[t].z)*e);r.splice(r.length-1,1)}return r[0].t=e,r[0]},computeWithRatios:function(e,t,a,i){const o=1-e,n=a,r=t;let s,l=n[0],h=n[1],d=n[2],c=n[3];return l*=o,h*=e,2===r.length?(s=l+h,{x:(l*r[0].x+h*r[1].x)/s,y:(l*r[0].y+h*r[1].y)/s,z:!!i&&(l*r[0].z+h*r[1].z)/s,t:e}):(l*=o,h*=2*o,d*=e*e,3===r.length?(s=l+h+d,{x:(l*r[0].x+h*r[1].x+d*r[2].x)/s,y:(l*r[0].y+h*r[1].y+d*r[2].y)/s,z:!!i&&(l*r[0].z+h*r[1].z+d*r[2].z)/s,t:e}):(l*=o,h*=1.5*o,d*=3*o,c*=e*e*e,4===r.length?(s=l+h+d+c,{x:(l*r[0].x+h*r[1].x+d*r[2].x+c*r[3].x)/s,y:(l*r[0].y+h*r[1].y+d*r[2].y+c*r[3].y)/s,z:!!i&&(l*r[0].z+h*r[1].z+d*r[2].z+c*r[3].z)/s,t:e}):void 0))},derive:function(e,t){const a=[];for(let i=e,o=i.length,n=o-1;o>1;o--,n--){const e=[];for(let a,o=0;o<n;o++)a={x:n*(i[o+1].x-i[o].x),y:n*(i[o+1].y-i[o].y)},t&&(a.z=n*(i[o+1].z-i[o].z)),e.push(a);a.push(e),i=e}return a},between:function(e,t,a){return t<=e&&e<=a||H.approximately(e,t)||H.approximately(e,a)},approximately:function(e,t,a){return G(e-t)<=(a||1e-6)},length:function(e){const t=H.Tvalues.length;let a=0;for(let i,o=0;o<t;o++)i=.5*H.Tvalues[o]+.5,a+=H.Cvalues[o]*H.arcfn(i,e);return.5*a},map:function(e,t,a,i,o){return i+(o-i)*((e-t)/(a-t))},lerp:function(e,t,a){const i={x:t.x+e*(a.x-t.x),y:t.y+e*(a.y-t.y)};return void 0!==t.z&&void 0!==a.z&&(i.z=t.z+e*(a.z-t.z)),i},pointToString:function(e){let t=e.x+"/"+e.y;return void 0!==e.z&&(t+="/"+e.z),t},pointsToString:function(e){return"["+e.map(H.pointToString).join(", ")+"]"},copy:function(e){return JSON.parse(JSON.stringify(e))},angle:function(e,t,a){const i=t.x-e.x,o=t.y-e.y,n=a.x-e.x,r=a.y-e.y;return P(i*r-o*n,i*n+o*r)},round:function(e,t){const a=""+e,i=a.indexOf(".");return parseFloat(a.substring(0,i+1+t))},dist:function(e,t){const a=e.x-t.x,i=e.y-t.y;return N(a*a+i*i)},closest:function(e,t){let a,i,o=E(2,63);return e.forEach(function(e,n){(i=H.dist(t,e))<o&&(o=i,a=n)}),{mdist:o,mpos:a}},abcratio:function(e,t){if(2!==t&&3!==t)return!1;if(void 0===e)e=.5;else if(0===e||1===e)return e;const a=E(e,t)+E(1-e,t);return G((a-1)/a)},projectionratio:function(e,t){if(2!==t&&3!==t)return!1;if(void 0===e)e=.5;else if(0===e||1===e)return e;const a=E(1-e,t);return a/(E(e,t)+a)},lli8:function(e,t,a,i,o,n,r,s){const l=(e-a)*(n-s)-(t-i)*(o-r);return 0!=l&&{x:((e*i-t*a)*(o-r)-(e-a)*(o*s-n*r))/l,y:((e*i-t*a)*(n-s)-(t-i)*(o*s-n*r))/l}},lli4:function(e,t,a,i){const o=e.x,n=e.y,r=t.x,s=t.y,l=a.x,h=a.y,d=i.x,c=i.y;return H.lli8(o,n,r,s,l,h,d,c)},lli:function(e,t){return H.lli4(e,e.c,t,t.c)},makeline:function(e,t){return new $(e.x,e.y,(e.x+t.x)/2,(e.y+t.y)/2,t.x,t.y)},findbbox:function(e){let t=_,a=_,i=z,o=z;return e.forEach(function(e){const n=e.bbox();t>n.x.min&&(t=n.x.min),a>n.y.min&&(a=n.y.min),i<n.x.max&&(i=n.x.max),o<n.y.max&&(o=n.y.max)}),{x:{min:t,mid:(t+i)/2,max:i,size:i-t},y:{min:a,mid:(a+o)/2,max:o,size:o-a}}},shapeintersections:function(e,t,a,i,o){if(!H.bboxoverlap(t,i))return[];const n=[],r=[e.startcap,e.forward,e.back,e.endcap],s=[a.startcap,a.forward,a.back,a.endcap];return r.forEach(function(t){t.virtual||s.forEach(function(i){if(i.virtual)return;const r=t.intersects(i,o);r.length>0&&(r.c1=t,r.c2=i,r.s1=e,r.s2=a,n.push(r))})}),n},makeshape:function(e,t,a){const i=t.points.length,o=e.points.length,n=H.makeline(t.points[i-1],e.points[0]),r=H.makeline(e.points[o-1],t.points[0]),s={startcap:n,forward:e,back:t,endcap:r,bbox:H.findbbox([n,e,t,r]),intersections:function(e){return H.shapeintersections(s,s.bbox,e,e.bbox,a)}};return s},getminmax:function(e,t,a){if(!a)return{min:0,max:0};let i,o,n=_,r=z;-1===a.indexOf(0)&&(a=[0].concat(a)),-1===a.indexOf(1)&&a.push(1);for(let s=0,l=a.length;s<l;s++)i=a[s],(o=e.get(i))[t]<n&&(n=o[t]),o[t]>r&&(r=o[t]);return{min:n,mid:(n+r)/2,max:r,size:r-n}},align:function(e,t){const a=t.p1.x,i=t.p1.y,o=-P(t.p2.y-i,t.p2.x-a);return e.map(function(e){return{x:(e.x-a)*T(o)-(e.y-i)*D(o),y:(e.x-a)*D(o)+(e.y-i)*T(o)}})},roots:function(e,t){t=t||{p1:{x:0,y:0},p2:{x:1,y:0}};const a=e.length-1,i=H.align(e,t),o=function(e){return 0<=e&&e<=1};if(2===a){const e=i[0].y,t=i[1].y,a=i[2].y,n=e-2*t+a;if(0!==n){const i=-N(t*t-e*a),r=-e+t;return[-(i+r)/n,-(-i+r)/n].filter(o)}return t!==a&&0===n?[(2*t-a)/(2*t-2*a)].filter(o):[]}const n=i[0].y,r=i[1].y,s=i[2].y;let l=3*r-n-3*s+i[3].y,h=3*n-6*r+3*s,d=-3*n+3*r,c=n;if(H.approximately(l,0)){if(H.approximately(h,0))return H.approximately(d,0)?[]:[-c/d].filter(o);const e=N(d*d-4*h*c),t=2*h;return[(e-d)/t,(-d-e)/t].filter(o)}const m=(3*(d/=l)-(h/=l)*h)/3,p=m/3,u=(2*h*h*h-9*h*d+27*(c/=l))/27,f=u/2,g=f*f+p*p*p;let w,y,b,S,v;if(g<0){const e=-m/3,t=N(e*e*e),a=-u/(2*t),i=V(a<-1?-1:a>1?1:a),n=2*crt(t);return[b=n*T(i/3)-h/3,S=n*T((i+O)/3)-h/3,v=n*T((i+2*O)/3)-h/3].filter(o)}if(0===g)return[b=2*(w=f<0?crt(-f):-crt(f))-h/3,S=-w-h/3].filter(o);{const e=N(g);return[(w=crt(-f+e))-(y=crt(f+e))-h/3].filter(o)}},droots:function(e){if(3===e.length){const t=e[0],a=e[1],i=e[2],o=t-2*a+i;if(0!==o){const e=-N(a*a-t*i),n=-t+a;return[-(e+n)/o,-(-e+n)/o]}return a!==i&&0===o?[(2*a-i)/(2*(a-i))]:[]}if(2===e.length){const t=e[0],a=e[1];return t!==a?[t/(t-a)]:[]}return[]},curvature:function(e,t,a,i,o){let n,r,s,l,h=0,d=0;const c=H.compute(e,t),m=H.compute(e,a),p=c.x*c.x+c.y*c.y;if(i?(n=N(E(c.y*m.z-m.y*c.z,2)+E(c.z*m.x-m.z*c.x,2)+E(c.x*m.y-m.x*c.y,2)),r=E(p+c.z*c.z,1.5)):(n=c.x*m.y-c.y*m.x,r=E(p,1.5)),0===n||0===r)return{k:0,r:0};if(h=n/r,d=r/n,!o){const o=H.curvature(e-.001,t,a,i,!0).k,n=H.curvature(e+.001,t,a,i,!0).k;l=(n-h+(h-o))/2,s=(G(n-h)+G(h-o))/2}return{k:h,r:d,dk:l,adk:s}},inflections:function(e){if(e.length<4)return[];const t=H.align(e,{p1:e[0],p2:e.slice(-1)[0]}),a=t[2].x*t[1].y,i=t[3].x*t[1].y,o=t[1].x*t[2].y,n=18*(-3*a+2*i+3*o-t[3].x*t[2].y),r=18*(3*a-i-3*o),s=18*(o-a);if(H.approximately(n,0)){if(!H.approximately(r,0)){let e=-s/r;if(0<=e&&e<=1)return[e]}return[]}const l=r*r-4*n*s,h=Math.sqrt(l),d=2*n;return H.approximately(d,0)?[]:[(h-r)/d,-(r+h)/d].filter(function(e){return 0<=e&&e<=1})},bboxoverlap:function(e,t){const a=["x","y"],i=a.length;for(let o,n,r,s,l=0;l<i;l++)if(n=e[o=a[l]].mid,r=t[o].mid,s=(e[o].size+t[o].size)/2,G(n-r)>=s)return!1;return!0},expandbox:function(e,t){t.x.min<e.x.min&&(e.x.min=t.x.min),t.y.min<e.y.min&&(e.y.min=t.y.min),t.z&&t.z.min<e.z.min&&(e.z.min=t.z.min),t.x.max>e.x.max&&(e.x.max=t.x.max),t.y.max>e.y.max&&(e.y.max=t.y.max),t.z&&t.z.max>e.z.max&&(e.z.max=t.z.max),e.x.mid=(e.x.min+e.x.max)/2,e.y.mid=(e.y.min+e.y.max)/2,e.z&&(e.z.mid=(e.z.min+e.z.max)/2),e.x.size=e.x.max-e.x.min,e.y.size=e.y.max-e.y.min,e.z&&(e.z.size=e.z.max-e.z.min)},pairiteration:function(e,t,a){const i=e.bbox(),o=t.bbox(),n=1e5,r=a||.5;if(i.x.size+i.y.size<r&&o.x.size+o.y.size<r)return[(n*(e._t1+e._t2)/2|0)/n+"/"+(n*(t._t1+t._t2)/2|0)/n];let s=e.split(.5),l=t.split(.5),h=[{left:s.left,right:l.left},{left:s.left,right:l.right},{left:s.right,right:l.right},{left:s.right,right:l.left}];h=h.filter(function(e){return H.bboxoverlap(e.left.bbox(),e.right.bbox())});let d=[];return 0===h.length?d:(h.forEach(function(e){d=d.concat(H.pairiteration(e.left,e.right,r))}),d=d.filter(function(e,t){return d.indexOf(e)===t}))},getccenter:function(e,t,a){const i=t.x-e.x,o=t.y-e.y,n=a.x-t.x,r=a.y-t.y,s=i*T(U)-o*D(U),l=i*D(U)+o*T(U),h=n*T(U)-r*D(U),d=n*D(U)+r*T(U),c=(e.x+t.x)/2,m=(e.y+t.y)/2,p=(t.x+a.x)/2,u=(t.y+a.y)/2,f=c+s,g=m+l,w=p+h,y=u+d,b=H.lli8(c,m,f,g,p,u,w,y),S=H.dist(b,e);let v,L=P(e.y-b.y,e.x-b.x),I=P(t.y-b.y,t.x-b.x),A=P(a.y-b.y,a.x-b.x);return L<A?((L>I||I>A)&&(L+=O),L>A&&(v=A,A=L,L=v)):A<I&&I<L?(v=A,A=L,L=v):A+=O,b.s=L,b.e=A,b.r=S,b},numberSort:function(e,t){return e-t}};class Y{constructor(e){this.curves=[],this._3d=!1,e&&(this.curves=e,this._3d=this.curves[0]._3d)}valueOf(){return this.toString()}toString(){return"["+this.curves.map(function(e){return H.pointsToString(e.points)}).join(", ")+"]"}addCurve(e){this.curves.push(e),this._3d=this._3d||e._3d}length(){return this.curves.map(function(e){return e.length()}).reduce(function(e,t){return e+t})}curve(e){return this.curves[e]}bbox(){const e=this.curves;for(var t=e[0].bbox(),a=1;a<e.length;a++)H.expandbox(t,e[a].bbox());return t}offset(e){const t=[];return this.curves.forEach(function(a){t.push(...a.offset(e))}),new Y(t)}}const{abs:q,min:W,max:X,cos:j,sin:J,acos:K,sqrt:Z}=Math,Q=Math.PI;class ${constructor(e){let t=e&&e.forEach?e:Array.from(arguments).slice(),a=!1;if("object"==typeof t[0]){a=t.length;const e=[];t.forEach(function(t){["x","y","z"].forEach(function(a){void 0!==t[a]&&e.push(t[a])})}),t=e}let i=!1;const o=t.length;if(a){if(a>4){if(1!==arguments.length)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");i=!0}}else if(6!==o&&8!==o&&9!==o&&12!==o&&1!==arguments.length)throw new Error("Only new Bezier(point[]) is accepted for 4th and higher order curves");const n=this._3d=!i&&(9===o||12===o)||e&&e[0]&&void 0!==e[0].z,r=this.points=[];for(let e=0,a=n?3:2;e<o;e+=a){var s={x:t[e],y:t[e+1]};n&&(s.z=t[e+2]),r.push(s)}const l=this.order=r.length-1,h=this.dims=["x","y"];n&&h.push("z"),this.dimlen=h.length;const d=H.align(r,{p1:r[0],p2:r[l]}),c=H.dist(r[0],r[l]);this._linear=d.reduce((e,t)=>e+q(t.y),0)<c/50,this._lut=[],this._t1=0,this._t2=1,this.update()}static quadraticFromPoints(e,t,a,i){if(void 0===i&&(i=.5),0===i)return new $(t,t,a);if(1===i)return new $(e,t,t);const o=$.getABC(2,e,t,a,i);return new $(e,o.A,a)}static cubicFromPoints(e,t,a,i,o){void 0===i&&(i=.5);const n=$.getABC(3,e,t,a,i);void 0===o&&(o=H.dist(t,n.C));const r=o*(1-i)/i,s=H.dist(e,a),l=(a.x-e.x)/s,h=(a.y-e.y)/s,d=o*l,c=o*h,m=r*l,p=r*h,u=t.x-d,f=t.y-c,g=t.x+m,w=t.y+p,y=n.A,b=y.x+(u-y.x)/(1-i),S=y.y+(f-y.y)/(1-i),v=y.x+(g-y.x)/i,L=y.y+(w-y.y)/i,I={x:e.x+(b-e.x)/i,y:e.y+(S-e.y)/i},A={x:a.x+(v-a.x)/(1-i),y:a.y+(L-a.y)/(1-i)};return new $(e,I,A,a)}static getUtils(){return H}getUtils(){return $.getUtils()}static get PolyBezier(){return Y}valueOf(){return this.toString()}toString(){return H.pointsToString(this.points)}toSVG(){if(this._3d)return!1;const e=this.points,t=["M",e[0].x,e[0].y,2===this.order?"Q":"C"];for(let a=1,i=e.length;a<i;a++)t.push(e[a].x),t.push(e[a].y);return t.join(" ")}setRatios(e){if(e.length!==this.points.length)throw new Error("incorrect number of ratio values");this.ratios=e,this._lut=[]}verify(){const e=this.coordDigest();e!==this._print&&(this._print=e,this.update())}coordDigest(){return this.points.map(function(e,t){return""+t+e.x+e.y+(e.z?e.z:0)}).join("")}update(){this._lut=[],this.dpoints=H.derive(this.points,this._3d),this.computedirection()}computedirection(){const e=this.points,t=H.angle(e[0],e[this.order],e[1]);this.clockwise=t>0}length(){return H.length(this.derivative.bind(this))}static getABC(e=2,t,a,i,o=.5){const n=H.projectionratio(o,e),r=1-n,s={x:n*t.x+r*i.x,y:n*t.y+r*i.y},l=H.abcratio(o,e);return{A:{x:a.x+(a.x-s.x)/l,y:a.y+(a.y-s.y)/l},B:a,C:s,S:t,E:i}}getABC(e,t){t=t||this.get(e);let a=this.points[0],i=this.points[this.order];return $.getABC(this.order,a,t,i,e)}getLUT(e){if(this.verify(),e=e||100,this._lut.length===e)return this._lut;this._lut=[],e++,this._lut=[];for(let t,a,i=0;i<e;i++)a=i/(e-1),(t=this.compute(a)).t=a,this._lut.push(t);return this._lut}on(e,a){a=a||5;const i=this.getLUT(),o=[];for(let t,n=0,r=0;n<i.length;n++)t=i[n],H.dist(t,e)<a&&(o.push(t),r+=n/i.length);return!!o.length&&(t/=o.length)}project(e){const t=this.getLUT(),a=t.length-1,i=H.closest(t,e),o=i.mpos,n=(o-1)/a,r=(o+1)/a,s=.1/a;let l,h,d=i.mdist,c=n,m=c;for(d+=1;c<r+s;c+=s)l=this.compute(c),(h=H.dist(e,l))<d&&(d=h,m=c);return m=m<0?0:m>1?1:m,(l=this.compute(m)).t=m,l.d=d,l}get(e){return this.compute(e)}point(e){return this.points[e]}compute(e){return this.ratios?H.computeWithRatios(e,this.points,this.ratios,this._3d):H.compute(e,this.points,this._3d,this.ratios)}raise(){const e=this.points,t=[e[0]],a=e.length;for(let i,o,n=1;n<a;n++)i=e[n],o=e[n-1],t[n]={x:(a-n)/a*i.x+n/a*o.x,y:(a-n)/a*i.y+n/a*o.y};return t[a]=e[a-1],new $(t)}derivative(e){return H.compute(e,this.dpoints[0],this._3d)}dderivative(e){return H.compute(e,this.dpoints[1],this._3d)}align(){let e=this.points;return new $(H.align(e,{p1:e[0],p2:e[e.length-1]}))}curvature(e){return H.curvature(e,this.dpoints[0],this.dpoints[1],this._3d)}inflections(){return H.inflections(this.points)}normal(e){return this._3d?this.__normal3(e):this.__normal2(e)}__normal2(e){const t=this.derivative(e),a=Z(t.x*t.x+t.y*t.y);return{x:-t.y/a,y:t.x/a}}__normal3(e){const t=this.derivative(e),a=this.derivative(e+.01),i=Z(t.x*t.x+t.y*t.y+t.z*t.z),o=Z(a.x*a.x+a.y*a.y+a.z*a.z);t.x/=i,t.y/=i,t.z/=i,a.x/=o,a.y/=o,a.z/=o;const n={x:a.y*t.z-a.z*t.y,y:a.z*t.x-a.x*t.z,z:a.x*t.y-a.y*t.x},r=Z(n.x*n.x+n.y*n.y+n.z*n.z);n.x/=r,n.y/=r,n.z/=r;const s=[n.x*n.x,n.x*n.y-n.z,n.x*n.z+n.y,n.x*n.y+n.z,n.y*n.y,n.y*n.z-n.x,n.x*n.z-n.y,n.y*n.z+n.x,n.z*n.z];return{x:s[0]*t.x+s[1]*t.y+s[2]*t.z,y:s[3]*t.x+s[4]*t.y+s[5]*t.z,z:s[6]*t.x+s[7]*t.y+s[8]*t.z}}hull(e){let t=this.points,a=[],i=[],o=0;for(i[o++]=t[0],i[o++]=t[1],i[o++]=t[2],3===this.order&&(i[o++]=t[3]);t.length>1;){a=[];for(let n,r=0,s=t.length-1;r<s;r++)n=H.lerp(e,t[r],t[r+1]),i[o++]=n,a.push(n);t=a}return i}split(e,t){if(0===e&&t)return this.split(t).left;if(1===t)return this.split(e).right;const a=this.hull(e),i={left:2===this.order?new $([a[0],a[3],a[5]]):new $([a[0],a[4],a[7],a[9]]),right:2===this.order?new $([a[5],a[4],a[2]]):new $([a[9],a[8],a[6],a[3]]),span:a};return i.left._t1=H.map(0,0,1,this._t1,this._t2),i.left._t2=H.map(e,0,1,this._t1,this._t2),i.right._t1=H.map(e,0,1,this._t1,this._t2),i.right._t2=H.map(1,0,1,this._t1,this._t2),t?(t=H.map(t,e,1,0,1),i.right.split(t).left):i}extrema(){const e={};let t=[];return this.dims.forEach(function(a){let i=function(e){return e[a]},o=this.dpoints[0].map(i);e[a]=H.droots(o),3===this.order&&(o=this.dpoints[1].map(i),e[a]=e[a].concat(H.droots(o))),e[a]=e[a].filter(function(e){return e>=0&&e<=1}),t=t.concat(e[a].sort(H.numberSort))}.bind(this)),e.values=t.sort(H.numberSort).filter(function(e,a){return t.indexOf(e)===a}),e}bbox(){const e=this.extrema(),t={};return this.dims.forEach(function(a){t[a]=H.getminmax(this,a,e[a])}.bind(this)),t}overlaps(e){const t=this.bbox(),a=e.bbox();return H.bboxoverlap(t,a)}offset(e,t){if(void 0!==t){const a=this.get(e),i=this.normal(e),o={c:a,n:i,x:a.x+i.x*t,y:a.y+i.y*t};return this._3d&&(o.z=a.z+i.z*t),o}if(this._linear){const t=this.normal(0),a=this.points.map(function(a){const i={x:a.x+e*t.x,y:a.y+e*t.y};return a.z&&t.z&&(i.z=a.z+e*t.z),i});return[new $(a)]}return this.reduce().map(function(t){return t._linear?t.offset(e)[0]:t.scale(e)})}simple(){if(3===this.order){const e=H.angle(this.points[0],this.points[3],this.points[1]),t=H.angle(this.points[0],this.points[3],this.points[2]);if(e>0&&t<0||e<0&&t>0)return!1}const e=this.normal(0),t=this.normal(1);let a=e.x*t.x+e.y*t.y;return this._3d&&(a+=e.z*t.z),q(K(a))<Q/3}reduce(){let e,t,a=0,i=0,o=[],n=[],r=this.extrema().values;for(-1===r.indexOf(0)&&(r=[0].concat(r)),-1===r.indexOf(1)&&r.push(1),a=r[0],e=1;e<r.length;e++)i=r[e],(t=this.split(a,i))._t1=a,t._t2=i,o.push(t),a=i;return o.forEach(function(e){for(a=0,i=0;i<=1;)for(i=a+.01;i<=1.01;i+=.01)if(!(t=e.split(a,i)).simple()){if(q(a-(i-=.01))<.01)return[];(t=e.split(a,i))._t1=H.map(a,0,1,e._t1,e._t2),t._t2=H.map(i,0,1,e._t1,e._t2),n.push(t),a=i;break}a<1&&((t=e.split(a,1))._t1=H.map(a,0,1,e._t1,e._t2),t._t2=e._t2,n.push(t))}),n}translate(e,t,a){a="number"==typeof a?a:t;const i=this.order;let o=this.points.map((e,o)=>(1-o/i)*t+o/i*a);return new $(this.points.map((t,a)=>({x:t.x+e.x*o[a],y:t.y+e.y*o[a]})))}scale(e){const t=this.order;let a=!1;if("function"==typeof e&&(a=e),a&&2===t)return this.raise().scale(a);const i=this.clockwise,o=this.points;if(this._linear)return this.translate(this.normal(0),a?a(0):e,a?a(1):e);const n=a?a(0):e,r=a?a(1):e,s=[this.offset(0,10),this.offset(1,10)],l=[],h=H.lli4(s[0],s[0].c,s[1],s[1].c);if(!h)throw new Error("cannot scale this curve. Try reducing it first.");return[0,1].forEach(function(e){const a=l[e*t]=H.copy(o[e*t]);a.x+=(e?r:n)*s[e].n.x,a.y+=(e?r:n)*s[e].n.y}),a?([0,1].forEach(function(n){if(2!==t||!n){var r=o[n+1],s={x:r.x-h.x,y:r.y-h.y},d=a?a((n+1)/t):e;a&&!i&&(d=-d);var c=Z(s.x*s.x+s.y*s.y);s.x/=c,s.y/=c,l[n+1]={x:r.x+d*s.x,y:r.y+d*s.y}}}),new $(l)):([0,1].forEach(e=>{if(2===t&&e)return;const a=l[e*t],i=this.derivative(e),n={x:a.x+i.x,y:a.y+i.y};l[e+1]=H.lli4(a,n,h,o[e+1])}),new $(l))}outline(e,t,a,i){if(t=void 0===t?e:t,this._linear){const o=this.normal(0),n=this.points[0],r=this.points[this.points.length-1];let s,l,h;void 0===a&&(a=e,i=t),s={x:n.x+o.x*e,y:n.y+o.y*e},h={x:r.x+o.x*a,y:r.y+o.y*a};const d=[s,l={x:(s.x+h.x)/2,y:(s.y+h.y)/2},h];s={x:n.x-o.x*t,y:n.y-o.y*t};const c=[h={x:r.x-o.x*i,y:r.y-o.y*i},l={x:(s.x+h.x)/2,y:(s.y+h.y)/2},s],m=H.makeline(c[2],d[0]),p=H.makeline(d[2],c[0]),u=[m,new $(d),p,new $(c)];return new Y(u)}const o=this.reduce(),n=o.length,r=[];let s,l=[],h=0,d=this.length();const c=void 0!==a&&void 0!==i;function linearDistanceFunction(e,t,a,i,o){return function(n){const r=i/a,s=(i+o)/a,l=t-e;return H.map(n,0,1,e+r*l,e+s*l)}}o.forEach(function(o){const n=o.length();c?(r.push(o.scale(linearDistanceFunction(e,a,d,h,n))),l.push(o.scale(linearDistanceFunction(-t,-i,d,h,n)))):(r.push(o.scale(e)),l.push(o.scale(-t))),h+=n}),l=l.map(function(e){return(s=e.points)[3]?e.points=[s[3],s[2],s[1],s[0]]:e.points=[s[2],s[1],s[0]],e}).reverse();const m=r[0].points[0],p=r[n-1].points[r[n-1].points.length-1],u=l[n-1].points[l[n-1].points.length-1],f=l[0].points[0],g=H.makeline(u,m),w=H.makeline(p,f),y=[g].concat(r).concat([w]).concat(l);return new Y(y)}outlineshapes(e,t,a){t=t||e;const i=this.outline(e,t).curves,o=[];for(let e=1,t=i.length;e<t/2;e++){const n=H.makeshape(i[e],i[t-e],a);n.startcap.virtual=e>1,n.endcap.virtual=e<t/2-1,o.push(n)}return o}intersects(e,t){return e?e.p1&&e.p2?this.lineIntersects(e):(e instanceof $&&(e=e.reduce()),this.curveintersects(this.reduce(),e,t)):this.selfintersects(t)}lineIntersects(e){const t=W(e.p1.x,e.p2.x),a=W(e.p1.y,e.p2.y),i=X(e.p1.x,e.p2.x),o=X(e.p1.y,e.p2.y);return H.roots(this.points,e).filter(e=>{var n=this.get(e);return H.between(n.x,t,i)&&H.between(n.y,a,o)})}selfintersects(e){const t=this.reduce(),a=t.length-2,i=[];for(let o,n,r,s=0;s<a;s++)n=t.slice(s,s+1),r=t.slice(s+2),o=this.curveintersects(n,r,e),i.push(...o);return i}curveintersects(e,t,a){const i=[];e.forEach(function(e){t.forEach(function(t){e.overlaps(t)&&i.push({left:e,right:t})})});let o=[];return i.forEach(function(e){const t=H.pairiteration(e.left,e.right,a);t.length>0&&(o=o.concat(t))}),o}arcs(e){return e=e||.5,this._iterate(e,[])}_error(e,t,a,i){const o=(i-a)/4,n=this.get(a+o),r=this.get(i-o),s=H.dist(e,t),l=H.dist(e,n),h=H.dist(e,r);return q(l-s)+q(h-s)}_iterate(e,t){let a,i=0,o=1;do{a=0,o=1;let n,r,s,l,h,d=this.get(i),c=!1,m=!1,p=o,u=1;do{if(m=c,l=s,p=(i+o)/2,n=this.get(p),r=this.get(o),(s=H.getccenter(d,n,r)).interval={start:i,end:o},c=this._error(s,d,i,o)<=e,(h=m&&!c)||(u=o),c){if(o>=1){if(s.interval.end=u=1,l=s,o>1){let e={x:s.x+s.r*j(s.e),y:s.y+s.r*J(s.e)};s.e+=H.angle({x:s.x,y:s.y},e,this.get(1))}break}o+=(o-i)/2}else o=p}while(!h&&a++<100);if(a>=100)break;l=l||s,t.push(l),i=u}while(o<1);return t}}class ee extends Laya.Script{constructor(){super()}onEnable(){}onDisable(){}}class te extends Laya.Scene{constructor(){super(),this.resetLvData(),this.makeFlyingStarDelayMax=.1,this.makeFlyingStarDelay=.1,this.pushUnlockIndex=0,this.starFlyDir=1}resetLvData(){this.uiShowedScore=0,this.lvMoney=0,this.uiShowedMoney=e.money}onDestroy(){Laya.timer.clearAll(this),this.moreGameShowHideTimeout&&clearTimeout(this.moreGameShowHideTimeout),this.hideGuideTimeout&&clearTimeout(this.hideGuideTimeout)}onAwake(){Laya.SoundManager.useAudioMusic=!1,Laya.SoundManager.musicVolume?this.btnSoundOff.skin="ui/btn_soundon.png":this.btnSoundOff.skin="ui/btn_soundoff.png",a.stopSound("sound/bgm.mp3"),a.playSound("sound/bgm.mp3",0),this.clickStartBox.on(Laya.Event.MOUSE_DOWN,this,this.onMouseDown),this.clickStartBox.on(Laya.Event.MOUSE_UP,this,this.onMouseUp),this.btnSoundOff.on(Laya.Event.CLICK,this,e=>{Laya.SoundManager.soundVolume?(Laya.SoundManager.setMusicVolume(0),Laya.SoundManager.setSoundVolume(0),this.btnSoundOff.skin="ui/btn_soundoff.png",ne.mute=!0):(Laya.SoundManager.setMusicVolume(1),Laya.SoundManager.setSoundVolume(1),ne.mute=!1,this.btnSoundOff.skin="ui/btn_soundon.png"),console.log("musicVolume",Laya.SoundManager.musicVolume)});let t=this;window.lloading.loadLevelEndCb=function(e){t.loadLevelEndCb(e)},Laya.timer.frameLoop(1,this,this.lupdate),this.btnRetry.on(Laya.Event.CLICK,this,e=>{a.playSound("sound/Click.wav",1),lloading.removeGameUI(),lloading.removeSampleScene(),lloading.loadSampleScene()}),this.btnJump.on(Laya.Event.CLICK,this,e=>{a.playSound("sound/Click.wav",1),this.goToRank()}),this.btnNext.on(Laya.Event.CLICK,this,t=>{lplatform.timeVideoAd(t=>{if(t){let t=2*Math.round(a.lvCfg[e.level].rewardMoney*Math.min(1,game.lvScore/a.lvCfg[e.level].stars[3]));this.clickToNextLevel(t),lloading.showToast("Double！")}else{let t=Math.round(a.lvCfg[e.level].rewardMoney*Math.min(1,game.lvScore/a.lvCfg[e.level].stars[3]));this.clickToNextLevel(t),lplatform.labData.sendToTable&&lplatform.showFavoriteGuide()}})}),this.btnNextDouble.on(Laya.Event.CLICK,this,t=>{MiniGameAds.isRewardvideoReady()?(Laya.SoundManager.setSoundVolume(0),MiniGameAds.showRewardedVideo().then(()=>{ne.mute||Laya.SoundManager.setSoundVolume(1);let t=2*Math.round(a.lvCfg[e.level].rewardMoney*Math.min(1,game.lvScore/a.lvCfg[e.level].stars[3]));this.clickToNextLevel(t),lloading.showToast("Double！"),console.info("====> show RewardedVideo success")}).catch(e=>{ne.mute||Laya.SoundManager.setSoundVolume(1),console.error("====> show RewardedVideo error: "+e.message)})):console.info("====> RewardedVideo not ready")}),this.shareDouble.on(Laya.Event.CLICK,this,t=>{lplatform.shareRecord(()=>{let t=2*Math.round(a.lvCfg[e.level].rewardMoney*Math.min(1,game.lvScore/a.lvCfg[e.level].stars[3]));this.clickToNextLevel(t),lloading.showToast("Double！")},()=>{console.log("分享失败")})}),this.btnShop.on(Laya.Event.MOUSE_DOWN,this,e=>{e.stopPropagation()}),this.btnShop.on(Laya.Event.MOUSE_UP,this,e=>{e.stopPropagation()}),this.btnShop.on(Laya.Event.CLICK,this,e=>{a.playSound("sound/Click.wav",1),lloading.loadShopUI()}),this.btnSetting.on(Laya.Event.MOUSE_DOWN,this,e=>{e.stopPropagation()}),this.btnSetting.on(Laya.Event.MOUSE_UP,this,e=>{e.stopPropagation()}),this.btnSetting.on(Laya.Event.CLICK,this,e=>{a.playSound("sound/Click.wav",1),console.log("隐藏Setting button")}),Laya.loader.load("res/atlas/ui.atlas",Laya.Handler.create(this,e=>{this.uiAtlas=e}),null,Laya.Loader.ATLAS),this.pushUnlock.on(Laya.Event.CLICK,this,t=>{a.playSound("sound/Click.wav",1),MiniGameAds.isRewardvideoReady()?(Laya.SoundManager.setSoundVolume(0),MiniGameAds.showRewardedVideo().then(()=>{ne.mute||Laya.SoundManager.setSoundVolume(1),e.unlocked[this.pushUnlockIndex]=1,e.curBallType=this.pushUnlockIndex,a.saveData(),this.setGState(a.G_STATE_RUNNING),lloading.showToast("Successfully unlocked the skin"),game.reAddBall(),console.info("====> show RewardedVideo success")}).catch(e=>{ne.mute||Laya.SoundManager.setSoundVolume(1),console.error("====> show RewardedVideo error: "+e.message)})):console.info("====> RewardedVideo not ready")}),this.pushClose.on(Laya.Event.CLICK,this,e=>{a.playSound("sound/Click.wav",1),this.setGState(a.G_STATE_RUNNING)}),this.btnGameReset.on(Laya.Event.CLICK,this,e=>{a.playSound("sound/Click.wav",1),lloading.removeGameUI(),lloading.removeSampleScene(),lloading.loadSampleScene()}),"TT"!=lplatform.channel&&lplatform.showBanner()}clickToNextLevel(t){a.playSound("sound/Click.wav",1),this.btnNext.visible=0,this.btnNextDouble.visible=0,this.shareDouble.visible=0;for(let e=0;e<t;e++){let t=this.cloneImage(this.flyingMoneyIco);t.x+=(Math.random()-.5)*this.btnNext.width*this.btnNext.scaleX/3,t.y+=(Math.random()-.5)*this.btnNext.height*this.btnNext.scaleY/2;let i=new $(t.x,t.y,Math.random()*Laya.stage.width,Math.random()*Laya.stage.height/4,this.endMoneyIco.x,this.endMoneyIco.y),o=Laya.Tween.to(t,{alpha:.5,update:new Laya.Handler(this,function(e){let t=i.get(o._usedTimer/2e3);e.x=t.x,e.y=t.y},[t])},2e3,Laya.Ease.circInOut,Laya.Handler.create(this,()=>{t.destroy(),i=null,a.playSound("sound/GemCollect.wav",1)}),10*e)}setTimeout(()=>{e.money+=t,e.level++,e.level>=a.lvCfg.length&&(e.level=0),a.saveData()},2e3),setTimeout(()=>{lloading.removeGameUI(),lloading.removeSampleScene(),lloading.loadSampleScene()},4e3)}loadLevelEndCb(e){"GameUI"==e&&this.setGState(a.G_STATE_MENU)}setGState(t){if(a.gstate=t,window.lloading.scriptLvScen.setGState(t),a.gstate==a.G_STATE_MENU)this.gameui.visible=0,this.setting.visible=0,this.end.visible=0,this.mainMenu.visible=1,this.push.visible=0,lplatform.stopRecord();else if(a.gstate==a.G_STATE_ITEM_PUSH){let t=[];for(let a=0;a<e.unlocked.length;a++)0==e.unlocked[a]&&t.push(a);if(t.length>0){this.pushUnlockIndex=t[0],this.push.visible=1;let e={0:6,1:1,2:2,3:5,4:4,5:0,6:3,7:7,8:8};this.pushItemImg.skin="ui/Ball"+(e[this.pushUnlockIndex]+1)+".png"}else this.setGState(a.G_STATE_RUNNING);MiniGameAds.isInterstitialReady()?MiniGameAds.showInterstitial().then(()=>{console.info("====> show interstitial success")}).catch(e=>{console.error("====> show interstitial error: "+e.message)}):console.info("====> interstitial not ready")}else a.gstate==a.G_STATE_RUNNING?(this.gameui.visible=1,this.setting.visible=0,this.end.visible=0,this.mainMenu.visible=0,this.push.visible=0,this.resetLvData(),lplatform.startRecord()):a.gstate==a.G_STATE_WIN?this.end.visible=1:a.gstate==a.G_STATE_SETTING&&(this.setting.visible=1)}onMouseDown(e){a.gstate==a.G_STATE_MENU&&this.setGState(a.G_STATE_ITEM_PUSH)}onMouseUp(e){}stopTouchEvent(e){e.stopPropagation()}fenXiangClick(e){lplatform.shareRecord(function(){},function(){})}luPingClick(e){if(e.stopPropagation(),!lplatform.platform.recordStopCb){let e=this;lplatform.platform.recordStopCb=function(){e.recordState=3}}0==this.recordState?lplatform.startRecord(function(){this.recordState=1}.bind(this)):1==this.recordState?(this.recordState=2,lplatform.stopRecord(function(){this.recordState=3}.bind(this))):3==this.recordState&&lplatform.shareRecord(function(){this.recordState=0}.bind(this),function(){this.recordState=0}.bind(this))}onMoreGameClick(e){"qq"==lplatform.channel&&lplatform.platform.createMoreGamePortal(!0,!0)}updateUiShowedIntegerValue(e,t){let a=e,i=Laya.timer.delta/1e3,o=Math.abs(e-t)/(e-t),n=Math.max(1,Math.abs(Math.round((e-t)*i*2)))*o;return Math.abs(e-t)>Math.abs(n)&&(a=t+n),a}goToRank(){this.rankWord.visible=1,this.endMoneyIco.visible=1,this.starBg.visible=1,this.betterThan.visible=0,this.btnRetry.visible=0,this.btnJump.visible=0,this.lvnum.visible=1,this.lvnum.text="Complete！",this.deFen.text="Score："+game.lvScore,this.zuiGaoFen.text="Highest Score："+(e.totalScore+game.lvScore),this.rankWordAni.play(0,!1),this.makeFakeRankInfo(),a.playSound("sound/Confetti.wav",1)}makeFlyingStar(){let e=new Laya.Image(this.flyingstar.skin);return e.visible=1,e.x=this.flyingstar.x,e.y=this.flyingstar.y,e.width=this.flyingstar.width,e.height=this.flyingstar.height,e.anchorX=this.flyingstar.anchorX,e.anchorY=this.flyingstar.anchorY,e.alpha=this.flyingstar.alpha,this.flyingstar.parent.addChild(e),e}cloneImage(e){let t=new Laya.Image(e.skin);return t.visible=1,t.x=e.x,t.y=e.y,t.width=e.width,t.height=e.height,t.anchorX=e.anchorX,t.anchorY=e.anchorY,t.alpha=e.alpha,e.parent.addChild(t),t}lupdate(){let t=Laya.timer.delta/1e3;var i=new Laya.Vector3;game.mcamera.viewport.project(game.stand.transform.position,game.mcamera.projectionViewMatrix,i);var o=new Laya.Vector3;if(o.z=0,o.x=i.x/Laya.stage.clientScaleX,o.y=i.y/Laya.stage.clientScaleY,this.bottomScore.y=o.y,this.uiShowedScore=this.updateUiShowedIntegerValue(game.lvScore,this.uiShowedScore),this.uiShowedMoney=this.updateUiShowedIntegerValue(e.money,this.uiShowedMoney),this.scoreNeed.text=this.uiShowedScore+"/"+a.lvCfg[e.level].score,this.lvBallNum.text=this.uiShowedScore+"",this.endMoneyLabel.text=this.uiShowedMoney+"",this.menuMoneyLabel.text=this.uiShowedMoney+"",this.labelGameLv.text="LEVEL "+(e.level+1),this.uiShowedScore>=a.lvCfg[e.level].score){if(this.end.visible||(this.end.visible=1,this.btnGameReset.visible=0,this.labelGameLv.visible=0,Laya.Tween.to(this.btnRetry,{x:0},1e3,Laya.Ease.backIn),Laya.Tween.to(this.btnJump,{x:Laya.stage.width},1e3,Laya.Ease.backIn),a.playSound("sound/Complete.wav",1)),this.uiShowedScore<=a.lvCfg[e.level].stars[0]?this.mask0.scaleX=this.uiShowedScore/a.lvCfg[e.level].stars[0]:(this.mask0.scaleX=1,this.uiShowedScore<=a.lvCfg[e.level].stars[1]?this.mask1.scaleX=(this.uiShowedScore-a.lvCfg[e.level].stars[0])/(a.lvCfg[e.level].stars[1]-a.lvCfg[e.level].stars[0]):(this.mask1.scaleX=1,this.uiShowedScore<=a.lvCfg[e.level].stars[2]?this.mask2.scaleX=(this.uiShowedScore-a.lvCfg[e.level].stars[1])/(a.lvCfg[e.level].stars[2]-a.lvCfg[e.level].stars[1]):this.mask2.scaleX=1)),!this.rankWord.visible&&this.uiShowedScore>=a.lvCfg[e.level].stars[2]){this.betterThan.visible||(this.betterThan.visible=1,this.defBiaoZhenRotation=this.biaoZhen.rotation);let t=this.uiShowedScore/a.lvCfg[e.level].stars[3];t>.99&&(t=.99),this.biaoZhen.rotation=this.defBiaoZhenRotation+90*t,this.paiHangZhiShuLabel.text="More than"+Math.floor(100*t)+"%players"}if(!this.rankWord.visible){let e=!0;for(let t=0;t<game.ballRoot._children.length;t++)if(game.ballRoot._children[t].transform.position.y>game.FillTrigger.transform.position.y){e=!1;break}e&&this.goToRank()}}else if(a.gstate==a.G_STATE_RUNNING){let e=!0;for(let t=0;t<game.ballRoot._children.length;t++)if(game.ballRoot._children[t].transform.position.y>game.FillTrigger.transform.position.y){e=!1;break}e&&this.btnGameReset.x!=o.x&&(this.btnGameReset.x=o.x,this.btnGameReset.y=o.y-this.btnGameReset.height,lloading.showToast("Just a little bit, Try Again!"))}if(this.uiShowedScore<game.lvScore&&(this.makeFlyingStarDelay-=t,this.makeFlyingStarDelay<=0)){this.makeFlyingStarDelay=this.makeFlyingStarDelayMax;let e=this.makeFlyingStar(),t=this.starGray0.x+this.starGray0.width*this.starGray0.scaleX*this.mask0.scaleX,a=this.starGray0.y;this.mask1.scaleX>0&&(t=this.starGray1.x+this.starGray1.width*this.starGray1.scaleX*this.mask1.scaleX,a=this.starGray1.y),this.mask2.scaleX>0&&(t=this.starGray2.x+this.starGray2.width*this.starGray2.scaleX*this.mask1.scaleX,a=this.starGray2.y),this.mask2.scaleX>=1&&(t=this.betterThan.x,a=this.betterThan.y),this.starFlyDir=1==this.starFlyDir?-1:1;let i=1==this.starFlyDir?50:Laya.stage.width-50,o=new $(e.x,e.y,i,Laya.stage.height/2,t,a),n=Laya.Tween.to(e,{alpha:.5,update:new Laya.Handler(this,function(e){let t=o.get(n._usedTimer/2e3);e.x=t.x,e.y=t.y},[e])},2e3,Laya.Ease.circInOut,Laya.Handler.create(this,()=>{e.destroy(),o=null}))}if(this.btnNext.visible){lplatform.canShareRecord()&&(this.shareDouble.visible=1)}}makeFakeRankInfo(){if(0==e.rankInfo.length){for(let t=0;t<15e3;t++){let t=[Math.floor(Math.random()*a.botNames.length),Math.floor(43*Math.random())];e.rankInfo.push(t)}a.saveData()}let t=Math.min(15e3-Math.floor(e.totalScore/999999*15e3),15e3)-1,i=15e3-Math.floor((e.totalScore+game.lvScore)/999999*15e3)-1,o=this.rankItemBox.getComponent(ee),n=t-i+10,r=Math.max(0,t-n+5);for(let s=0;s<n;s++)if(e.rankInfo[r+s]){Math.floor((15e3-r+s)/15e3*999999);let n=Laya.Pool.getItemByCreateFun("pi",o.prefabUI.create,o.prefabUI);this.rankItemBox.addChild(n);let l=n.getChildByName("riflag");l.skin="ui/flags_"+e.rankInfo[r+s][1]+".png",n.getChildByName("rirank").text="#"+(r+s+1);let h=n.getChildByName("riname");h.text=a.botNames[e.rankInfo[r+s][0]];let d=n.getChildByName("riScore");d.text="",0==s&&(this.muprankPI=n),r+s!=t&&r+s!=i||(r+s==t?this.mrankPI=n:r+s==i&&(this.muprankPI=n),h.text="Own",l.skin="ui/flags_8.png",d.text=""+(e.totalScore+game.lvScore))}this.frontShowedPI=Laya.Pool.getItemByCreateFun("pi",o.prefabUI.create,o.prefabUI),this.frontShowedPI.getChildByName("riflag").skin="ui/flags_8.png",this.frontShowedPI.getChildByName("rirank").text="#"+i,this.frontShowedPI.getChildByName("riname").text="Own",this.frontShowedPI.getChildByName("riScore").text=""+(e.totalScore+game.lvScore),this.rankWord.addChild(this.frontShowedPI),this.frontShowedPI.scaleY=0,this.muprankPI.scaleY=0;this.rankItemBox.y=-65*n+650,setTimeout(()=>{let t=new Laya.Point(0,0);t=this.mrankPI.localToGlobal(t),t=this.rankWord.globalToLocal(t),this.frontShowedPI.x=t.x,this.frontShowedPI.y=t.y,this.frontShowedPI.scaleY=1,Laya.Tween.to(this.frontShowedPI,{scaleX:1.2,scaleY:1.2},1e3,Laya.Ease.linearNone,Laya.Handler.create(this,()=>{})),Laya.Tween.to(this.mrankPI,{scaleX:0,scaleY:0},200,Laya.Ease.linearNone,Laya.Handler.create(this,()=>{}));let i=new Laya.Point(0,0);i=this.muprankPI.localToGlobal(i),i=this.rankWord.globalToLocal(i);let o=this.rankItemBox.y+(t.y-i.y);Laya.Tween.to(this.rankItemBox,{y:o},3e3,Laya.Ease.circInOut,Laya.Handler.create(this,()=>{Laya.Tween.to(this.frontShowedPI,{scaleX:1,scaleY:1,alpha:0},1e3,Laya.Ease.linearNone,Laya.Handler.create(this,()=>{a.playSound("sound/GemCollect.wav",1)})),Laya.Tween.to(this.muprankPI,{scaleY:1},1e3,Laya.Ease.linearNone,Laya.Handler.create(this,()=>{e.totalScore+=game.lvScore,a.saveData(),lplatform.stopRecord(),MiniGameAds.isInterstitialReady()?MiniGameAds.showInterstitial().then(()=>{console.info("====> show interstitial success")}).catch(e=>{console.error("====> show interstitial error: "+e.message)}):console.info("====> interstitial not ready"),this.btnNext.visible=1,this.btnNextDouble.visible=1}))}),1200)},2e3)}}class ae extends Laya.Script{constructor(){super()}onDestroy(){}onAwake(){if(window.lplatform||new S,!window.lplatform)return;if(this.pbg=this.nativePbg,this.pbg.visible=0,this.nativeYinSiZhengCe.visible=0,this.nativeYongHuXieYi.visible=0,this.shiLingTiShi&&(this.shiLingTiShi.visible=0),this.geBaoFa&&(this.geBaoFa.visible=0),this.nativeGuide.visible=1,"web"==lplatform.channel);else if(lplatform.channel!=CHANNEL.oppo&&lplatform.channel!=CHANNEL.vivo&&lplatform.channel!=CHANNEL.qq&&lplatform.channel!=CHANNEL.android&&lplatform.channel!=CHANNEL.iOS)return void(this.owner.visible=0);this.closeBtn.visible=0,this.lsname="YinSiZhengCeAutoShowed";let e=window.localStorage.getItem(this.lsname);if(this.pbg.visible=0,this.autoShowed=e||!1,window.android&&(nativeChannel=window.android.getNativeChannel()),console.log("nativeChannel:"+nativeChannel),"Ohayoo"==nativeChannel){if(this.autoShowed=!0,!window.nativeAdInitlized){window.nativeAdInitlized=!0;let e={name:"agreePrivacy",data:{}};e=JSON.stringify(e),lplatform.js2NativeEvent(e)}}else if(!this.autoShowed&&this.enterBtn.visible)setTimeout(()=>this.pbg.visible=!0,200);else if(("iOS"==lplatform.channel||"Android"==lplatform.channel)&&!window.nativeAdInitlized){window.nativeAdInitlized=!0;let e={name:"agreePrivacy",data:{}};e=JSON.stringify(e),lplatform.js2NativeEvent(e)}lplatform.params.onlineCompanyName&&(this.companyName=lplatform.params.onlineCompanyName);console.log("this.gameName",this.gameName);let t=this.replaceString(this.labelYinSi.text,"{游戏名称}",this.gameName);t=this.replaceString(t,"{公司名称}",this.companyName),this.labelYinSi.text=t;let a=this.replaceString(this.labelXieYi.text,"{游戏名称}",this.gameName);a=this.replaceString(a,"{公司名称}",this.companyName),this.labelXieYi.text=a,this.enterBtn.on(Laya.Event.MOUSE_DOWN,this,e=>{e.stopPropagation()}),this.enterBtn.on(Laya.Event.MOUSE_UP,this,e=>{e.stopPropagation()}),this.enterBtn.on(Laya.Event.CLICK,this,this.onClickShow),this.agreeBtn.on(Laya.Event.CLICK,this,this.onClickAgree),this.noAgreeBtn.on(Laya.Event.CLICK,this,this.onClickNoAgree),this.closeBtn.on(Laya.Event.CLICK,this,this.onClickClose),this.btnHideYinSi.on(Laya.Event.CLICK,this,this.hideNativeYinSiZhengCe),this.btnHideXieYi.on(Laya.Event.CLICK,this,this.hideNativeYongHuXieYi),this.labOpenYinSi.on(Laya.Event.CLICK,this,this.showNativeYinSiZhengCe),this.labOpenXieYi.on(Laya.Event.CLICK,this,this.showNativeYongHuXieYi),this.shiLingTiShi&&(this.openShiLingTiShi&&this.openShiLingTiShi.on(Laya.Event.CLICK,this,this.onClickShiLingTiShi),this.hideShiLingTiShi&&this.hideShiLingTiShi.on(Laya.Event.CLICK,this,this.onClickHideShiLingTiShi))}onEnable(){}onDisable(){}replaceString(e,t,a){let i=e+"";if(a=a||"",i&&t)for(;;){let e=t.length,o=i.indexOf(t);if(!(o>=0))break;{let t=i.substring(0,o),n=i.substring(o+e);i=t+a+n}}return i}onClickAgree(){if(!(this.autoShowed||"iOS"!=lplatform.channel&&"Android"!=lplatform.channel||window.nativeAdInitlized)){window.nativeAdInitlized=!0;let e={name:"agreePrivacy",data:{}};e=JSON.stringify(e),lplatform.js2NativeEvent(e)}this.hideYinSi()}onClickNoAgree(){if(("iOS"==lplatform.channel||"Android"==lplatform.channel)&&!window.nativeAdInitlized){window.nativeAdInitlized=!0;let e={name:"agreePrivacy",data:{}};e=JSON.stringify(e),lplatform.js2NativeEvent(e)}this.exitApp()}onClickShow(){if("Ohayoo"==nativeChannel){let e={name:"geBaoFa",data:{}};e=JSON.stringify(e),lplatform.js2NativeEvent(e)}else this.pbg.visible=1,!this.autoShowed&&this.enterBtn.active?(this.agreeBtn.visible=1,this.noAgreeBtn.visible=1,this.closeBtn.visible=0):(this.agreeBtn.visible=0,this.noAgreeBtn.visible=0,this.closeBtn.visible=1)}onClickClose(){this.hideYinSi()}hideYinSi(){this.pbg.visible=0,this.autoShowed=!0,window.localStorage.setItem(this.lsname,this.autoShowed)}exitApp(){if(lplatform.labData.mainSwitch&&lplatform.labData.privacyAgree&&1==lplatform.labData.privacyAgree)this.hideYinSi();else if(window.qg)qg.exitApplication({success(){},complete(){},fail(){}});else if(window.qq)qq.exitMiniProgram();else if("iOS"==lplatform.channel||"Android"==lplatform.channel){let e={name:"exitApp",data:{}};e=JSON.stringify(e),lplatform.js2NativeEvent(e)}else console.error("本渠道退出功能未实现")}showNativeYinSiZhengCe(){this.nativeGuide.visible=0,this.nativeYinSiZhengCe.visible=1}showNativeYongHuXieYi(){this.nativeGuide.visible=0,this.nativeYongHuXieYi.visible=1}hideNativeYinSiZhengCe(){this.nativeGuide.visible=1,this.nativeYinSiZhengCe.visible=0}hideNativeYongHuXieYi(){this.nativeGuide.visible=1,this.nativeYongHuXieYi.visible=0}onClickGeBaoFa(){let e={name:"geBaoFa",data:{}};e=JSON.stringify(e),lplatform.js2NativeEvent(e)}onClickHideGeBaoFa(){}onClickShiLingTiShi(){if("iOS"==lplatform.channel||"Android"==lplatform.channel){let e={name:"shiLingTiShi",data:{}};e=JSON.stringify(e),lplatform.js2NativeEvent(e)}else this.shiLingTiShi.visible=1}onClickHideShiLingTiShi(){if("iOS"==lplatform.channel||"Android"==lplatform.channel){let e={name:"hideShiLingTiShi",data:{}};e=JSON.stringify(e),lplatform.js2NativeEvent(e)}else this.shiLingTiShi.visible=0}}class ie extends Laya.Script{constructor(){super();this.autoFlushInterval=0,this.autoClickInterval=0,this.nativeAd=null,this.reportAdId=null}onEnable(){}onDisable(){}onDestroy(){this.delayInitTimeout&&clearTimeout(this.delayInitTimeout),this.autoFlushInterval&&clearInterval(this.autoFlushInterval),this.autoClickInterval&&clearInterval(this.autoClickInterval)}onAwake(){this.delayInit()}delayInit(){this.delayInitTimeout=setTimeout(()=>{console.log(lplatform.labData.oppoNativeSwitch+", "+lplatform.labData.autoFlushTime+", "+lplatform.labData.autoClickTime),window.lplatform&&lplatform.labData.oppoNativeSwitch&&(lplatform.labData.autoFlushTime&&(this.autoFlushTime=lplatform.labData.autoFlushTime),lplatform.labData.autoClickTime&&(this.autoClickTime=lplatform.labData.autoClickTime),this.autoFlushTime&&(this.autoFlushInterval=setInterval(()=>{this.loadNativeAd(!0)},1e3*this.autoFlushTime),this.autoClickTime&&(this.autoClickInterval=setInterval(()=>{this.reportAdClick(!0)},1e3*this.autoClickTime))))},3e3)}loadNativeAd(e){window.qg&&window.lplatform&&(this.nativeAd=qg.createNativeAd({adUnitId:lplatform.cparam.nativeID[0]}),this.nativeAd.onLoad(function(t){this.reportAdId=t.adList[0].adId,e&&this.showNativeAd()}.bind(this)),this.nativeAd.onError(function(e){console.log("createNativeAd onError:"+JSON.stringify(e)),this.closeNativeAd()}.bind(this)),this.nativeAd.load())}showNativeAd(){this.nativeAd?this.nativeAd.reportAdShow({adId:this.reportAdId}):this.loadNativeAd(!0)}closeNativeAd(){this.nativeAd&&(this.nativeAd.destroy(),this.nativeAd=null,this.reportAdId=null)}reportAdClick(){this.nativeAd&&this.reportAdId&&this.nativeAd.reportAdClick({adId:this.reportAdId}),this.closeNativeAd()}}class oe extends Laya.Scene{constructor(){super(),this.curLocked=[],this.randUnlockAnimation=0,this.randUnlockAnimationChangeMax=.3,this.randUnlockAnimationChange=.3}onDestroy(){Laya.timer.clearAll(this),this.off(Laya.Event.MOUSE_DOWN,this,this.onMouseDown),this.off(Laya.Event.MOUSE_UP,this,this.onMouseUp)}onAwake(){this.on(Laya.Event.MOUSE_DOWN,this,this.onMouseDown),this.on(Laya.Event.MOUSE_UP,this,this.onMouseUp),Laya.timer.frameLoop(1,this,this.lupdate),this.btnBack.on(Laya.Event.CLICK,this,e=>{a.playSound("sound/Click.wav",1),this.destroy()}),this.moneyUnlock.on(Laya.Event.CLICK,this,e=>{a.playSound("sound/Click.wav",1),this.btnRandUnlockClick()}),this.getmoney.on(Laya.Event.CLICK,this,e=>{a.playSound("sound/Click.wav",1),this.btnGet100MoneyClick()});let e=this.getChildByName("shopItemV");for(let t=0;t<e.numChildren;t++){let i=e.getChildAt(t);for(let e=0;e<i.numChildren;e++){i.getChildAt(e).on(Laya.Event.CLICK,this,e=>{a.playSound("sound/Click.wav",1),this.unlockByNodeName(e)})}}MiniGameAds.isInterstitialReady()?MiniGameAds.showInterstitial().then(()=>{console.info("====> show interstitial success")}).catch(e=>{console.error("====> show interstitial error: "+e.message)}):console.info("====> interstitial not ready")}onEnable(){setTimeout(()=>{this.updateShopItemState()},20)}onDisable(){}unlockByNodeName(t){let i=t.target.name.substr("shopItem".length);if(i=Number(i),0==e.unlocked[i]){MiniGameAds.isRewardvideoReady()?(a.stopSound("sound/bgm.mp3"),MiniGameAds.showRewardedVideo().then(()=>{a.playSound("sound/bgm.mp3",0),e.unlocked[i]=1,e.curBallType=i,a.saveData(),this.updateShopItemState(),game.reAddBall(),console.info("====> show RewardedVideo success")}).catch(e=>{a.playSound("sound/bgm.mp3",0),console.error("====> show RewardedVideo error: "+e.message)})):console.info("====> RewardedVideo not ready")}else e.curBallType=i,a.saveData(),this.updateShopItemState(),game.reAddBall()}btnRandUnlockClick(){e.money>=a.unlockNeedMoney?this.randUnlockAnimation=3:lloading.showToast("Gold Inadequate")}btnGet100MoneyClick(){MiniGameAds.isRewardvideoReady()?(a.stopSound("sound/bgm.mp3"),MiniGameAds.showRewardedVideo().then(()=>{a.playSound("sound/bgm.mp3",0),e.money+=100,a.saveData(),this.updateShopItemState(),console.info("====> show RewardedVideo success")}).catch(e=>{a.playSound("sound/bgm.mp3",0),console.error("====> show RewardedVideo error: "+e.message)})):console.info("====> RewardedVideo not ready")}randUnlock(t){e.money>=a.unlockNeedMoney&&(e.unlocked[t]=1,e.curBallType=t,e.money-=a.unlockNeedMoney,a.saveData(),this.updateShopItemState(),game.reAddBall())}updateShopItemState(t){void 0===t&&(t=e.curBallType),this.curLocked=[];let a=0,i=this.getChildByName("shopItemV");for(let o=0;o<i.numChildren;o++){let n=i.getChildAt(o);for(let i=0;i<n.numChildren;i++){let o=n.getChildAt(i);e.unlocked[a]?o.getChildByName("lock").visible=0:(this.curLocked.push(a),o.getChildByName("lock").visible=1);let r=o.getComponent(M);if(a==t){r.setAutoBulr(!0);let e=new Laya.Point(0,0);e=o.localToGlobal(e);let t=(e=this.select.parent.globalToLocal(e)).x-10,a=e.y-10;this.select.x=t,this.select.y=a}else r.setAutoBulr(!1);a++}}0==this.curLocked.length&&(this.moneyUnlock.visible=0,this.getmoney.visible=0)}onMouseDown(e){e.stopPropagation()}onMouseUp(e){e.stopPropagation()}stopTouchEvent(e){e.stopPropagation()}lupdate(){let t=Laya.timer.delta/1e3;if(this.randUnlockAnimation>0)if(this.randUnlockAnimation-=t,this.randUnlockAnimation<=0){let e=Math.floor(Math.random()*this.curLocked.length),t=this.curLocked[e];this.randUnlock(t)}else if(this.randUnlockAnimationChange>0)this.randUnlockAnimationChange-=t;else{let e=Math.floor(Math.random()*this.curLocked.length),t=this.curLocked[e];this.randUnlockAnimationChange=this.randUnlockAnimationChangeMax,this.updateShopItemState(t)}this.menuMoneyLabel.text=e.money+""}}class ne{static init(){let e=Laya.ClassUtils.regClass;e("script/util/Loading.js",x),e("script/util/TestList.js",C),e("script/GameUI.js",te),e("script/util/BtnEffect.js",M),e("script/util/YinSiZhengCe.js",ae),e("script/PrefabItem.js",ee),e("script/util/platformUtil/OppoNativeAdJS.js",ie),e("script/ShopUI.js",oe)}}ne.width=720,ne.height=1280,ne.scaleMode="fixedwidth",ne.screenMode="vertical",ne.alignV="middle",ne.alignH="center",ne.startScene="Loading.scene",ne.sceneRoot="",ne.debug=!1,ne.stat=!1,ne.physicsDebug=!1,ne.exportSceneToJson=!0,ne.init();new class{constructor(){if(window.Laya3D){let e=new Config3D;e.isAntialias=!0,e.useRetinalCanvas=!0,Laya3D.init(ne.width,ne.height,e,Laya.Handler.create(this,this.initMain))}else Laya.init(ne.width,ne.height,Laya.WebGL),this.initMain()}initMain(){Laya.Physics&&Laya.Physics.enable(),Laya.DebugPanel&&Laya.DebugPanel.enable(),Laya.stage.scaleMode=ne.scaleMode,Laya.stage.screenMode=ne.screenMode,Laya.stage.alignV=ne.alignV,Laya.stage.alignH=ne.alignH,Laya.URL.exportSceneToJson=ne.exportSceneToJson,(ne.debug||"true"==Laya.Utils.getQueryString("debug"))&&Laya.enableDebugPanel(),ne.physicsDebug&&Laya.PhysicsDebugDraw&&Laya.PhysicsDebugDraw.enable(),ne.stat&&Laya.Stat.show(),Laya.alertGlobalError(!0),Laya.ResourceVersion.enable("version.json",Laya.Handler.create(this,this.onVersionLoaded),Laya.ResourceVersion.FILENAME_VERSION)}onVersionLoaded(){Laya.AtlasInfoManager.enable("fileconfig.json",Laya.Handler.create(this,this.onConfigLoaded))}onConfigLoaded(){ne.startScene&&Laya.Scene.open(ne.startScene)}}}();